[WARNING]: Found both group and host with same name: master
[WARNING]: Found both group and host with same name: admin
ansible-playbook [core 2.15.3]
  config file = None
  configured module search path = ['/home/ec2-user/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/lib/python3.9/site-packages/ansible
  ansible collection location = /home/ec2-user/.ansible/collections:/usr/share/ansible/collections
  executable location = /usr/bin/ansible-playbook
  python version = 3.9.16 (main, Apr 24 2024, 00:00:00) [GCC 11.4.1 20230605 (Red Hat 11.4.1-2)] (/usr/bin/python3.9)
  jinja version = 3.1.4
  libyaml = True
No config file found; using defaults
host_list declined parsing /home/ec2-user/devops_setup/kubernetes/inventory as it did not pass its verify_file() method
script declined parsing /home/ec2-user/devops_setup/kubernetes/inventory as it did not pass its verify_file() method
auto declined parsing /home/ec2-user/devops_setup/kubernetes/inventory as it did not pass its verify_file() method
Parsed /home/ec2-user/devops_setup/kubernetes/inventory inventory source with ini plugin
redirecting (type: modules) ansible.builtin.selinux to ansible.posix.selinux
Skipping callback 'default', as we already have a stdout callback.
Skipping callback 'minimal', as we already have a stdout callback.
Skipping callback 'oneline', as we already have a stdout callback.

PLAYBOOK: setup_kubernetes_cluster.yaml ****************************************
1 plays in /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml

PLAY [Setup Kubernetes Cluster] ************************************************

TASK [Gathering Facts] *********************************************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:2
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'echo ~ec2-user && sleep 0'"'"''
<10.0.1.171> (0, b'/home/ec2-user\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /home/ec2-user/.ansible/tmp `"&& mkdir "` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489213.24219-326314-68371992994540 `" && echo ansible-tmp-1721489213.24219-326314-68371992994540="` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489213.24219-326314-68371992994540 `" ) && sleep 0'"'"''
<10.0.1.171> (0, b'ansible-tmp-1721489213.24219-326314-68371992994540=/home/ec2-user/.ansible/tmp/ansible-tmp-1721489213.24219-326314-68371992994540\n', b'')
<master> Attempting python interpreter discovery
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'echo PLATFORM; uname; echo FOUND; command -v '"'"'"'"'"'"'"'"'python3.11'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python3.10'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python3.9'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python3.8'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python3.7'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python3.6'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python3.5'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'/usr/bin/python3'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'/usr/libexec/platform-python'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python2.7'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'/usr/bin/python'"'"'"'"'"'"'"'"'; command -v '"'"'"'"'"'"'"'"'python'"'"'"'"'"'"'"'"'; echo ENDFOUND && sleep 0'"'"''
<10.0.1.171> (0, b'PLATFORM\nLinux\nFOUND\n/usr/bin/python3.9\n/usr/bin/python3\nENDFOUND\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'/usr/bin/python3.9 && sleep 0'"'"''
<10.0.1.171> (0, b'{"platform_dist_result": [], "osrelease_content": "NAME=\\"Amazon Linux\\"\\nVERSION=\\"2023\\"\\nID=\\"amzn\\"\\nID_LIKE=\\"fedora\\"\\nVERSION_ID=\\"2023\\"\\nPLATFORM_ID=\\"platform:al2023\\"\\nPRETTY_NAME=\\"Amazon Linux 2023.5.20240701\\"\\nANSI_COLOR=\\"0;33\\"\\nCPE_NAME=\\"cpe:2.3:o:amazon:amazon_linux:2023\\"\\nHOME_URL=\\"https://aws.amazon.com/linux/amazon-linux-2023/\\"\\nDOCUMENTATION_URL=\\"https://docs.aws.amazon.com/linux/\\"\\nSUPPORT_URL=\\"https://aws.amazon.com/premiumsupport/\\"\\nBUG_REPORT_URL=\\"https://github.com/amazonlinux/amazon-linux-2023\\"\\nVENDOR_NAME=\\"AWS\\"\\nVENDOR_URL=\\"https://aws.amazon.com/\\"\\nSUPPORT_END=\\"2028-03-15\\"\\n"}\n', b'')
<master> Python interpreter discovery fallback (unsupported Linux distribution: amzn)
Using module file /usr/lib/python3.9/site-packages/ansible/modules/setup.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpa9szavl1 TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489213.24219-326314-68371992994540/AnsiballZ_setup.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpa9szavl1 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489213.24219-326314-68371992994540/AnsiballZ_setup.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489213.24219-326314-68371992994540/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489213.24219-326314-68371992994540/AnsiballZ_setup.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-pfivenjtjgufmaswzgtnepbwkkmbrmmi ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489213.24219-326314-68371992994540/AnsiballZ_setup.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"ansible_facts": {"ansible_distribution": "Amazon", "ansible_distribution_release": "NA", "ansible_distribution_version": "2023", "ansible_distribution_major_version": "2023", "ansible_distribution_file_path": "/etc/os-release", "ansible_distribution_file_variety": "Amazon", "ansible_distribution_file_parsed": true, "ansible_distribution_minor_version": "NA", "ansible_os_family": "RedHat", "ansible_local": {}, "ansible_ssh_host_key_ecdsa_public": "AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBDDn0dwOCKjwfU8S0mix7UVFuH1wO8MAmqcUnQ6NvGKwyQFKtM8b5+4JzeNHxqXMSJ26d2/vZ/aDnNJNKWBdxmM=", "ansible_ssh_host_key_ecdsa_public_keytype": "ecdsa-sha2-nistp256", "ansible_ssh_host_key_ed25519_public": "AAAAC3NzaC1lZDI1NTE5AAAAILHqFO/I9aUPcoZg00ak6tbKwIJ+PJ8hzsziBKKN56AG", "ansible_ssh_host_key_ed25519_public_keytype": "ssh-ed25519", "ansible_user_id": "root", "ansible_user_uid": 0, "ansible_user_gid": 0, "ansible_user_gecos": "root", "ansible_user_dir": "/root", "ansible_user_shell": "/bin/bash", "ansible_real_user_id": 0, "ansible_effective_user_id": 0, "ansible_real_group_id": 0, "ansible_effective_group_id": 0, "ansible_selinux_python_present": true, "ansible_selinux": {"status": "enabled", "policyvers": 33, "config_mode": "permissive", "mode": "permissive", "type": "targeted"}, "ansible_date_time": {"year": "2024", "month": "07", "weekday": "Saturday", "weekday_number": "6", "weeknumber": "29", "day": "20", "hour": "15", "minute": "26", "second": "55", "epoch": "1721489215", "epoch_int": "1721489215", "date": "2024-07-20", "time": "15:26:55", "iso8601_micro": "2024-07-20T15:26:55.264236Z", "iso8601": "2024-07-20T15:26:55Z", "iso8601_basic": "20240720T152655264236", "iso8601_basic_short": "20240720T152655", "tz": "UTC", "tz_dst": "UTC", "tz_offset": "+0000"}, "ansible_lsb": {}, "ansible_apparmor": {"status": "disabled"}, "ansible_virtualization_role": "guest", "ansible_virtualization_type": "kvm", "ansible_virtualization_tech_guest": ["kvm"], "ansible_virtualization_tech_host": [], "ansible_cmdline": {"BOOT_IMAGE": "(hd0,gpt1)/boot/vmlinuz-6.1.94-99.176.amzn2023.x86_64", "root": "UUID=36d29e5b-3776-49ee-a4d6-5868c3a57848", "ro": true, "console": "ttyS0,115200n8", "nvme_core.io_timeout": "4294967295", "rd.emergency": "poweroff", "rd.shell": "0", "selinux": "1", "security": "selinux", "quiet": true}, "ansible_proc_cmdline": {"BOOT_IMAGE": "(hd0,gpt1)/boot/vmlinuz-6.1.94-99.176.amzn2023.x86_64", "root": "UUID=36d29e5b-3776-49ee-a4d6-5868c3a57848", "ro": true, "console": ["tty0", "ttyS0,115200n8"], "nvme_core.io_timeout": "4294967295", "rd.emergency": "poweroff", "rd.shell": "0", "selinux": "1", "security": "selinux", "quiet": true}, "ansible_system": "Linux", "ansible_kernel": "6.1.94-99.176.amzn2023.x86_64", "ansible_kernel_version": "#1 SMP PREEMPT_DYNAMIC Tue Jun 18 14:57:56 UTC 2024", "ansible_machine": "x86_64", "ansible_python_version": "3.9.16", "ansible_fqdn": "ip-10-0-1-171.eu-north-1.compute.internal", "ansible_hostname": "ip-10-0-1-171", "ansible_nodename": "ip-10-0-1-171.eu-north-1.compute.internal", "ansible_domain": "eu-north-1.compute.internal", "ansible_userspace_bits": "64", "ansible_architecture": "x86_64", "ansible_userspace_architecture": "x86_64", "ansible_machine_id": "ec2c6beabc5db423958bc58dc1c87f27", "ansible_iscsi_iqn": "", "ansible_system_capabilities_enforced": "False", "ansible_system_capabilities": [], "ansible_python": {"version": {"major": 3, "minor": 9, "micro": 16, "releaselevel": "final", "serial": 0}, "version_info": [3, 9, 16, "final", 0], "executable": "/usr/bin/python3.9", "has_sslcontext": true, "type": "cpython"}, "ansible_hostnqn": "", "ansible_is_chroot": false, "ansible_env": {"SHELL": "/bin/bash", "SUDO_GID": "1000", "SUDO_COMMAND": "/bin/sh -c echo BECOME-SUCCESS-pfivenjtjgufmaswzgtnepbwkkmbrmmi ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489213.24219-326314-68371992994540/AnsiballZ_setup.py", "SUDO_USER": "ec2-user", "PWD": "/home/ec2-user", "LOGNAME": "root", "HOME": "/root", "LANG": "C.UTF-8", "LS_COLORS": "rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=01;37;41:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.webp=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=01;36:*.au=01;36:*.flac=01;36:*.m4a=01;36:*.mid=01;36:*.midi=01;36:*.mka=01;36:*.mp3=01;36:*.mpc=01;36:*.ogg=01;36:*.ra=01;36:*.wav=01;36:*.oga=01;36:*.opus=01;36:*.spx=01;36:*.xspf=01;36:", "TERM": "xterm-256color", "USER": "root", "SHLVL": "0", "PATH": "/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/var/lib/snapd/snap/bin", "SUDO_UID": "1000", "MAIL": "/var/mail/root", "_": "/usr/bin/python3.9"}, "ansible_fibre_channel_wwn": [], "ansible_loadavg": {"1m": 0.75, "5m": 0.16, "15m": 0.05}, "ansible_dns": {"nameservers": ["10.0.0.2"], "search": ["eu-north-1.compute.internal"]}, "ansible_fips": false, "ansible_pkg_mgr": "dnf", "ansible_interfaces": ["ens5", "lo"], "ansible_lo": {"device": "lo", "mtu": 65536, "active": true, "type": "loopback", "promisc": false, "ipv4": {"address": "127.0.0.1", "broadcast": "", "netmask": "255.0.0.0", "network": "127.0.0.0", "prefix": "8"}, "ipv6": [{"address": "::1", "prefix": "128", "scope": "host"}], "features": {"rx_checksumming": "on [fixed]", "tx_checksumming": "on", "tx_checksum_ipv4": "off [fixed]", "tx_checksum_ip_generic": "on [fixed]", "tx_checksum_ipv6": "off [fixed]", "tx_checksum_fcoe_crc": "off [fixed]", "tx_checksum_sctp": "on [fixed]", "scatter_gather": "on", "tx_scatter_gather": "on [fixed]", "tx_scatter_gather_fraglist": "on [fixed]", "tcp_segmentation_offload": "on", "tx_tcp_segmentation": "on", "tx_tcp_ecn_segmentation": "on", "tx_tcp_mangleid_segmentation": "on", "tx_tcp6_segmentation": "on", "generic_segmentation_offload": "on", "generic_receive_offload": "on", "large_receive_offload": "off [fixed]", "rx_vlan_offload": "off [fixed]", "tx_vlan_offload": "off [fixed]", "ntuple_filters": "off [fixed]", "receive_hashing": "off [fixed]", "highdma": "on [fixed]", "rx_vlan_filter": "off [fixed]", "vlan_challenged": "on [fixed]", "tx_lockless": "on [fixed]", "netns_local": "on [fixed]", "tx_gso_robust": "off [fixed]", "tx_fcoe_segmentation": "off [fixed]", "tx_gre_segmentation": "off [fixed]", "tx_gre_csum_segmentation": "off [fixed]", "tx_ipxip4_segmentation": "off [fixed]", "tx_ipxip6_segmentation": "off [fixed]", "tx_udp_tnl_segmentation": "off [fixed]", "tx_udp_tnl_csum_segmentation": "off [fixed]", "tx_gso_partial": "off [fixed]", "tx_tunnel_remcsum_segmentation": "off [fixed]", "tx_sctp_segmentation": "on", "tx_esp_segmentation": "off [fixed]", "tx_udp_segmentation": "on", "tx_gso_list": "on", "fcoe_mtu": "off [fixed]", "tx_nocache_copy": "off [fixed]", "loopback": "on [fixed]", "rx_fcs": "off [fixed]", "rx_all": "off [fixed]", "tx_vlan_stag_hw_insert": "off [fixed]", "rx_vlan_stag_hw_parse": "off [fixed]", "rx_vlan_stag_filter": "off [fixed]", "l2_fwd_offload": "off [fixed]", "hw_tc_offload": "off [fixed]", "esp_hw_offload": "off [fixed]", "esp_tx_csum_hw_offload": "off [fixed]", "rx_udp_tunnel_port_offload": "off [fixed]", "tls_hw_tx_offload": "off [fixed]", "tls_hw_rx_offload": "off [fixed]", "rx_gro_hw": "off [fixed]", "tls_hw_record": "off [fixed]", "rx_gro_list": "off", "macsec_hw_offload": "off [fixed]", "rx_udp_gro_forwarding": "off", "hsr_tag_ins_offload": "off [fixed]", "hsr_tag_rm_offload": "off [fixed]", "hsr_fwd_offload": "off [fixed]", "hsr_dup_offload": "off [fixed]"}, "timestamping": [], "hw_timestamp_filters": []}, "ansible_ens5": {"device": "ens5", "macaddress": "06:3e:91:bf:45:f5", "mtu": 9001, "active": true, "module": "ena", "type": "ether", "pciid": "0000:00:05.0", "promisc": false, "ipv4": {"address": "10.0.1.171", "broadcast": "", "netmask": "255.255.255.0", "network": "10.0.1.0", "prefix": "24"}, "ipv6": [{"address": "fe80::43e:91ff:febf:45f5", "prefix": "64", "scope": "link"}], "features": {"rx_checksumming": "off [fixed]", "tx_checksumming": "on", "tx_checksum_ipv4": "on", "tx_checksum_ip_generic": "off [fixed]", "tx_checksum_ipv6": "on", "tx_checksum_fcoe_crc": "off [fixed]", "tx_checksum_sctp": "off [fixed]", "scatter_gather": "on", "tx_scatter_gather": "on", "tx_scatter_gather_fraglist": "off [fixed]", "tcp_segmentation_offload": "off", "tx_tcp_segmentation": "off [fixed]", "tx_tcp_ecn_segmentation": "off [fixed]", "tx_tcp_mangleid_segmentation": "off [fixed]", "tx_tcp6_segmentation": "off [fixed]", "generic_segmentation_offload": "on", "generic_receive_offload": "on", "large_receive_offload": "off [fixed]", "rx_vlan_offload": "off [fixed]", "tx_vlan_offload": "off [fixed]", "ntuple_filters": "off [fixed]", "receive_hashing": "on", "highdma": "on", "rx_vlan_filter": "off [fixed]", "vlan_challenged": "off [fixed]", "tx_lockless": "off [fixed]", "netns_local": "off [fixed]", "tx_gso_robust": "off [fixed]", "tx_fcoe_segmentation": "off [fixed]", "tx_gre_segmentation": "off [fixed]", "tx_gre_csum_segmentation": "off [fixed]", "tx_ipxip4_segmentation": "off [fixed]", "tx_ipxip6_segmentation": "off [fixed]", "tx_udp_tnl_segmentation": "off [fixed]", "tx_udp_tnl_csum_segmentation": "off [fixed]", "tx_gso_partial": "off [fixed]", "tx_tunnel_remcsum_segmentation": "off [fixed]", "tx_sctp_segmentation": "off [fixed]", "tx_esp_segmentation": "off [fixed]", "tx_udp_segmentation": "off [fixed]", "tx_gso_list": "off [fixed]", "fcoe_mtu": "off [fixed]", "tx_nocache_copy": "off", "loopback": "off [fixed]", "rx_fcs": "off [fixed]", "rx_all": "off [fixed]", "tx_vlan_stag_hw_insert": "off [fixed]", "rx_vlan_stag_hw_parse": "off [fixed]", "rx_vlan_stag_filter": "off [fixed]", "l2_fwd_offload": "off [fixed]", "hw_tc_offload": "off [fixed]", "esp_hw_offload": "off [fixed]", "esp_tx_csum_hw_offload": "off [fixed]", "rx_udp_tunnel_port_offload": "off [fixed]", "tls_hw_tx_offload": "off [fixed]", "tls_hw_rx_offload": "off [fixed]", "rx_gro_hw": "off [fixed]", "tls_hw_record": "off [fixed]", "rx_gro_list": "off", "macsec_hw_offload": "off [fixed]", "rx_udp_gro_forwarding": "off", "hsr_tag_ins_offload": "off [fixed]", "hsr_tag_rm_offload": "off [fixed]", "hsr_fwd_offload": "off [fixed]", "hsr_dup_offload": "off [fixed]"}, "timestamping": [], "hw_timestamp_filters": []}, "ansible_default_ipv4": {"gateway": "10.0.1.1", "interface": "ens5", "address": "10.0.1.171", "broadcast": "", "netmask": "255.255.255.0", "network": "10.0.1.0", "prefix": "24", "macaddress": "06:3e:91:bf:45:f5", "mtu": 9001, "type": "ether", "alias": "ens5"}, "ansible_default_ipv6": {}, "ansible_all_ipv4_addresses": ["10.0.1.171"], "ansible_all_ipv6_addresses": ["fe80::43e:91ff:febf:45f5"], "ansible_locally_reachable_ips": {"ipv4": ["10.0.1.171", "127.0.0.0/8", "127.0.0.1"], "ipv6": ["::1", "fe80::43e:91ff:febf:45f5"]}, "ansible_processor": ["0", "GenuineIntel", "Intel(R) Xeon(R) Platinum 8175M CPU @ 2.50GHz", "1", "GenuineIntel", "Intel(R) Xeon(R) Platinum 8175M CPU @ 2.50GHz"], "ansible_processor_count": 1, "ansible_processor_cores": 1, "ansible_processor_threads_per_core": 2, "ansible_processor_vcpus": 2, "ansible_processor_nproc": 2, "ansible_memtotal_mb": 3827, "ansible_memfree_mb": 3392, "ansible_swaptotal_mb": 0, "ansible_swapfree_mb": 0, "ansible_memory_mb": {"real": {"total": 3827, "used": 435, "free": 3392}, "nocache": {"free": 3559, "used": 268}, "swap": {"total": 0, "free": 0, "used": 0, "cached": 0}}, "ansible_bios_date": "10/16/2017", "ansible_bios_vendor": "Amazon EC2", "ansible_bios_version": "1.0", "ansible_board_asset_tag": "i-0c0e04ec29dd38e0b", "ansible_board_name": "NA", "ansible_board_serial": "NA", "ansible_board_vendor": "Amazon EC2", "ansible_board_version": "NA", "ansible_chassis_asset_tag": "Amazon EC2", "ansible_chassis_serial": "NA", "ansible_chassis_vendor": "Amazon EC2", "ansible_chassis_version": "NA", "ansible_form_factor": "Other", "ansible_product_name": "t3.medium", "ansible_product_serial": "ec2c6bea-bc5d-b423-958b-c58dc1c87f27", "ansible_product_uuid": "ec2c6bea-bc5d-b423-958b-c58dc1c87f27", "ansible_product_version": "NA", "ansible_system_vendor": "Amazon EC2", "ansible_devices": {"loop1": {"virtual": 1, "links": {"ids": [], "uuids": [], "labels": [], "masters": []}, "vendor": null, "model": null, "sas_address": null, "sas_device_handle": null, "removable": "0", "support_discard": "0", "partitions": {}, "rotational": "1", "scheduler_mode": "none", "sectors": "0", "sectorsize": "512", "size": "0.00 Bytes", "host": "", "holders": []}, "nvme0n1": {"virtual": 1, "links": {"ids": ["nvme-Amazon_Elastic_Block_Store_vol006b4df43030b06c5", "nvme-Amazon_Elastic_Block_Store_vol006b4df43030b06c5-ns-1", "nvme-Amazon_Elastic_Block_Store_vol006b4df43030b06c5_1", "nvme-nvme.1d0f-766f6c3030366234646634333033306230366335-416d617a6f6e20456c617374696320426c6f636b2053746f7265-00000001"], "uuids": [], "labels": [], "masters": []}, "vendor": null, "model": "Amazon Elastic Block Store", "sas_address": null, "sas_device_handle": null, "serial": "vol006b4df43030b06c5", "removable": "0", "support_discard": "0", "partitions": {"nvme0n1p1": {"links": {"ids": ["nvme-Amazon_Elastic_Block_Store_vol006b4df43030b06c5-ns-1-part1", "nvme-Amazon_Elastic_Block_Store_vol006b4df43030b06c5-part1", "nvme-Amazon_Elastic_Block_Store_vol006b4df43030b06c5_1-part1", "nvme-nvme.1d0f-766f6c3030366234646634333033306230366335-416d617a6f6e20456c617374696320426c6f636b2053746f7265-00000001-part1"], "uuids": ["36d29e5b-3776-49ee-a4d6-5868c3a57848"], "labels": ["\\\\x2f"], "masters": []}, "start": "24576", "sectors": "16752607", "sectorsize": 512, "size": "7.99 GB", "uuid": "36d29e5b-3776-49ee-a4d6-5868c3a57848", "holders": []}, "nvme0n1p128": {"links": {"ids": ["nvme-Amazon_Elastic_Block_Store_vol006b4df43030b06c5-ns-1-part128", "nvme-Amazon_Elastic_Block_Store_vol006b4df43030b06c5-part128", "nvme-Amazon_Elastic_Block_Store_vol006b4df43030b06c5_1-part128", "nvme-nvme.1d0f-766f6c3030366234646634333033306230366335-416d617a6f6e20456c617374696320426c6f636b2053746f7265-00000001-part128"], "uuids": ["BE57-6C57"], "labels": [], "masters": []}, "start": "2048", "sectors": "20480", "sectorsize": 512, "size": "10.00 MB", "uuid": "BE57-6C57", "holders": []}, "nvme0n1p127": {"links": {"ids": ["nvme-Amazon_Elastic_Block_Store_vol006b4df43030b06c5-ns-1-part127", "nvme-Amazon_Elastic_Block_Store_vol006b4df43030b06c5-part127", "nvme-Amazon_Elastic_Block_Store_vol006b4df43030b06c5_1-part127", "nvme-nvme.1d0f-766f6c3030366234646634333033306230366335-416d617a6f6e20456c617374696320426c6f636b2053746f7265-00000001-part127"], "uuids": [], "labels": [], "masters": []}, "start": "22528", "sectors": "2048", "sectorsize": 512, "size": "1.00 MB", "uuid": null, "holders": []}}, "rotational": "0", "scheduler_mode": "none", "sectors": "16777216", "sectorsize": "512", "size": "8.00 GB", "host": "Non-Volatile memory controller: Amazon.com, Inc. NVMe EBS Controller", "holders": []}, "loop6": {"virtual": 1, "links": {"ids": [], "uuids": [], "labels": [], "masters": []}, "vendor": null, "model": null, "sas_address": null, "sas_device_handle": null, "removable": "0", "support_discard": "0", "partitions": {}, "rotational": "1", "scheduler_mode": "none", "sectors": "0", "sectorsize": "512", "size": "0.00 Bytes", "host": "", "holders": []}, "loop4": {"virtual": 1, "links": {"ids": [], "uuids": [], "labels": [], "masters": []}, "vendor": null, "model": null, "sas_address": null, "sas_device_handle": null, "removable": "0", "support_discard": "0", "partitions": {}, "rotational": "1", "scheduler_mode": "none", "sectors": "0", "sectorsize": "512", "size": "0.00 Bytes", "host": "", "holders": []}, "loop2": {"virtual": 1, "links": {"ids": [], "uuids": [], "labels": [], "masters": []}, "vendor": null, "model": null, "sas_address": null, "sas_device_handle": null, "removable": "0", "support_discard": "0", "partitions": {}, "rotational": "1", "scheduler_mode": "none", "sectors": "0", "sectorsize": "512", "size": "0.00 Bytes", "host": "", "holders": []}, "loop0": {"virtual": 1, "links": {"ids": [], "uuids": [], "labels": [], "masters": []}, "vendor": null, "model": null, "sas_address": null, "sas_device_handle": null, "removable": "0", "support_discard": "0", "partitions": {}, "rotational": "1", "scheduler_mode": "none", "sectors": "0", "sectorsize": "512", "size": "0.00 Bytes", "host": "", "holders": []}, "loop7": {"virtual": 1, "links": {"ids": [], "uuids": [], "labels": [], "masters": []}, "vendor": null, "model": null, "sas_address": null, "sas_device_handle": null, "removable": "0", "support_discard": "0", "partitions": {}, "rotational": "1", "scheduler_mode": "none", "sectors": "0", "sectorsize": "512", "size": "0.00 Bytes", "host": "", "holders": []}, "loop5": {"virtual": 1, "links": {"ids": [], "uuids": [], "labels": [], "masters": []}, "vendor": null, "model": null, "sas_address": null, "sas_device_handle": null, "removable": "0", "support_discard": "0", "partitions": {}, "rotational": "1", "scheduler_mode": "none", "sectors": "0", "sectorsize": "512", "size": "0.00 Bytes", "host": "", "holders": []}, "loop3": {"virtual": 1, "links": {"ids": [], "uuids": [], "labels": [], "masters": []}, "vendor": null, "model": null, "sas_address": null, "sas_device_handle": null, "removable": "0", "support_discard": "0", "partitions": {}, "rotational": "1", "scheduler_mode": "none", "sectors": "0", "sectorsize": "512", "size": "0.00 Bytes", "host": "", "holders": []}}, "ansible_device_links": {"ids": {"nvme0n1p128": ["nvme-Amazon_Elastic_Block_Store_vol006b4df43030b06c5-ns-1-part128", "nvme-Amazon_Elastic_Block_Store_vol006b4df43030b06c5-part128", "nvme-Amazon_Elastic_Block_Store_vol006b4df43030b06c5_1-part128", "nvme-nvme.1d0f-766f6c3030366234646634333033306230366335-416d617a6f6e20456c617374696320426c6f636b2053746f7265-00000001-part128"], "nvme0n1p1": ["nvme-Amazon_Elastic_Block_Store_vol006b4df43030b06c5-ns-1-part1", "nvme-Amazon_Elastic_Block_Store_vol006b4df43030b06c5-part1", "nvme-Amazon_Elastic_Block_Store_vol006b4df43030b06c5_1-part1", "nvme-nvme.1d0f-766f6c3030366234646634333033306230366335-416d617a6f6e20456c617374696320426c6f636b2053746f7265-00000001-part1"], "nvme0n1p127": ["nvme-Amazon_Elastic_Block_Store_vol006b4df43030b06c5-ns-1-part127", "nvme-Amazon_Elastic_Block_Store_vol006b4df43030b06c5-part127", "nvme-Amazon_Elastic_Block_Store_vol006b4df43030b06c5_1-part127", "nvme-nvme.1d0f-766f6c3030366234646634333033306230366335-416d617a6f6e20456c617374696320426c6f636b2053746f7265-00000001-part127"], "nvme0n1": ["nvme-Amazon_Elastic_Block_Store_vol006b4df43030b06c5", "nvme-Amazon_Elastic_Block_Store_vol006b4df43030b06c5-ns-1", "nvme-Amazon_Elastic_Block_Store_vol006b4df43030b06c5_1", "nvme-nvme.1d0f-766f6c3030366234646634333033306230366335-416d617a6f6e20456c617374696320426c6f636b2053746f7265-00000001"]}, "uuids": {"nvme0n1p128": ["BE57-6C57"], "nvme0n1p1": ["36d29e5b-3776-49ee-a4d6-5868c3a57848"]}, "labels": {"nvme0n1p1": ["\\\\x2f"]}, "masters": {}}, "ansible_uptime_seconds": 18, "ansible_lvm": "N/A", "ansible_mounts": [{"mount": "/", "device": "/dev/nvme0n1p1", "fstype": "xfs", "options": "rw,seclabel,noatime,attr2,inode64,logbufs=8,logbsize=32k,sunit=1024,swidth=1024,noquota", "size_total": 8510222336, "size_available": 6914813952, "block_size": 4096, "block_total": 2077691, "block_available": 1688187, "block_used": 389504, "inode_total": 4188096, "inode_available": 4140543, "inode_used": 47553, "uuid": "36d29e5b-3776-49ee-a4d6-5868c3a57848"}, {"mount": "/boot/efi", "device": "/dev/nvme0n1p128", "fstype": "vfat", "options": "rw,noatime,fmask=0077,dmask=0077,codepage=437,iocharset=ascii,shortname=winnt,errors=remount-ro", "size_total": 10446848, "size_available": 9105408, "block_size": 2048, "block_total": 5101, "block_available": 4446, "block_used": 655, "inode_total": 0, "inode_available": 0, "inode_used": 0, "uuid": "BE57-6C57"}], "ansible_service_mgr": "systemd", "gather_subset": ["all"], "module_setup": true}, "invocation": {"module_args": {"gather_subset": ["all"], "gather_timeout": 10, "filter": [], "fact_path": "/etc/ansible/facts.d"}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
[WARNING]: Platform linux on host master is using the discovered Python
interpreter at /usr/bin/python3.9, but future installation of another Python
interpreter could change the meaning of that path. See
https://docs.ansible.com/ansible-
core/2.15/reference_appendices/interpreter_discovery.html for more information.
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'rm -f -r /home/ec2-user/.ansible/tmp/ansible-tmp-1721489213.24219-326314-68371992994540/ > /dev/null 2>&1 && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
ok: [master]

TASK [Get private IP using Ansible fact] ***************************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:7
ok: [master] => {
    "ansible_facts": {
        "master_private_ip": "10.0.1.171"
    },
    "changed": false
}

TASK [Print private IP] ********************************************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:11
ok: [master] => {
    "msg": "The private IP of the target server is: 10.0.1.171"
}

TASK [Get public IP using curl] ************************************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:15
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'echo ~ec2-user && sleep 0'"'"''
<10.0.1.171> (0, b'/home/ec2-user\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /home/ec2-user/.ansible/tmp `"&& mkdir "` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489216.2298028-326352-7057368687770 `" && echo ansible-tmp-1721489216.2298028-326352-7057368687770="` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489216.2298028-326352-7057368687770 `" ) && sleep 0'"'"''
<10.0.1.171> (0, b'ansible-tmp-1721489216.2298028-326352-7057368687770=/home/ec2-user/.ansible/tmp/ansible-tmp-1721489216.2298028-326352-7057368687770\n', b'')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/command.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpwo_79zr6 TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489216.2298028-326352-7057368687770/AnsiballZ_command.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpwo_79zr6 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489216.2298028-326352-7057368687770/AnsiballZ_command.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489216.2298028-326352-7057368687770/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489216.2298028-326352-7057368687770/AnsiballZ_command.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-fkhecfzeradipwrtaxsgojejomtuxabo ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489216.2298028-326352-7057368687770/AnsiballZ_command.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"changed": true, "stdout": "51.21.53.50", "stderr": "", "rc": 0, "cmd": ["curl", "-s", "ifconfig.me"], "start": "2024-07-20 15:26:57.321584", "end": "2024-07-20 15:26:57.474114", "delta": "0:00:00.152530", "msg": "", "invocation": {"module_args": {"_raw_params": "curl -s ifconfig.me", "_uses_shell": false, "stdin_add_newline": true, "strip_empty_ends": true, "argv": null, "chdir": null, "executable": null, "creates": null, "removes": null, "stdin": null}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'rm -f -r /home/ec2-user/.ansible/tmp/ansible-tmp-1721489216.2298028-326352-7057368687770/ > /dev/null 2>&1 && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
changed: [master] => {
    "changed": true,
    "cmd": [
        "curl",
        "-s",
        "ifconfig.me"
    ],
    "delta": "0:00:00.152530",
    "end": "2024-07-20 15:26:57.474114",
    "invocation": {
        "module_args": {
            "_raw_params": "curl -s ifconfig.me",
            "_uses_shell": false,
            "argv": null,
            "chdir": null,
            "creates": null,
            "executable": null,
            "removes": null,
            "stdin": null,
            "stdin_add_newline": true,
            "strip_empty_ends": true
        }
    },
    "msg": "",
    "rc": 0,
    "start": "2024-07-20 15:26:57.321584",
    "stderr": "",
    "stderr_lines": [],
    "stdout": "51.21.53.50",
    "stdout_lines": [
        "51.21.53.50"
    ]
}

TASK [Set master public IP fact] ***********************************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:19
ok: [master] => {
    "ansible_facts": {
        "master_public_ip": "51.21.53.50"
    },
    "changed": false
}

TASK [Print public IP] *********************************************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:23
ok: [master] => {
    "msg": "The public IP of the target server is: 51.21.53.50"
}

TASK [Update all packages] *****************************************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:27
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'echo ~ec2-user && sleep 0'"'"''
<10.0.1.171> (0, b'/home/ec2-user\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /home/ec2-user/.ansible/tmp `"&& mkdir "` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489217.7625017-326406-79973800991569 `" && echo ansible-tmp-1721489217.7625017-326406-79973800991569="` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489217.7625017-326406-79973800991569 `" ) && sleep 0'"'"''
<10.0.1.171> (0, b'ansible-tmp-1721489217.7625017-326406-79973800991569=/home/ec2-user/.ansible/tmp/ansible-tmp-1721489217.7625017-326406-79973800991569\n', b'')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/dnf.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpmx96iajs TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489217.7625017-326406-79973800991569/AnsiballZ_dnf.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpmx96iajs /home/ec2-user/.ansible/tmp/ansible-tmp-1721489217.7625017-326406-79973800991569/AnsiballZ_dnf.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489217.7625017-326406-79973800991569/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489217.7625017-326406-79973800991569/AnsiballZ_dnf.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-yybtxkbfztbfqbausdzmygutqtpnpylu ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489217.7625017-326406-79973800991569/AnsiballZ_dnf.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"msg": "Nothing to do", "changed": false, "results": [], "rc": 0, "invocation": {"module_args": {"name": ["*"], "state": "latest", "update_cache": true, "allow_downgrade": false, "autoremove": false, "bugfix": false, "cacheonly": false, "disable_gpg_check": false, "disable_plugin": [], "disablerepo": [], "download_only": false, "enable_plugin": [], "enablerepo": [], "exclude": [], "installroot": "/", "install_repoquery": true, "install_weak_deps": true, "security": false, "skip_broken": false, "update_only": false, "validate_certs": true, "sslverify": true, "lock_timeout": 30, "allowerasing": false, "nobest": false, "use_backend": "auto", "conf_file": null, "disable_excludes": null, "download_dir": null, "list": null, "releasever": null}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'rm -f -r /home/ec2-user/.ansible/tmp/ansible-tmp-1721489217.7625017-326406-79973800991569/ > /dev/null 2>&1 && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
ok: [master] => {
    "changed": false,
    "invocation": {
        "module_args": {
            "allow_downgrade": false,
            "allowerasing": false,
            "autoremove": false,
            "bugfix": false,
            "cacheonly": false,
            "conf_file": null,
            "disable_excludes": null,
            "disable_gpg_check": false,
            "disable_plugin": [],
            "disablerepo": [],
            "download_dir": null,
            "download_only": false,
            "enable_plugin": [],
            "enablerepo": [],
            "exclude": [],
            "install_repoquery": true,
            "install_weak_deps": true,
            "installroot": "/",
            "list": null,
            "lock_timeout": 30,
            "name": [
                "*"
            ],
            "nobest": false,
            "releasever": null,
            "security": false,
            "skip_broken": false,
            "sslverify": true,
            "state": "latest",
            "update_cache": true,
            "update_only": false,
            "use_backend": "auto",
            "validate_certs": true
        }
    },
    "msg": "Nothing to do",
    "rc": 0,
    "results": []
}

TASK [Disable swap] ************************************************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:33
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'echo ~ec2-user && sleep 0'"'"''
<10.0.1.171> (0, b'/home/ec2-user\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /home/ec2-user/.ansible/tmp `"&& mkdir "` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489230.0702226-326500-236815189876517 `" && echo ansible-tmp-1721489230.0702226-326500-236815189876517="` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489230.0702226-326500-236815189876517 `" ) && sleep 0'"'"''
<10.0.1.171> (0, b'ansible-tmp-1721489230.0702226-326500-236815189876517=/home/ec2-user/.ansible/tmp/ansible-tmp-1721489230.0702226-326500-236815189876517\n', b'')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/command.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpqlxbrxsx TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489230.0702226-326500-236815189876517/AnsiballZ_command.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpqlxbrxsx /home/ec2-user/.ansible/tmp/ansible-tmp-1721489230.0702226-326500-236815189876517/AnsiballZ_command.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489230.0702226-326500-236815189876517/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489230.0702226-326500-236815189876517/AnsiballZ_command.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-qnnzupcgwjcfivhvpsuzpgxmuhjfqlnf ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489230.0702226-326500-236815189876517/AnsiballZ_command.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"changed": true, "stdout": "", "stderr": "", "rc": 0, "cmd": ["swapoff", "-a"], "start": "2024-07-20 15:27:11.047361", "end": "2024-07-20 15:27:11.069080", "delta": "0:00:00.021719", "msg": "", "invocation": {"module_args": {"_raw_params": "swapoff -a", "_uses_shell": false, "stdin_add_newline": true, "strip_empty_ends": true, "argv": null, "chdir": null, "executable": null, "creates": null, "removes": null, "stdin": null}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'rm -f -r /home/ec2-user/.ansible/tmp/ansible-tmp-1721489230.0702226-326500-236815189876517/ > /dev/null 2>&1 && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
changed: [master] => {
    "changed": true,
    "cmd": [
        "swapoff",
        "-a"
    ],
    "delta": "0:00:00.021719",
    "end": "2024-07-20 15:27:11.069080",
    "invocation": {
        "module_args": {
            "_raw_params": "swapoff -a",
            "_uses_shell": false,
            "argv": null,
            "chdir": null,
            "creates": null,
            "executable": null,
            "removes": null,
            "stdin": null,
            "stdin_add_newline": true,
            "strip_empty_ends": true
        }
    },
    "msg": "",
    "rc": 0,
    "start": "2024-07-20 15:27:11.047361",
    "stderr": "",
    "stderr_lines": [],
    "stdout": "",
    "stdout_lines": []
}

TASK [Load kernel modules] *****************************************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:36
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'echo ~ec2-user && sleep 0'"'"''
<10.0.1.171> (0, b'/home/ec2-user\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /home/ec2-user/.ansible/tmp `"&& mkdir "` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489231.348186-326520-215873836161478 `" && echo ansible-tmp-1721489231.348186-326520-215873836161478="` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489231.348186-326520-215873836161478 `" ) && sleep 0'"'"''
<10.0.1.171> (0, b'ansible-tmp-1721489231.348186-326520-215873836161478=/home/ec2-user/.ansible/tmp/ansible-tmp-1721489231.348186-326520-215873836161478\n', b'')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/stat.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmple4j2lhh TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489231.348186-326520-215873836161478/AnsiballZ_stat.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmple4j2lhh /home/ec2-user/.ansible/tmp/ansible-tmp-1721489231.348186-326520-215873836161478/AnsiballZ_stat.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489231.348186-326520-215873836161478/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489231.348186-326520-215873836161478/AnsiballZ_stat.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-wjiatqxhldifwukatvfpwcbzhctfcjxf ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489231.348186-326520-215873836161478/AnsiballZ_stat.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"changed": false, "stat": {"exists": false}, "invocation": {"module_args": {"path": "/etc/modules-load.d/k8s.conf", "follow": false, "get_checksum": true, "checksum_algorithm": "sha1", "get_md5": false, "get_mime": true, "get_attributes": true}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpsoh6xsr5 TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489231.348186-326520-215873836161478/source
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpsoh6xsr5 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489231.348186-326520-215873836161478/source\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489231.348186-326520-215873836161478/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489231.348186-326520-215873836161478/source && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/copy.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmp3zvfpde8 TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489231.348186-326520-215873836161478/AnsiballZ_copy.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmp3zvfpde8 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489231.348186-326520-215873836161478/AnsiballZ_copy.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489231.348186-326520-215873836161478/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489231.348186-326520-215873836161478/AnsiballZ_copy.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-gpadyvyfouisdinlwuujsmvobgddwmof ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489231.348186-326520-215873836161478/AnsiballZ_copy.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"dest": "/etc/modules-load.d/k8s.conf", "src": "/home/ec2-user/.ansible/tmp/ansible-tmp-1721489231.348186-326520-215873836161478/source", "md5sum": "bf4c83b6e00f0135e0b079430a390e7e", "checksum": "34e17debf4a4a1b5743871ab975af918135df3bd", "changed": true, "uid": 0, "gid": 0, "owner": "root", "group": "root", "mode": "0644", "state": "file", "secontext": "system_u:object_r:etc_t:s0", "size": 21, "invocation": {"module_args": {"dest": "/etc/modules-load.d/k8s.conf", "src": "/home/ec2-user/.ansible/tmp/ansible-tmp-1721489231.348186-326520-215873836161478/source", "_original_basename": "tmpsoh6xsr5", "follow": false, "checksum": "34e17debf4a4a1b5743871ab975af918135df3bd", "backup": false, "force": true, "unsafe_writes": false, "content": null, "validate": null, "directory_mode": null, "remote_src": null, "local_follow": null, "mode": null, "owner": null, "group": null, "seuser": null, "serole": null, "selevel": null, "setype": null, "attributes": null}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'rm -f -r /home/ec2-user/.ansible/tmp/ansible-tmp-1721489231.348186-326520-215873836161478/ > /dev/null 2>&1 && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
changed: [master] => {
    "changed": true,
    "checksum": "34e17debf4a4a1b5743871ab975af918135df3bd",
    "dest": "/etc/modules-load.d/k8s.conf",
    "diff": [],
    "gid": 0,
    "group": "root",
    "invocation": {
        "module_args": {
            "_original_basename": "tmpsoh6xsr5",
            "attributes": null,
            "backup": false,
            "checksum": "34e17debf4a4a1b5743871ab975af918135df3bd",
            "content": null,
            "dest": "/etc/modules-load.d/k8s.conf",
            "directory_mode": null,
            "follow": false,
            "force": true,
            "group": null,
            "local_follow": null,
            "mode": null,
            "owner": null,
            "remote_src": null,
            "selevel": null,
            "serole": null,
            "setype": null,
            "seuser": null,
            "src": "/home/ec2-user/.ansible/tmp/ansible-tmp-1721489231.348186-326520-215873836161478/source",
            "unsafe_writes": false,
            "validate": null
        }
    },
    "md5sum": "bf4c83b6e00f0135e0b079430a390e7e",
    "mode": "0644",
    "owner": "root",
    "secontext": "system_u:object_r:etc_t:s0",
    "size": 21,
    "src": "/home/ec2-user/.ansible/tmp/ansible-tmp-1721489231.348186-326520-215873836161478/source",
    "state": "file",
    "uid": 0
}

TASK [Load kernel modules immediately] *****************************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:43
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'echo ~ec2-user && sleep 0'"'"''
<10.0.1.171> (0, b'/home/ec2-user\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /home/ec2-user/.ansible/tmp `"&& mkdir "` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489233.8619375-326575-78086078843997 `" && echo ansible-tmp-1721489233.8619375-326575-78086078843997="` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489233.8619375-326575-78086078843997 `" ) && sleep 0'"'"''
<10.0.1.171> (0, b'ansible-tmp-1721489233.8619375-326575-78086078843997=/home/ec2-user/.ansible/tmp/ansible-tmp-1721489233.8619375-326575-78086078843997\n', b'')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/command.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpwqjhr5vv TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489233.8619375-326575-78086078843997/AnsiballZ_command.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpwqjhr5vv /home/ec2-user/.ansible/tmp/ansible-tmp-1721489233.8619375-326575-78086078843997/AnsiballZ_command.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489233.8619375-326575-78086078843997/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489233.8619375-326575-78086078843997/AnsiballZ_command.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-smzttapxsgbbqjdplqlnbpsdjpnqtonz ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489233.8619375-326575-78086078843997/AnsiballZ_command.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"changed": true, "stdout": "", "stderr": "", "rc": 0, "cmd": ["modprobe", "overlay"], "start": "2024-07-20 15:27:14.444312", "end": "2024-07-20 15:27:14.466667", "delta": "0:00:00.022355", "msg": "", "invocation": {"module_args": {"_raw_params": "modprobe overlay", "_uses_shell": false, "stdin_add_newline": true, "strip_empty_ends": true, "argv": null, "chdir": null, "executable": null, "creates": null, "removes": null, "stdin": null}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'rm -f -r /home/ec2-user/.ansible/tmp/ansible-tmp-1721489233.8619375-326575-78086078843997/ > /dev/null 2>&1 && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
changed: [master] => {
    "changed": true,
    "cmd": [
        "modprobe",
        "overlay"
    ],
    "delta": "0:00:00.022355",
    "end": "2024-07-20 15:27:14.466667",
    "invocation": {
        "module_args": {
            "_raw_params": "modprobe overlay",
            "_uses_shell": false,
            "argv": null,
            "chdir": null,
            "creates": null,
            "executable": null,
            "removes": null,
            "stdin": null,
            "stdin_add_newline": true,
            "strip_empty_ends": true
        }
    },
    "msg": "",
    "rc": 0,
    "start": "2024-07-20 15:27:14.444312",
    "stderr": "",
    "stderr_lines": [],
    "stdout": "",
    "stdout_lines": []
}

TASK [command] *****************************************************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:45
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'echo ~ec2-user && sleep 0'"'"''
<10.0.1.171> (0, b'/home/ec2-user\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /home/ec2-user/.ansible/tmp `"&& mkdir "` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489234.6422954-326584-8789920709484 `" && echo ansible-tmp-1721489234.6422954-326584-8789920709484="` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489234.6422954-326584-8789920709484 `" ) && sleep 0'"'"''
<10.0.1.171> (0, b'ansible-tmp-1721489234.6422954-326584-8789920709484=/home/ec2-user/.ansible/tmp/ansible-tmp-1721489234.6422954-326584-8789920709484\n', b'')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/command.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpdt2o8svt TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489234.6422954-326584-8789920709484/AnsiballZ_command.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpdt2o8svt /home/ec2-user/.ansible/tmp/ansible-tmp-1721489234.6422954-326584-8789920709484/AnsiballZ_command.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489234.6422954-326584-8789920709484/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489234.6422954-326584-8789920709484/AnsiballZ_command.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-mmgldmthzkwgpuggdzmzmdxqxitjzccy ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489234.6422954-326584-8789920709484/AnsiballZ_command.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"changed": true, "stdout": "", "stderr": "", "rc": 0, "cmd": ["modprobe", "br_netfilter"], "start": "2024-07-20 15:27:15.135954", "end": "2024-07-20 15:27:15.189143", "delta": "0:00:00.053189", "msg": "", "invocation": {"module_args": {"_raw_params": "modprobe br_netfilter", "_uses_shell": false, "stdin_add_newline": true, "strip_empty_ends": true, "argv": null, "chdir": null, "executable": null, "creates": null, "removes": null, "stdin": null}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'rm -f -r /home/ec2-user/.ansible/tmp/ansible-tmp-1721489234.6422954-326584-8789920709484/ > /dev/null 2>&1 && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
changed: [master] => {
    "changed": true,
    "cmd": [
        "modprobe",
        "br_netfilter"
    ],
    "delta": "0:00:00.053189",
    "end": "2024-07-20 15:27:15.189143",
    "invocation": {
        "module_args": {
            "_raw_params": "modprobe br_netfilter",
            "_uses_shell": false,
            "argv": null,
            "chdir": null,
            "creates": null,
            "executable": null,
            "removes": null,
            "stdin": null,
            "stdin_add_newline": true,
            "strip_empty_ends": true
        }
    },
    "msg": "",
    "rc": 0,
    "start": "2024-07-20 15:27:15.135954",
    "stderr": "",
    "stderr_lines": [],
    "stdout": "",
    "stdout_lines": []
}

TASK [Set system configurations for Kubernetes] ********************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:47
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'echo ~ec2-user && sleep 0'"'"''
<10.0.1.171> (0, b'/home/ec2-user\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /home/ec2-user/.ansible/tmp `"&& mkdir "` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489235.3300798-326593-198110165312244 `" && echo ansible-tmp-1721489235.3300798-326593-198110165312244="` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489235.3300798-326593-198110165312244 `" ) && sleep 0'"'"''
<10.0.1.171> (0, b'ansible-tmp-1721489235.3300798-326593-198110165312244=/home/ec2-user/.ansible/tmp/ansible-tmp-1721489235.3300798-326593-198110165312244\n', b'')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/stat.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpfk_r0my4 TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489235.3300798-326593-198110165312244/AnsiballZ_stat.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpfk_r0my4 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489235.3300798-326593-198110165312244/AnsiballZ_stat.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489235.3300798-326593-198110165312244/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489235.3300798-326593-198110165312244/AnsiballZ_stat.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-ispksbqeprgqntfrlcizyqgirsihaujz ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489235.3300798-326593-198110165312244/AnsiballZ_stat.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"changed": false, "stat": {"exists": false}, "invocation": {"module_args": {"path": "/etc/sysctl.d/k8s.conf", "follow": false, "get_checksum": true, "checksum_algorithm": "sha1", "get_md5": false, "get_mime": true, "get_attributes": true}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmp6wpvvk_p TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489235.3300798-326593-198110165312244/source
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmp6wpvvk_p /home/ec2-user/.ansible/tmp/ansible-tmp-1721489235.3300798-326593-198110165312244/source\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489235.3300798-326593-198110165312244/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489235.3300798-326593-198110165312244/source && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/copy.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmp34g3oyjc TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489235.3300798-326593-198110165312244/AnsiballZ_copy.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmp34g3oyjc /home/ec2-user/.ansible/tmp/ansible-tmp-1721489235.3300798-326593-198110165312244/AnsiballZ_copy.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489235.3300798-326593-198110165312244/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489235.3300798-326593-198110165312244/AnsiballZ_copy.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-vbdziuafnmkrsrfctogzqfwephrhuoix ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489235.3300798-326593-198110165312244/AnsiballZ_copy.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"dest": "/etc/sysctl.d/k8s.conf", "src": "/home/ec2-user/.ansible/tmp/ansible-tmp-1721489235.3300798-326593-198110165312244/source", "md5sum": "1860bedbd41fa91e465e58b8b58a6043", "checksum": "4b56c44339db7752e7312da6ab12ff17ad6b95ee", "changed": true, "uid": 0, "gid": 0, "owner": "root", "group": "root", "mode": "0644", "state": "file", "secontext": "system_u:object_r:etc_t:s0", "size": 120, "invocation": {"module_args": {"dest": "/etc/sysctl.d/k8s.conf", "src": "/home/ec2-user/.ansible/tmp/ansible-tmp-1721489235.3300798-326593-198110165312244/source", "_original_basename": "tmp6wpvvk_p", "follow": false, "checksum": "4b56c44339db7752e7312da6ab12ff17ad6b95ee", "backup": false, "force": true, "unsafe_writes": false, "content": null, "validate": null, "directory_mode": null, "remote_src": null, "local_follow": null, "mode": null, "owner": null, "group": null, "seuser": null, "serole": null, "selevel": null, "setype": null, "attributes": null}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'rm -f -r /home/ec2-user/.ansible/tmp/ansible-tmp-1721489235.3300798-326593-198110165312244/ > /dev/null 2>&1 && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
changed: [master] => {
    "changed": true,
    "checksum": "4b56c44339db7752e7312da6ab12ff17ad6b95ee",
    "dest": "/etc/sysctl.d/k8s.conf",
    "diff": [],
    "gid": 0,
    "group": "root",
    "invocation": {
        "module_args": {
            "_original_basename": "tmp6wpvvk_p",
            "attributes": null,
            "backup": false,
            "checksum": "4b56c44339db7752e7312da6ab12ff17ad6b95ee",
            "content": null,
            "dest": "/etc/sysctl.d/k8s.conf",
            "directory_mode": null,
            "follow": false,
            "force": true,
            "group": null,
            "local_follow": null,
            "mode": null,
            "owner": null,
            "remote_src": null,
            "selevel": null,
            "serole": null,
            "setype": null,
            "seuser": null,
            "src": "/home/ec2-user/.ansible/tmp/ansible-tmp-1721489235.3300798-326593-198110165312244/source",
            "unsafe_writes": false,
            "validate": null
        }
    },
    "md5sum": "1860bedbd41fa91e465e58b8b58a6043",
    "mode": "0644",
    "owner": "root",
    "secontext": "system_u:object_r:etc_t:s0",
    "size": 120,
    "src": "/home/ec2-user/.ansible/tmp/ansible-tmp-1721489235.3300798-326593-198110165312244/source",
    "state": "file",
    "uid": 0
}

TASK [Apply sysctl params without reboot] **************************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:55
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'echo ~ec2-user && sleep 0'"'"''
<10.0.1.171> (0, b'/home/ec2-user\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /home/ec2-user/.ansible/tmp `"&& mkdir "` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489236.420375-326621-174363893920596 `" && echo ansible-tmp-1721489236.420375-326621-174363893920596="` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489236.420375-326621-174363893920596 `" ) && sleep 0'"'"''
<10.0.1.171> (0, b'ansible-tmp-1721489236.420375-326621-174363893920596=/home/ec2-user/.ansible/tmp/ansible-tmp-1721489236.420375-326621-174363893920596\n', b'')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/command.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmplrow4h45 TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489236.420375-326621-174363893920596/AnsiballZ_command.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmplrow4h45 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489236.420375-326621-174363893920596/AnsiballZ_command.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489236.420375-326621-174363893920596/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489236.420375-326621-174363893920596/AnsiballZ_command.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-icasckbtrnyfvlplvkaefmszavyhnqyr ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489236.420375-326621-174363893920596/AnsiballZ_command.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"changed": true, "stdout": "* Applying /etc/sysctl.d/00-defaults.conf ...\\nkernel.printk = 8 4 1 7\\nkernel.panic = 5\\nnet.ipv4.neigh.default.gc_thresh1 = 0\\nnet.ipv6.neigh.default.gc_thresh1 = 0\\nnet.ipv4.neigh.default.gc_thresh2 = 15360\\nnet.ipv6.neigh.default.gc_thresh2 = 15360\\nnet.ipv4.neigh.default.gc_thresh3 = 16384\\nnet.ipv6.neigh.default.gc_thresh3 = 16384\\nnet.ipv4.tcp_wmem = 4096 20480 4194304\\nnet.ipv4.ip_default_ttl = 127\\nkernel.unprivileged_bpf_disabled = 1\\n* Applying /usr/lib/sysctl.d/10-default-yama-scope.conf ...\\nkernel.yama.ptrace_scope = 0\\n* Applying /usr/lib/sysctl.d/50-coredump.conf ...\\nkernel.core_pattern = |/usr/lib/systemd/systemd-coredump %P %u %g %s %t %c %h\\nkernel.core_pipe_limit = 16\\nfs.suid_dumpable = 2\\n* Applying /usr/lib/sysctl.d/50-default.conf ...\\nkernel.sysrq = 16\\nkernel.core_uses_pid = 1\\nnet.ipv4.conf.default.rp_filter = 2\\nnet.ipv4.conf.default.accept_source_route = 0\\nnet.ipv4.conf.default.promote_secondaries = 1\\nnet.ipv4.ping_group_range = 0 2147483647\\nnet.core.default_qdisc = fq_codel\\nfs.protected_hardlinks = 1\\nfs.protected_symlinks = 1\\nfs.protected_regular = 1\\nfs.protected_fifos = 1\\n* Applying /usr/lib/sysctl.d/50-libkcapi-optmem_max.conf ...\\nnet.core.optmem_max = 81920\\n* Applying /usr/lib/sysctl.d/50-pid-max.conf ...\\nkernel.pid_max = 4194304\\n* Applying /usr/lib/sysctl.d/60-amazon-linux-coredump.conf ...\\nfs.suid_dumpable = 0\\n* Applying /etc/sysctl.d/99-sysctl.conf ...\\n* Applying /etc/sysctl.d/k8s.conf ...\\nnet.bridge.bridge-nf-call-iptables = 1\\nnet.bridge.bridge-nf-call-ip6tables = 1\\nnet.ipv4.ip_forward = 1\\n* Applying /etc/sysctl.conf ...", "stderr": "sysctl: setting key \\"net.ipv4.conf.all.rp_filter\\": Invalid argument\\nsysctl: setting key \\"net.ipv4.conf.all.accept_source_route\\": Invalid argument\\nsysctl: setting key \\"net.ipv4.conf.all.promote_secondaries\\": Invalid argument", "rc": 0, "cmd": ["sysctl", "--system"], "start": "2024-07-20 15:27:16.815381", "end": "2024-07-20 15:27:16.821249", "delta": "0:00:00.005868", "msg": "", "invocation": {"module_args": {"_raw_params": "sysctl --system", "_uses_shell": false, "stdin_add_newline": true, "strip_empty_ends": true, "argv": null, "chdir": null, "executable": null, "creates": null, "removes": null, "stdin": null}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'rm -f -r /home/ec2-user/.ansible/tmp/ansible-tmp-1721489236.420375-326621-174363893920596/ > /dev/null 2>&1 && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
changed: [master] => {
    "changed": true,
    "cmd": [
        "sysctl",
        "--system"
    ],
    "delta": "0:00:00.005868",
    "end": "2024-07-20 15:27:16.821249",
    "invocation": {
        "module_args": {
            "_raw_params": "sysctl --system",
            "_uses_shell": false,
            "argv": null,
            "chdir": null,
            "creates": null,
            "executable": null,
            "removes": null,
            "stdin": null,
            "stdin_add_newline": true,
            "strip_empty_ends": true
        }
    },
    "msg": "",
    "rc": 0,
    "start": "2024-07-20 15:27:16.815381",
    "stderr": "sysctl: setting key \"net.ipv4.conf.all.rp_filter\": Invalid argument\nsysctl: setting key \"net.ipv4.conf.all.accept_source_route\": Invalid argument\nsysctl: setting key \"net.ipv4.conf.all.promote_secondaries\": Invalid argument",
    "stderr_lines": [
        "sysctl: setting key \"net.ipv4.conf.all.rp_filter\": Invalid argument",
        "sysctl: setting key \"net.ipv4.conf.all.accept_source_route\": Invalid argument",
        "sysctl: setting key \"net.ipv4.conf.all.promote_secondaries\": Invalid argument"
    ],
    "stdout": "* Applying /etc/sysctl.d/00-defaults.conf ...\nkernel.printk = 8 4 1 7\nkernel.panic = 5\nnet.ipv4.neigh.default.gc_thresh1 = 0\nnet.ipv6.neigh.default.gc_thresh1 = 0\nnet.ipv4.neigh.default.gc_thresh2 = 15360\nnet.ipv6.neigh.default.gc_thresh2 = 15360\nnet.ipv4.neigh.default.gc_thresh3 = 16384\nnet.ipv6.neigh.default.gc_thresh3 = 16384\nnet.ipv4.tcp_wmem = 4096 20480 4194304\nnet.ipv4.ip_default_ttl = 127\nkernel.unprivileged_bpf_disabled = 1\n* Applying /usr/lib/sysctl.d/10-default-yama-scope.conf ...\nkernel.yama.ptrace_scope = 0\n* Applying /usr/lib/sysctl.d/50-coredump.conf ...\nkernel.core_pattern = |/usr/lib/systemd/systemd-coredump %P %u %g %s %t %c %h\nkernel.core_pipe_limit = 16\nfs.suid_dumpable = 2\n* Applying /usr/lib/sysctl.d/50-default.conf ...\nkernel.sysrq = 16\nkernel.core_uses_pid = 1\nnet.ipv4.conf.default.rp_filter = 2\nnet.ipv4.conf.default.accept_source_route = 0\nnet.ipv4.conf.default.promote_secondaries = 1\nnet.ipv4.ping_group_range = 0 2147483647\nnet.core.default_qdisc = fq_codel\nfs.protected_hardlinks = 1\nfs.protected_symlinks = 1\nfs.protected_regular = 1\nfs.protected_fifos = 1\n* Applying /usr/lib/sysctl.d/50-libkcapi-optmem_max.conf ...\nnet.core.optmem_max = 81920\n* Applying /usr/lib/sysctl.d/50-pid-max.conf ...\nkernel.pid_max = 4194304\n* Applying /usr/lib/sysctl.d/60-amazon-linux-coredump.conf ...\nfs.suid_dumpable = 0\n* Applying /etc/sysctl.d/99-sysctl.conf ...\n* Applying /etc/sysctl.d/k8s.conf ...\nnet.bridge.bridge-nf-call-iptables = 1\nnet.bridge.bridge-nf-call-ip6tables = 1\nnet.ipv4.ip_forward = 1\n* Applying /etc/sysctl.conf ...",
    "stdout_lines": [
        "* Applying /etc/sysctl.d/00-defaults.conf ...",
        "kernel.printk = 8 4 1 7",
        "kernel.panic = 5",
        "net.ipv4.neigh.default.gc_thresh1 = 0",
        "net.ipv6.neigh.default.gc_thresh1 = 0",
        "net.ipv4.neigh.default.gc_thresh2 = 15360",
        "net.ipv6.neigh.default.gc_thresh2 = 15360",
        "net.ipv4.neigh.default.gc_thresh3 = 16384",
        "net.ipv6.neigh.default.gc_thresh3 = 16384",
        "net.ipv4.tcp_wmem = 4096 20480 4194304",
        "net.ipv4.ip_default_ttl = 127",
        "kernel.unprivileged_bpf_disabled = 1",
        "* Applying /usr/lib/sysctl.d/10-default-yama-scope.conf ...",
        "kernel.yama.ptrace_scope = 0",
        "* Applying /usr/lib/sysctl.d/50-coredump.conf ...",
        "kernel.core_pattern = |/usr/lib/systemd/systemd-coredump %P %u %g %s %t %c %h",
        "kernel.core_pipe_limit = 16",
        "fs.suid_dumpable = 2",
        "* Applying /usr/lib/sysctl.d/50-default.conf ...",
        "kernel.sysrq = 16",
        "kernel.core_uses_pid = 1",
        "net.ipv4.conf.default.rp_filter = 2",
        "net.ipv4.conf.default.accept_source_route = 0",
        "net.ipv4.conf.default.promote_secondaries = 1",
        "net.ipv4.ping_group_range = 0 2147483647",
        "net.core.default_qdisc = fq_codel",
        "fs.protected_hardlinks = 1",
        "fs.protected_symlinks = 1",
        "fs.protected_regular = 1",
        "fs.protected_fifos = 1",
        "* Applying /usr/lib/sysctl.d/50-libkcapi-optmem_max.conf ...",
        "net.core.optmem_max = 81920",
        "* Applying /usr/lib/sysctl.d/50-pid-max.conf ...",
        "kernel.pid_max = 4194304",
        "* Applying /usr/lib/sysctl.d/60-amazon-linux-coredump.conf ...",
        "fs.suid_dumpable = 0",
        "* Applying /etc/sysctl.d/99-sysctl.conf ...",
        "* Applying /etc/sysctl.d/k8s.conf ...",
        "net.bridge.bridge-nf-call-iptables = 1",
        "net.bridge.bridge-nf-call-ip6tables = 1",
        "net.ipv4.ip_forward = 1",
        "* Applying /etc/sysctl.conf ..."
    ]
}

TASK [Download containerd] *****************************************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:60
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'echo ~ec2-user && sleep 0'"'"''
<10.0.1.171> (0, b'/home/ec2-user\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /home/ec2-user/.ansible/tmp `"&& mkdir "` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489236.9771492-326630-3220903625587 `" && echo ansible-tmp-1721489236.9771492-326630-3220903625587="` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489236.9771492-326630-3220903625587 `" ) && sleep 0'"'"''
<10.0.1.171> (0, b'ansible-tmp-1721489236.9771492-326630-3220903625587=/home/ec2-user/.ansible/tmp/ansible-tmp-1721489236.9771492-326630-3220903625587\n', b'')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/get_url.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpv1pr5pwb TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489236.9771492-326630-3220903625587/AnsiballZ_get_url.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpv1pr5pwb /home/ec2-user/.ansible/tmp/ansible-tmp-1721489236.9771492-326630-3220903625587/AnsiballZ_get_url.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489236.9771492-326630-3220903625587/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489236.9771492-326630-3220903625587/AnsiballZ_get_url.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-ebgordivamjscoepjldqugomqwagjxqs ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489236.9771492-326630-3220903625587/AnsiballZ_get_url.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"msg": "OK (42998577 bytes)", "status_code": 200, "changed": true, "checksum_dest": null, "checksum_src": "8ee9ce35f17deb948a1cc885aa600f109e3e0835", "dest": "/tmp/containerd-1.6.2-linux-amd64.tar.gz", "elapsed": 1, "url": "https://github.com/containerd/containerd/releases/download/v1.6.2/containerd-1.6.2-linux-amd64.tar.gz", "src": "/home/ec2-user/.ansible/tmp/ansible-tmp-1721489236.9771492-326630-3220903625587/tmpzl1l7vmv", "md5sum": "6ef54e3dc7fc8f53a1b3f872bc4a39b4", "uid": 0, "gid": 0, "owner": "root", "group": "root", "mode": "0644", "state": "file", "secontext": "unconfined_u:object_r:user_home_t:s0", "size": 42998577, "invocation": {"module_args": {"url": "https://github.com/containerd/containerd/releases/download/v1.6.2/containerd-1.6.2-linux-amd64.tar.gz", "dest": "/tmp/containerd-1.6.2-linux-amd64.tar.gz", "force": false, "http_agent": "ansible-httpget", "use_proxy": true, "validate_certs": true, "force_basic_auth": false, "use_gssapi": false, "backup": false, "checksum": "", "timeout": 10, "unredirected_headers": [], "decompress": true, "use_netrc": true, "unsafe_writes": false, "url_username": null, "url_password": null, "client_cert": null, "client_key": null, "headers": null, "tmp_dest": null, "ciphers": null, "mode": null, "owner": null, "group": null, "seuser": null, "serole": null, "selevel": null, "setype": null, "attributes": null}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'rm -f -r /home/ec2-user/.ansible/tmp/ansible-tmp-1721489236.9771492-326630-3220903625587/ > /dev/null 2>&1 && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
changed: [master] => {
    "changed": true,
    "checksum_dest": null,
    "checksum_src": "8ee9ce35f17deb948a1cc885aa600f109e3e0835",
    "dest": "/tmp/containerd-1.6.2-linux-amd64.tar.gz",
    "elapsed": 1,
    "gid": 0,
    "group": "root",
    "invocation": {
        "module_args": {
            "attributes": null,
            "backup": false,
            "checksum": "",
            "ciphers": null,
            "client_cert": null,
            "client_key": null,
            "decompress": true,
            "dest": "/tmp/containerd-1.6.2-linux-amd64.tar.gz",
            "force": false,
            "force_basic_auth": false,
            "group": null,
            "headers": null,
            "http_agent": "ansible-httpget",
            "mode": null,
            "owner": null,
            "selevel": null,
            "serole": null,
            "setype": null,
            "seuser": null,
            "timeout": 10,
            "tmp_dest": null,
            "unredirected_headers": [],
            "unsafe_writes": false,
            "url": "https://github.com/containerd/containerd/releases/download/v1.6.2/containerd-1.6.2-linux-amd64.tar.gz",
            "url_password": null,
            "url_username": null,
            "use_gssapi": false,
            "use_netrc": true,
            "use_proxy": true,
            "validate_certs": true
        }
    },
    "md5sum": "6ef54e3dc7fc8f53a1b3f872bc4a39b4",
    "mode": "0644",
    "msg": "OK (42998577 bytes)",
    "owner": "root",
    "secontext": "unconfined_u:object_r:user_home_t:s0",
    "size": 42998577,
    "src": "/home/ec2-user/.ansible/tmp/ansible-tmp-1721489236.9771492-326630-3220903625587/tmpzl1l7vmv",
    "state": "file",
    "status_code": 200,
    "uid": 0,
    "url": "https://github.com/containerd/containerd/releases/download/v1.6.2/containerd-1.6.2-linux-amd64.tar.gz"
}

TASK [Extract containerd] ******************************************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:65
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'echo ~ec2-user && sleep 0'"'"''
<10.0.1.171> (0, b'/home/ec2-user\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /home/ec2-user/.ansible/tmp `"&& mkdir "` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489239.1770213-326645-30463432360985 `" && echo ansible-tmp-1721489239.1770213-326645-30463432360985="` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489239.1770213-326645-30463432360985 `" ) && sleep 0'"'"''
<10.0.1.171> (0, b'ansible-tmp-1721489239.1770213-326645-30463432360985=/home/ec2-user/.ansible/tmp/ansible-tmp-1721489239.1770213-326645-30463432360985\n', b'')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/stat.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpc0r09z37 TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489239.1770213-326645-30463432360985/AnsiballZ_stat.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpc0r09z37 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489239.1770213-326645-30463432360985/AnsiballZ_stat.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489239.1770213-326645-30463432360985/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489239.1770213-326645-30463432360985/AnsiballZ_stat.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-junvtnrvnckmtfnbppsmcialbfllpyuf ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489239.1770213-326645-30463432360985/AnsiballZ_stat.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"changed": false, "stat": {"exists": true, "path": "/usr/local", "mode": "0755", "isdir": true, "ischr": false, "isblk": false, "isreg": false, "isfifo": false, "islnk": false, "issock": false, "uid": 0, "gid": 0, "size": 131, "inode": 8524968, "dev": 66305, "nlink": 12, "atime": 1719536775.33687, "mtime": 1719536669.5682578, "ctime": 1719536773.372933, "wusr": true, "rusr": true, "xusr": true, "wgrp": false, "rgrp": true, "xgrp": true, "woth": false, "roth": true, "xoth": true, "isuid": false, "isgid": false, "blocks": 0, "block_size": 4096, "device_type": 0, "readable": true, "writeable": true, "executable": true, "pw_name": "root", "gr_name": "root", "mimetype": "inode/directory", "charset": "binary", "version": "2884528617", "attributes": [], "attr_flags": ""}, "invocation": {"module_args": {"path": "/usr/local", "follow": true, "get_checksum": true, "checksum_algorithm": "sha1", "get_md5": false, "get_mime": true, "get_attributes": true}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/unarchive.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmp2dvny8sg TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489239.1770213-326645-30463432360985/AnsiballZ_unarchive.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmp2dvny8sg /home/ec2-user/.ansible/tmp/ansible-tmp-1721489239.1770213-326645-30463432360985/AnsiballZ_unarchive.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489239.1770213-326645-30463432360985/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489239.1770213-326645-30463432360985/AnsiballZ_unarchive.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-trsrlmdctmysmrbdxdyjalqcxixdgbcw ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489239.1770213-326645-30463432360985/AnsiballZ_unarchive.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"handler": "TgzArchive", "dest": "/usr/local", "src": "/tmp/containerd-1.6.2-linux-amd64.tar.gz", "extract_results": {"cmd": ["/usr/bin/gtar", "--extract", "-C", "/usr/local", "-z", "-f", "/tmp/containerd-1.6.2-linux-amd64.tar.gz"], "rc": 0, "out": "", "err": ""}, "changed": true, "uid": 0, "gid": 0, "owner": "root", "group": "root", "mode": "0755", "state": "directory", "secontext": "system_u:object_r:usr_t:s0", "size": 131, "invocation": {"module_args": {"src": "/tmp/containerd-1.6.2-linux-amd64.tar.gz", "dest": "/usr/local", "remote_src": true, "list_files": false, "keep_newer": false, "exclude": [], "include": [], "extra_opts": [], "validate_certs": true, "io_buffer_size": 65536, "copy": true, "decrypt": true, "unsafe_writes": false, "creates": null, "mode": null, "owner": null, "group": null, "seuser": null, "serole": null, "selevel": null, "setype": null, "attributes": null}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'rm -f -r /home/ec2-user/.ansible/tmp/ansible-tmp-1721489239.1770213-326645-30463432360985/ > /dev/null 2>&1 && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
changed: [master] => {
    "changed": true,
    "dest": "/usr/local",
    "extract_results": {
        "cmd": [
            "/usr/bin/gtar",
            "--extract",
            "-C",
            "/usr/local",
            "-z",
            "-f",
            "/tmp/containerd-1.6.2-linux-amd64.tar.gz"
        ],
        "err": "",
        "out": "",
        "rc": 0
    },
    "gid": 0,
    "group": "root",
    "handler": "TgzArchive",
    "invocation": {
        "module_args": {
            "attributes": null,
            "copy": true,
            "creates": null,
            "decrypt": true,
            "dest": "/usr/local",
            "exclude": [],
            "extra_opts": [],
            "group": null,
            "include": [],
            "io_buffer_size": 65536,
            "keep_newer": false,
            "list_files": false,
            "mode": null,
            "owner": null,
            "remote_src": true,
            "selevel": null,
            "serole": null,
            "setype": null,
            "seuser": null,
            "src": "/tmp/containerd-1.6.2-linux-amd64.tar.gz",
            "unsafe_writes": false,
            "validate_certs": true
        }
    },
    "mode": "0755",
    "owner": "root",
    "secontext": "system_u:object_r:usr_t:s0",
    "size": 131,
    "src": "/tmp/containerd-1.6.2-linux-amd64.tar.gz",
    "state": "directory",
    "uid": 0
}

TASK [Install containerd service] **********************************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:71
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'echo ~ec2-user && sleep 0'"'"''
<10.0.1.171> (0, b'/home/ec2-user\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /home/ec2-user/.ansible/tmp `"&& mkdir "` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489244.2595687-326725-164598625013082 `" && echo ansible-tmp-1721489244.2595687-326725-164598625013082="` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489244.2595687-326725-164598625013082 `" ) && sleep 0'"'"''
<10.0.1.171> (0, b'ansible-tmp-1721489244.2595687-326725-164598625013082=/home/ec2-user/.ansible/tmp/ansible-tmp-1721489244.2595687-326725-164598625013082\n', b'')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/get_url.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpmjl1608e TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489244.2595687-326725-164598625013082/AnsiballZ_get_url.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpmjl1608e /home/ec2-user/.ansible/tmp/ansible-tmp-1721489244.2595687-326725-164598625013082/AnsiballZ_get_url.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489244.2595687-326725-164598625013082/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489244.2595687-326725-164598625013082/AnsiballZ_get_url.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-ngnkpcbpnfedtrxtfnvkztavqpbufxbq ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489244.2595687-326725-164598625013082/AnsiballZ_get_url.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"msg": "OK (1251 bytes)", "status_code": 200, "changed": true, "checksum_dest": null, "checksum_src": "1765fe17cc60008b68ae7b9676676f2a884192b5", "dest": "/etc/systemd/system/containerd.service", "elapsed": 0, "url": "https://raw.githubusercontent.com/containerd/containerd/main/containerd.service", "src": "/home/ec2-user/.ansible/tmp/ansible-tmp-1721489244.2595687-326725-164598625013082/tmp5obnurnp", "md5sum": "223b9484c3959eecfcd5826031cbc34d", "uid": 0, "gid": 0, "owner": "root", "group": "root", "mode": "0644", "state": "file", "secontext": "system_u:object_r:systemd_unit_file_t:s0", "size": 1251, "invocation": {"module_args": {"url": "https://raw.githubusercontent.com/containerd/containerd/main/containerd.service", "dest": "/etc/systemd/system/containerd.service", "force": false, "http_agent": "ansible-httpget", "use_proxy": true, "validate_certs": true, "force_basic_auth": false, "use_gssapi": false, "backup": false, "checksum": "", "timeout": 10, "unredirected_headers": [], "decompress": true, "use_netrc": true, "unsafe_writes": false, "url_username": null, "url_password": null, "client_cert": null, "client_key": null, "headers": null, "tmp_dest": null, "ciphers": null, "mode": null, "owner": null, "group": null, "seuser": null, "serole": null, "selevel": null, "setype": null, "attributes": null}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'rm -f -r /home/ec2-user/.ansible/tmp/ansible-tmp-1721489244.2595687-326725-164598625013082/ > /dev/null 2>&1 && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
changed: [master] => {
    "changed": true,
    "checksum_dest": null,
    "checksum_src": "1765fe17cc60008b68ae7b9676676f2a884192b5",
    "dest": "/etc/systemd/system/containerd.service",
    "elapsed": 0,
    "gid": 0,
    "group": "root",
    "invocation": {
        "module_args": {
            "attributes": null,
            "backup": false,
            "checksum": "",
            "ciphers": null,
            "client_cert": null,
            "client_key": null,
            "decompress": true,
            "dest": "/etc/systemd/system/containerd.service",
            "force": false,
            "force_basic_auth": false,
            "group": null,
            "headers": null,
            "http_agent": "ansible-httpget",
            "mode": null,
            "owner": null,
            "selevel": null,
            "serole": null,
            "setype": null,
            "seuser": null,
            "timeout": 10,
            "tmp_dest": null,
            "unredirected_headers": [],
            "unsafe_writes": false,
            "url": "https://raw.githubusercontent.com/containerd/containerd/main/containerd.service",
            "url_password": null,
            "url_username": null,
            "use_gssapi": false,
            "use_netrc": true,
            "use_proxy": true,
            "validate_certs": true
        }
    },
    "md5sum": "223b9484c3959eecfcd5826031cbc34d",
    "mode": "0644",
    "msg": "OK (1251 bytes)",
    "owner": "root",
    "secontext": "system_u:object_r:systemd_unit_file_t:s0",
    "size": 1251,
    "src": "/home/ec2-user/.ansible/tmp/ansible-tmp-1721489244.2595687-326725-164598625013082/tmp5obnurnp",
    "state": "file",
    "status_code": 200,
    "uid": 0,
    "url": "https://raw.githubusercontent.com/containerd/containerd/main/containerd.service"
}

TASK [Enable and start containerd] *********************************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:76
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'echo ~ec2-user && sleep 0'"'"''
<10.0.1.171> (0, b'/home/ec2-user\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /home/ec2-user/.ansible/tmp `"&& mkdir "` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489245.2955086-326734-249599970110997 `" && echo ansible-tmp-1721489245.2955086-326734-249599970110997="` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489245.2955086-326734-249599970110997 `" ) && sleep 0'"'"''
<10.0.1.171> (0, b'ansible-tmp-1721489245.2955086-326734-249599970110997=/home/ec2-user/.ansible/tmp/ansible-tmp-1721489245.2955086-326734-249599970110997\n', b'')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/systemd.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpotunnad3 TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489245.2955086-326734-249599970110997/AnsiballZ_systemd.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpotunnad3 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489245.2955086-326734-249599970110997/AnsiballZ_systemd.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489245.2955086-326734-249599970110997/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489245.2955086-326734-249599970110997/AnsiballZ_systemd.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-scpnorociqtdyymxrrkrazwddxtxvmmx ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489245.2955086-326734-249599970110997/AnsiballZ_systemd.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"name": "containerd", "changed": true, "status": {"Type": "notify", "ExitType": "main", "Restart": "always", "NotifyAccess": "main", "RestartUSec": "5s", "TimeoutStartUSec": "1min 30s", "TimeoutStopUSec": "1min 30s", "TimeoutAbortUSec": "1min 30s", "TimeoutStartFailureMode": "terminate", "TimeoutStopFailureMode": "terminate", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "WatchdogUSec": "infinity", "WatchdogTimestampMonotonic": "0", "RootDirectoryStartOnly": "no", "RemainAfterExit": "no", "GuessMainPID": "yes", "MainPID": "0", "ControlPID": "0", "FileDescriptorStoreMax": "0", "NFileDescriptorStore": "0", "StatusErrno": "0", "Result": "success", "ReloadResult": "success", "CleanResult": "success", "UID": "[not set]", "GID": "[not set]", "NRestarts": "0", "OOMPolicy": "continue", "ExecMainStartTimestampMonotonic": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "0", "ExecMainCode": "0", "ExecMainStatus": "0", "ExecStartPre": "{ path=/sbin/modprobe ; argv[]=/sbin/modprobe overlay ; ignore_errors=yes ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartPreEx": "{ path=/sbin/modprobe ; argv[]=/sbin/modprobe overlay ; flags=ignore-failure ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/local/bin/containerd ; argv[]=/usr/local/bin/containerd ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/local/bin/containerd ; argv[]=/usr/local/bin/containerd ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "Slice": "system.slice", "ControlGroupId": "0", "MemoryCurrent": "[not set]", "MemoryAvailable": "infinity", "CPUUsageNSec": "[not set]", "TasksCurrent": "[not set]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "Delegate": "yes", "DelegateControllers": "cpu cpuset io memory pids", "CPUAccounting": "yes", "CPUWeight": "[not set]", "StartupCPUWeight": "[not set]", "CPUShares": "[not set]", "StartupCPUShares": "[not set]", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "IOAccounting": "no", "IOWeight": "[not set]", "StartupIOWeight": "[not set]", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "StartupBlockIOWeight": "[not set]", "MemoryAccounting": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "MemoryMin": "0", "MemoryLow": "0", "MemoryHigh": "infinity", "MemoryMax": "infinity", "MemorySwapMax": "infinity", "MemoryLimit": "infinity", "DevicePolicy": "auto", "TasksAccounting": "yes", "TasksMax": "infinity", "IPAccounting": "no", "ManagedOOMSwap": "auto", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "UMask": "0022", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitSTACK": "10485760", "LimitSTACKSoft": "10485760", "LimitCORE": "infinity", "LimitCORESoft": "infinity", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitNOFILE": "65535", "LimitNOFILESoft": "65535", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitNPROC": "infinity", "LimitNPROCSoft": "infinity", "LimitMEMLOCK": "infinity", "LimitMEMLOCKSoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitSIGPENDING": "30446", "LimitSIGPENDINGSoft": "30446", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "OOMScoreAdjust": "-999", "CoredumpFilter": "0x33", "Nice": "0", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUAffinityFromNUMA": "no", "NUMAPolicy": "n/a", "TimerSlackNSec": "50000", "CPUSchedulingResetOnFork": "no", "NonBlocking": "no", "StandardInput": "null", "StandardOutput": "journal", "StandardError": "inherit", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "SyslogPriority": "30", "SyslogLevelPrefix": "yes", "SyslogLevel": "6", "SyslogFacility": "3", "LogLevelMax": "-1", "LogRateLimitIntervalUSec": "0", "LogRateLimitBurst": "0", "SecureBits": "0", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "DynamicUser": "no", "RemoveIPC": "no", "PrivateTmp": "no", "PrivateDevices": "no", "ProtectClock": "no", "ProtectKernelTunables": "no", "ProtectKernelModules": "no", "ProtectKernelLogs": "no", "ProtectControlGroups": "no", "PrivateNetwork": "no", "PrivateUsers": "no", "PrivateMounts": "no", "PrivateIPC": "no", "ProtectHome": "no", "ProtectSystem": "no", "SameProcessGroup": "no", "UtmpMode": "init", "IgnoreSIGPIPE": "yes", "NoNewPrivileges": "no", "SystemCallErrorNumber": "2147483646", "LockPersonality": "no", "RuntimeDirectoryPreserve": "no", "RuntimeDirectoryMode": "0755", "StateDirectoryMode": "0755", "CacheDirectoryMode": "0755", "LogsDirectoryMode": "0755", "ConfigurationDirectoryMode": "0755", "TimeoutCleanUSec": "infinity", "MemoryDenyWriteExecute": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "RestrictNamespaces": "no", "MountAPIVFS": "no", "KeyringMode": "private", "ProtectProc": "default", "ProcSubset": "all", "ProtectHostname": "no", "KillMode": "process", "KillSignal": "15", "RestartKillSignal": "15", "FinalKillSignal": "9", "SendSIGKILL": "yes", "SendSIGHUP": "no", "WatchdogSignal": "6", "Id": "containerd.service", "Names": "containerd.service", "Requires": "system.slice sysinit.target", "Conflicts": "shutdown.target", "Before": "shutdown.target", "After": "system.slice local-fs.target network.target basic.target systemd-journald.socket sysinit.target", "Documentation": "https://containerd.io", "Description": "containerd container runtime", "AccessSELinuxContext": "system_u:object_r:systemd_unit_file_t:s0", "LoadState": "loaded", "ActiveState": "inactive", "FreezerState": "running", "SubState": "dead", "FragmentPath": "/etc/systemd/system/containerd.service", "UnitFileState": "disabled", "UnitFilePreset": "disabled", "StateChangeTimestampMonotonic": "0", "InactiveExitTimestampMonotonic": "0", "ActiveEnterTimestampMonotonic": "0", "ActiveExitTimestampMonotonic": "0", "InactiveEnterTimestampMonotonic": "0", "CanStart": "yes", "CanStop": "yes", "CanReload": "no", "CanIsolate": "no", "CanFreeze": "yes", "StopWhenUnneeded": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "AllowIsolate": "no", "DefaultDependencies": "yes", "OnSuccessJobMode": "fail", "OnFailureJobMode": "replace", "IgnoreOnIsolate": "no", "NeedDaemonReload": "no", "JobTimeoutUSec": "infinity", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "ConditionResult": "no", "AssertResult": "no", "ConditionTimestampMonotonic": "0", "AssertTimestampMonotonic": "0", "Transient": "no", "Perpetual": "no", "StartLimitIntervalUSec": "10s", "StartLimitBurst": "5", "StartLimitAction": "none", "FailureAction": "none", "SuccessAction": "none", "CollectMode": "inactive"}, "enabled": true, "state": "started", "invocation": {"module_args": {"name": "containerd", "enabled": true, "state": "started", "daemon_reload": false, "daemon_reexec": false, "scope": "system", "no_block": false, "force": null, "masked": null}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'rm -f -r /home/ec2-user/.ansible/tmp/ansible-tmp-1721489245.2955086-326734-249599970110997/ > /dev/null 2>&1 && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
changed: [master] => {
    "changed": true,
    "enabled": true,
    "invocation": {
        "module_args": {
            "daemon_reexec": false,
            "daemon_reload": false,
            "enabled": true,
            "force": null,
            "masked": null,
            "name": "containerd",
            "no_block": false,
            "scope": "system",
            "state": "started"
        }
    },
    "name": "containerd",
    "state": "started",
    "status": {
        "AccessSELinuxContext": "system_u:object_r:systemd_unit_file_t:s0",
        "ActiveEnterTimestampMonotonic": "0",
        "ActiveExitTimestampMonotonic": "0",
        "ActiveState": "inactive",
        "After": "system.slice local-fs.target network.target basic.target systemd-journald.socket sysinit.target",
        "AllowIsolate": "no",
        "AssertResult": "no",
        "AssertTimestampMonotonic": "0",
        "Before": "shutdown.target",
        "BlockIOAccounting": "no",
        "BlockIOWeight": "[not set]",
        "CPUAccounting": "yes",
        "CPUAffinityFromNUMA": "no",
        "CPUQuotaPerSecUSec": "infinity",
        "CPUQuotaPeriodUSec": "infinity",
        "CPUSchedulingPolicy": "0",
        "CPUSchedulingPriority": "0",
        "CPUSchedulingResetOnFork": "no",
        "CPUShares": "[not set]",
        "CPUUsageNSec": "[not set]",
        "CPUWeight": "[not set]",
        "CacheDirectoryMode": "0755",
        "CanFreeze": "yes",
        "CanIsolate": "no",
        "CanReload": "no",
        "CanStart": "yes",
        "CanStop": "yes",
        "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore",
        "CleanResult": "success",
        "CollectMode": "inactive",
        "ConditionResult": "no",
        "ConditionTimestampMonotonic": "0",
        "ConfigurationDirectoryMode": "0755",
        "Conflicts": "shutdown.target",
        "ControlGroupId": "0",
        "ControlPID": "0",
        "CoredumpFilter": "0x33",
        "DefaultDependencies": "yes",
        "DefaultMemoryLow": "0",
        "DefaultMemoryMin": "0",
        "Delegate": "yes",
        "DelegateControllers": "cpu cpuset io memory pids",
        "Description": "containerd container runtime",
        "DevicePolicy": "auto",
        "Documentation": "https://containerd.io",
        "DynamicUser": "no",
        "ExecMainCode": "0",
        "ExecMainExitTimestampMonotonic": "0",
        "ExecMainPID": "0",
        "ExecMainStartTimestampMonotonic": "0",
        "ExecMainStatus": "0",
        "ExecStart": "{ path=/usr/local/bin/containerd ; argv[]=/usr/local/bin/containerd ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }",
        "ExecStartEx": "{ path=/usr/local/bin/containerd ; argv[]=/usr/local/bin/containerd ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }",
        "ExecStartPre": "{ path=/sbin/modprobe ; argv[]=/sbin/modprobe overlay ; ignore_errors=yes ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }",
        "ExecStartPreEx": "{ path=/sbin/modprobe ; argv[]=/sbin/modprobe overlay ; flags=ignore-failure ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }",
        "ExitType": "main",
        "FailureAction": "none",
        "FileDescriptorStoreMax": "0",
        "FinalKillSignal": "9",
        "FragmentPath": "/etc/systemd/system/containerd.service",
        "FreezerState": "running",
        "GID": "[not set]",
        "GuessMainPID": "yes",
        "IOAccounting": "no",
        "IOReadBytes": "18446744073709551615",
        "IOReadOperations": "18446744073709551615",
        "IOSchedulingClass": "2",
        "IOSchedulingPriority": "4",
        "IOWeight": "[not set]",
        "IOWriteBytes": "18446744073709551615",
        "IOWriteOperations": "18446744073709551615",
        "IPAccounting": "no",
        "IPEgressBytes": "[no data]",
        "IPEgressPackets": "[no data]",
        "IPIngressBytes": "[no data]",
        "IPIngressPackets": "[no data]",
        "Id": "containerd.service",
        "IgnoreOnIsolate": "no",
        "IgnoreSIGPIPE": "yes",
        "InactiveEnterTimestampMonotonic": "0",
        "InactiveExitTimestampMonotonic": "0",
        "JobRunningTimeoutUSec": "infinity",
        "JobTimeoutAction": "none",
        "JobTimeoutUSec": "infinity",
        "KeyringMode": "private",
        "KillMode": "process",
        "KillSignal": "15",
        "LimitAS": "infinity",
        "LimitASSoft": "infinity",
        "LimitCORE": "infinity",
        "LimitCORESoft": "infinity",
        "LimitCPU": "infinity",
        "LimitCPUSoft": "infinity",
        "LimitDATA": "infinity",
        "LimitDATASoft": "infinity",
        "LimitFSIZE": "infinity",
        "LimitFSIZESoft": "infinity",
        "LimitLOCKS": "infinity",
        "LimitLOCKSSoft": "infinity",
        "LimitMEMLOCK": "infinity",
        "LimitMEMLOCKSoft": "infinity",
        "LimitMSGQUEUE": "819200",
        "LimitMSGQUEUESoft": "819200",
        "LimitNICE": "0",
        "LimitNICESoft": "0",
        "LimitNOFILE": "65535",
        "LimitNOFILESoft": "65535",
        "LimitNPROC": "infinity",
        "LimitNPROCSoft": "infinity",
        "LimitRSS": "infinity",
        "LimitRSSSoft": "infinity",
        "LimitRTPRIO": "0",
        "LimitRTPRIOSoft": "0",
        "LimitRTTIME": "infinity",
        "LimitRTTIMESoft": "infinity",
        "LimitSIGPENDING": "30446",
        "LimitSIGPENDINGSoft": "30446",
        "LimitSTACK": "10485760",
        "LimitSTACKSoft": "10485760",
        "LoadState": "loaded",
        "LockPersonality": "no",
        "LogLevelMax": "-1",
        "LogRateLimitBurst": "0",
        "LogRateLimitIntervalUSec": "0",
        "LogsDirectoryMode": "0755",
        "MainPID": "0",
        "ManagedOOMMemoryPressure": "auto",
        "ManagedOOMMemoryPressureLimit": "0",
        "ManagedOOMPreference": "none",
        "ManagedOOMSwap": "auto",
        "MemoryAccounting": "yes",
        "MemoryAvailable": "infinity",
        "MemoryCurrent": "[not set]",
        "MemoryDenyWriteExecute": "no",
        "MemoryHigh": "infinity",
        "MemoryLimit": "infinity",
        "MemoryLow": "0",
        "MemoryMax": "infinity",
        "MemoryMin": "0",
        "MemorySwapMax": "infinity",
        "MountAPIVFS": "no",
        "NFileDescriptorStore": "0",
        "NRestarts": "0",
        "NUMAPolicy": "n/a",
        "Names": "containerd.service",
        "NeedDaemonReload": "no",
        "Nice": "0",
        "NoNewPrivileges": "no",
        "NonBlocking": "no",
        "NotifyAccess": "main",
        "OOMPolicy": "continue",
        "OOMScoreAdjust": "-999",
        "OnFailureJobMode": "replace",
        "OnSuccessJobMode": "fail",
        "Perpetual": "no",
        "PrivateDevices": "no",
        "PrivateIPC": "no",
        "PrivateMounts": "no",
        "PrivateNetwork": "no",
        "PrivateTmp": "no",
        "PrivateUsers": "no",
        "ProcSubset": "all",
        "ProtectClock": "no",
        "ProtectControlGroups": "no",
        "ProtectHome": "no",
        "ProtectHostname": "no",
        "ProtectKernelLogs": "no",
        "ProtectKernelModules": "no",
        "ProtectKernelTunables": "no",
        "ProtectProc": "default",
        "ProtectSystem": "no",
        "RefuseManualStart": "no",
        "RefuseManualStop": "no",
        "ReloadResult": "success",
        "RemainAfterExit": "no",
        "RemoveIPC": "no",
        "Requires": "system.slice sysinit.target",
        "Restart": "always",
        "RestartKillSignal": "15",
        "RestartUSec": "5s",
        "RestrictNamespaces": "no",
        "RestrictRealtime": "no",
        "RestrictSUIDSGID": "no",
        "Result": "success",
        "RootDirectoryStartOnly": "no",
        "RuntimeDirectoryMode": "0755",
        "RuntimeDirectoryPreserve": "no",
        "RuntimeMaxUSec": "infinity",
        "RuntimeRandomizedExtraUSec": "0",
        "SameProcessGroup": "no",
        "SecureBits": "0",
        "SendSIGHUP": "no",
        "SendSIGKILL": "yes",
        "Slice": "system.slice",
        "StandardError": "inherit",
        "StandardInput": "null",
        "StandardOutput": "journal",
        "StartLimitAction": "none",
        "StartLimitBurst": "5",
        "StartLimitIntervalUSec": "10s",
        "StartupBlockIOWeight": "[not set]",
        "StartupCPUShares": "[not set]",
        "StartupCPUWeight": "[not set]",
        "StartupIOWeight": "[not set]",
        "StateChangeTimestampMonotonic": "0",
        "StateDirectoryMode": "0755",
        "StatusErrno": "0",
        "StopWhenUnneeded": "no",
        "SubState": "dead",
        "SuccessAction": "none",
        "SyslogFacility": "3",
        "SyslogLevel": "6",
        "SyslogLevelPrefix": "yes",
        "SyslogPriority": "30",
        "SystemCallErrorNumber": "2147483646",
        "TTYReset": "no",
        "TTYVHangup": "no",
        "TTYVTDisallocate": "no",
        "TasksAccounting": "yes",
        "TasksCurrent": "[not set]",
        "TasksMax": "infinity",
        "TimeoutAbortUSec": "1min 30s",
        "TimeoutCleanUSec": "infinity",
        "TimeoutStartFailureMode": "terminate",
        "TimeoutStartUSec": "1min 30s",
        "TimeoutStopFailureMode": "terminate",
        "TimeoutStopUSec": "1min 30s",
        "TimerSlackNSec": "50000",
        "Transient": "no",
        "Type": "notify",
        "UID": "[not set]",
        "UMask": "0022",
        "UnitFilePreset": "disabled",
        "UnitFileState": "disabled",
        "UtmpMode": "init",
        "WatchdogSignal": "6",
        "WatchdogTimestampMonotonic": "0",
        "WatchdogUSec": "infinity"
    }
}

TASK [Download runc] ***********************************************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:84
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'echo ~ec2-user && sleep 0'"'"''
<10.0.1.171> (0, b'/home/ec2-user\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /home/ec2-user/.ansible/tmp `"&& mkdir "` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489246.8769403-326763-55700269828030 `" && echo ansible-tmp-1721489246.8769403-326763-55700269828030="` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489246.8769403-326763-55700269828030 `" ) && sleep 0'"'"''
<10.0.1.171> (0, b'ansible-tmp-1721489246.8769403-326763-55700269828030=/home/ec2-user/.ansible/tmp/ansible-tmp-1721489246.8769403-326763-55700269828030\n', b'')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/get_url.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpq9pieahz TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489246.8769403-326763-55700269828030/AnsiballZ_get_url.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpq9pieahz /home/ec2-user/.ansible/tmp/ansible-tmp-1721489246.8769403-326763-55700269828030/AnsiballZ_get_url.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489246.8769403-326763-55700269828030/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489246.8769403-326763-55700269828030/AnsiballZ_get_url.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-zopwzqzkzjgvsprqtnszywxfkifgbzml ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489246.8769403-326763-55700269828030/AnsiballZ_get_url.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"msg": "OK (10684992 bytes)", "status_code": 200, "changed": true, "checksum_dest": null, "checksum_src": "d283b806282faaccdb9d85e033ba964729ee2ddd", "dest": "/usr/local/sbin/runc", "elapsed": 0, "url": "https://github.com/opencontainers/runc/releases/download/v1.1.9/runc.amd64", "src": "/home/ec2-user/.ansible/tmp/ansible-tmp-1721489246.8769403-326763-55700269828030/tmpysw8nn_o", "md5sum": "08da42fb176e7d18c44f28cd81f6c68c", "uid": 0, "gid": 0, "owner": "root", "group": "root", "mode": "0755", "state": "file", "secontext": "system_u:object_r:bin_t:s0", "size": 10684992, "invocation": {"module_args": {"url": "https://github.com/opencontainers/runc/releases/download/v1.1.9/runc.amd64", "dest": "/usr/local/sbin/runc", "mode": "0755", "force": false, "http_agent": "ansible-httpget", "use_proxy": true, "validate_certs": true, "force_basic_auth": false, "use_gssapi": false, "backup": false, "checksum": "", "timeout": 10, "unredirected_headers": [], "decompress": true, "use_netrc": true, "unsafe_writes": false, "url_username": null, "url_password": null, "client_cert": null, "client_key": null, "headers": null, "tmp_dest": null, "ciphers": null, "owner": null, "group": null, "seuser": null, "serole": null, "selevel": null, "setype": null, "attributes": null}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'rm -f -r /home/ec2-user/.ansible/tmp/ansible-tmp-1721489246.8769403-326763-55700269828030/ > /dev/null 2>&1 && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
changed: [master] => {
    "changed": true,
    "checksum_dest": null,
    "checksum_src": "d283b806282faaccdb9d85e033ba964729ee2ddd",
    "dest": "/usr/local/sbin/runc",
    "elapsed": 0,
    "gid": 0,
    "group": "root",
    "invocation": {
        "module_args": {
            "attributes": null,
            "backup": false,
            "checksum": "",
            "ciphers": null,
            "client_cert": null,
            "client_key": null,
            "decompress": true,
            "dest": "/usr/local/sbin/runc",
            "force": false,
            "force_basic_auth": false,
            "group": null,
            "headers": null,
            "http_agent": "ansible-httpget",
            "mode": "0755",
            "owner": null,
            "selevel": null,
            "serole": null,
            "setype": null,
            "seuser": null,
            "timeout": 10,
            "tmp_dest": null,
            "unredirected_headers": [],
            "unsafe_writes": false,
            "url": "https://github.com/opencontainers/runc/releases/download/v1.1.9/runc.amd64",
            "url_password": null,
            "url_username": null,
            "use_gssapi": false,
            "use_netrc": true,
            "use_proxy": true,
            "validate_certs": true
        }
    },
    "md5sum": "08da42fb176e7d18c44f28cd81f6c68c",
    "mode": "0755",
    "msg": "OK (10684992 bytes)",
    "owner": "root",
    "secontext": "system_u:object_r:bin_t:s0",
    "size": 10684992,
    "src": "/home/ec2-user/.ansible/tmp/ansible-tmp-1721489246.8769403-326763-55700269828030/tmpysw8nn_o",
    "state": "file",
    "status_code": 200,
    "uid": 0,
    "url": "https://github.com/opencontainers/runc/releases/download/v1.1.9/runc.amd64"
}

TASK [Create directory for CNI plugins] ****************************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:92
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'echo ~ec2-user && sleep 0'"'"''
<10.0.1.171> (0, b'/home/ec2-user\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /home/ec2-user/.ansible/tmp `"&& mkdir "` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489248.654689-326783-194171209855020 `" && echo ansible-tmp-1721489248.654689-326783-194171209855020="` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489248.654689-326783-194171209855020 `" ) && sleep 0'"'"''
<10.0.1.171> (0, b'ansible-tmp-1721489248.654689-326783-194171209855020=/home/ec2-user/.ansible/tmp/ansible-tmp-1721489248.654689-326783-194171209855020\n', b'')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/file.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpxjmurym7 TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489248.654689-326783-194171209855020/AnsiballZ_file.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpxjmurym7 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489248.654689-326783-194171209855020/AnsiballZ_file.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489248.654689-326783-194171209855020/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489248.654689-326783-194171209855020/AnsiballZ_file.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-wvqjkwtdrdhaxhatndgefpiiescfvfpg ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489248.654689-326783-194171209855020/AnsiballZ_file.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"path": "/opt/cni/bin", "changed": true, "diff": {"before": {"path": "/opt/cni/bin", "state": "absent"}, "after": {"path": "/opt/cni/bin", "state": "directory"}}, "uid": 0, "gid": 0, "owner": "root", "group": "root", "mode": "0755", "state": "directory", "secontext": "unconfined_u:object_r:usr_t:s0", "size": 6, "invocation": {"module_args": {"path": "/opt/cni/bin", "state": "directory", "mode": "0755", "recurse": false, "force": false, "follow": true, "modification_time_format": "%Y%m%d%H%M.%S", "access_time_format": "%Y%m%d%H%M.%S", "unsafe_writes": false, "_original_basename": null, "_diff_peek": null, "src": null, "modification_time": null, "access_time": null, "owner": null, "group": null, "seuser": null, "serole": null, "selevel": null, "setype": null, "attributes": null}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'rm -f -r /home/ec2-user/.ansible/tmp/ansible-tmp-1721489248.654689-326783-194171209855020/ > /dev/null 2>&1 && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
changed: [master] => {
    "changed": true,
    "diff": {
        "after": {
            "path": "/opt/cni/bin",
            "state": "directory"
        },
        "before": {
            "path": "/opt/cni/bin",
            "state": "absent"
        }
    },
    "gid": 0,
    "group": "root",
    "invocation": {
        "module_args": {
            "_diff_peek": null,
            "_original_basename": null,
            "access_time": null,
            "access_time_format": "%Y%m%d%H%M.%S",
            "attributes": null,
            "follow": true,
            "force": false,
            "group": null,
            "mode": "0755",
            "modification_time": null,
            "modification_time_format": "%Y%m%d%H%M.%S",
            "owner": null,
            "path": "/opt/cni/bin",
            "recurse": false,
            "selevel": null,
            "serole": null,
            "setype": null,
            "seuser": null,
            "src": null,
            "state": "directory",
            "unsafe_writes": false
        }
    },
    "mode": "0755",
    "owner": "root",
    "path": "/opt/cni/bin",
    "secontext": "unconfined_u:object_r:usr_t:s0",
    "size": 6,
    "state": "directory",
    "uid": 0
}

TASK [Download CNI plugins] ****************************************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:98
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'echo ~ec2-user && sleep 0'"'"''
<10.0.1.171> (0, b'/home/ec2-user\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /home/ec2-user/.ansible/tmp `"&& mkdir "` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489249.5671816-326792-223984116502869 `" && echo ansible-tmp-1721489249.5671816-326792-223984116502869="` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489249.5671816-326792-223984116502869 `" ) && sleep 0'"'"''
<10.0.1.171> (0, b'ansible-tmp-1721489249.5671816-326792-223984116502869=/home/ec2-user/.ansible/tmp/ansible-tmp-1721489249.5671816-326792-223984116502869\n', b'')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/get_url.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpyjkrrlwi TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489249.5671816-326792-223984116502869/AnsiballZ_get_url.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpyjkrrlwi /home/ec2-user/.ansible/tmp/ansible-tmp-1721489249.5671816-326792-223984116502869/AnsiballZ_get_url.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489249.5671816-326792-223984116502869/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489249.5671816-326792-223984116502869/AnsiballZ_get_url.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-fkurflzrbnqtgwlozgstlwunovwtayqc ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489249.5671816-326792-223984116502869/AnsiballZ_get_url.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"msg": "OK (36336160 bytes)", "status_code": 200, "changed": true, "checksum_dest": null, "checksum_src": "ce06fd51aa8ac270554afcc5f32857c30138f8b9", "dest": "/tmp/cni-plugins-linux-amd64-v1.1.1.tgz", "elapsed": 1, "url": "https://github.com/containernetworking/plugins/releases/download/v1.1.1/cni-plugins-linux-amd64-v1.1.1.tgz", "src": "/home/ec2-user/.ansible/tmp/ansible-tmp-1721489249.5671816-326792-223984116502869/tmp1kd6l2_h", "md5sum": "55803aa6bc327b8c21a4046a94408702", "uid": 0, "gid": 0, "owner": "root", "group": "root", "mode": "0644", "state": "file", "secontext": "unconfined_u:object_r:user_home_t:s0", "size": 36336160, "invocation": {"module_args": {"url": "https://github.com/containernetworking/plugins/releases/download/v1.1.1/cni-plugins-linux-amd64-v1.1.1.tgz", "dest": "/tmp/cni-plugins-linux-amd64-v1.1.1.tgz", "force": false, "http_agent": "ansible-httpget", "use_proxy": true, "validate_certs": true, "force_basic_auth": false, "use_gssapi": false, "backup": false, "checksum": "", "timeout": 10, "unredirected_headers": [], "decompress": true, "use_netrc": true, "unsafe_writes": false, "url_username": null, "url_password": null, "client_cert": null, "client_key": null, "headers": null, "tmp_dest": null, "ciphers": null, "mode": null, "owner": null, "group": null, "seuser": null, "serole": null, "selevel": null, "setype": null, "attributes": null}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'rm -f -r /home/ec2-user/.ansible/tmp/ansible-tmp-1721489249.5671816-326792-223984116502869/ > /dev/null 2>&1 && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
changed: [master] => {
    "changed": true,
    "checksum_dest": null,
    "checksum_src": "ce06fd51aa8ac270554afcc5f32857c30138f8b9",
    "dest": "/tmp/cni-plugins-linux-amd64-v1.1.1.tgz",
    "elapsed": 1,
    "gid": 0,
    "group": "root",
    "invocation": {
        "module_args": {
            "attributes": null,
            "backup": false,
            "checksum": "",
            "ciphers": null,
            "client_cert": null,
            "client_key": null,
            "decompress": true,
            "dest": "/tmp/cni-plugins-linux-amd64-v1.1.1.tgz",
            "force": false,
            "force_basic_auth": false,
            "group": null,
            "headers": null,
            "http_agent": "ansible-httpget",
            "mode": null,
            "owner": null,
            "selevel": null,
            "serole": null,
            "setype": null,
            "seuser": null,
            "timeout": 10,
            "tmp_dest": null,
            "unredirected_headers": [],
            "unsafe_writes": false,
            "url": "https://github.com/containernetworking/plugins/releases/download/v1.1.1/cni-plugins-linux-amd64-v1.1.1.tgz",
            "url_password": null,
            "url_username": null,
            "use_gssapi": false,
            "use_netrc": true,
            "use_proxy": true,
            "validate_certs": true
        }
    },
    "md5sum": "55803aa6bc327b8c21a4046a94408702",
    "mode": "0644",
    "msg": "OK (36336160 bytes)",
    "owner": "root",
    "secontext": "unconfined_u:object_r:user_home_t:s0",
    "size": 36336160,
    "src": "/home/ec2-user/.ansible/tmp/ansible-tmp-1721489249.5671816-326792-223984116502869/tmp1kd6l2_h",
    "state": "file",
    "status_code": 200,
    "uid": 0,
    "url": "https://github.com/containernetworking/plugins/releases/download/v1.1.1/cni-plugins-linux-amd64-v1.1.1.tgz"
}

TASK [Extract CNI plugins] *****************************************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:103
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'echo ~ec2-user && sleep 0'"'"''
<10.0.1.171> (0, b'/home/ec2-user\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /home/ec2-user/.ansible/tmp `"&& mkdir "` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489251.647941-326813-256425142456943 `" && echo ansible-tmp-1721489251.647941-326813-256425142456943="` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489251.647941-326813-256425142456943 `" ) && sleep 0'"'"''
<10.0.1.171> (0, b'ansible-tmp-1721489251.647941-326813-256425142456943=/home/ec2-user/.ansible/tmp/ansible-tmp-1721489251.647941-326813-256425142456943\n', b'')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/stat.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpudl1kv7t TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489251.647941-326813-256425142456943/AnsiballZ_stat.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpudl1kv7t /home/ec2-user/.ansible/tmp/ansible-tmp-1721489251.647941-326813-256425142456943/AnsiballZ_stat.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489251.647941-326813-256425142456943/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489251.647941-326813-256425142456943/AnsiballZ_stat.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-vgtvxqglcoridnskbbklmfgcwijadlyu ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489251.647941-326813-256425142456943/AnsiballZ_stat.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"changed": false, "stat": {"exists": true, "path": "/opt/cni/bin", "mode": "0755", "isdir": true, "ischr": false, "isblk": false, "isreg": false, "isfifo": false, "islnk": false, "issock": false, "uid": 0, "gid": 0, "size": 6, "inode": 485617, "dev": 66305, "nlink": 2, "atime": 1721489249.411435, "mtime": 1721489249.411435, "ctime": 1721489249.411435, "wusr": true, "rusr": true, "xusr": true, "wgrp": false, "rgrp": true, "xgrp": true, "woth": false, "roth": true, "xoth": true, "isuid": false, "isgid": false, "blocks": 0, "block_size": 4096, "device_type": 0, "readable": true, "writeable": true, "executable": true, "pw_name": "root", "gr_name": "root", "mimetype": "inode/directory", "charset": "binary", "version": "3002495706", "attributes": [], "attr_flags": ""}, "invocation": {"module_args": {"path": "/opt/cni/bin", "follow": true, "get_checksum": true, "checksum_algorithm": "sha1", "get_md5": false, "get_mime": true, "get_attributes": true}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/unarchive.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmp1jiyzx8c TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489251.647941-326813-256425142456943/AnsiballZ_unarchive.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmp1jiyzx8c /home/ec2-user/.ansible/tmp/ansible-tmp-1721489251.647941-326813-256425142456943/AnsiballZ_unarchive.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489251.647941-326813-256425142456943/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489251.647941-326813-256425142456943/AnsiballZ_unarchive.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-oluorewyjshvwtokgdlrbbzgshphgzjx ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489251.647941-326813-256425142456943/AnsiballZ_unarchive.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"handler": "TgzArchive", "dest": "/opt/cni/bin", "src": "/tmp/cni-plugins-linux-amd64-v1.1.1.tgz", "extract_results": {"cmd": ["/usr/bin/gtar", "--extract", "-C", "/opt/cni/bin", "-z", "-f", "/tmp/cni-plugins-linux-amd64-v1.1.1.tgz"], "rc": 0, "out": "", "err": ""}, "changed": true, "uid": 0, "gid": 0, "owner": "root", "group": "root", "mode": "0775", "state": "directory", "secontext": "unconfined_u:object_r:usr_t:s0", "size": 16384, "invocation": {"module_args": {"src": "/tmp/cni-plugins-linux-amd64-v1.1.1.tgz", "dest": "/opt/cni/bin", "remote_src": true, "list_files": false, "keep_newer": false, "exclude": [], "include": [], "extra_opts": [], "validate_certs": true, "io_buffer_size": 65536, "copy": true, "decrypt": true, "unsafe_writes": false, "creates": null, "mode": null, "owner": null, "group": null, "seuser": null, "serole": null, "selevel": null, "setype": null, "attributes": null}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'rm -f -r /home/ec2-user/.ansible/tmp/ansible-tmp-1721489251.647941-326813-256425142456943/ > /dev/null 2>&1 && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
changed: [master] => {
    "changed": true,
    "dest": "/opt/cni/bin",
    "extract_results": {
        "cmd": [
            "/usr/bin/gtar",
            "--extract",
            "-C",
            "/opt/cni/bin",
            "-z",
            "-f",
            "/tmp/cni-plugins-linux-amd64-v1.1.1.tgz"
        ],
        "err": "",
        "out": "",
        "rc": 0
    },
    "gid": 0,
    "group": "root",
    "handler": "TgzArchive",
    "invocation": {
        "module_args": {
            "attributes": null,
            "copy": true,
            "creates": null,
            "decrypt": true,
            "dest": "/opt/cni/bin",
            "exclude": [],
            "extra_opts": [],
            "group": null,
            "include": [],
            "io_buffer_size": 65536,
            "keep_newer": false,
            "list_files": false,
            "mode": null,
            "owner": null,
            "remote_src": true,
            "selevel": null,
            "serole": null,
            "setype": null,
            "seuser": null,
            "src": "/tmp/cni-plugins-linux-amd64-v1.1.1.tgz",
            "unsafe_writes": false,
            "validate_certs": true
        }
    },
    "mode": "0775",
    "owner": "root",
    "secontext": "unconfined_u:object_r:usr_t:s0",
    "size": 16384,
    "src": "/tmp/cni-plugins-linux-amd64-v1.1.1.tgz",
    "state": "directory",
    "uid": 0
}

TASK [Create containerd config directory] **************************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:111
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'echo ~ec2-user && sleep 0'"'"''
<10.0.1.171> (0, b'/home/ec2-user\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /home/ec2-user/.ansible/tmp `"&& mkdir "` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489255.0465646-326868-43185437485216 `" && echo ansible-tmp-1721489255.0465646-326868-43185437485216="` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489255.0465646-326868-43185437485216 `" ) && sleep 0'"'"''
<10.0.1.171> (0, b'ansible-tmp-1721489255.0465646-326868-43185437485216=/home/ec2-user/.ansible/tmp/ansible-tmp-1721489255.0465646-326868-43185437485216\n', b'')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/file.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmp141w5py9 TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489255.0465646-326868-43185437485216/AnsiballZ_file.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmp141w5py9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489255.0465646-326868-43185437485216/AnsiballZ_file.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489255.0465646-326868-43185437485216/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489255.0465646-326868-43185437485216/AnsiballZ_file.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-bnljdayukidwrmozdwghxaifvhmhyyvl ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489255.0465646-326868-43185437485216/AnsiballZ_file.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"path": "/etc/containerd", "changed": true, "diff": {"before": {"path": "/etc/containerd", "state": "absent"}, "after": {"path": "/etc/containerd", "state": "directory"}}, "uid": 0, "gid": 0, "owner": "root", "group": "root", "mode": "0755", "state": "directory", "secontext": "unconfined_u:object_r:etc_t:s0", "size": 6, "invocation": {"module_args": {"path": "/etc/containerd", "state": "directory", "recurse": false, "force": false, "follow": true, "modification_time_format": "%Y%m%d%H%M.%S", "access_time_format": "%Y%m%d%H%M.%S", "unsafe_writes": false, "_original_basename": null, "_diff_peek": null, "src": null, "modification_time": null, "access_time": null, "mode": null, "owner": null, "group": null, "seuser": null, "serole": null, "selevel": null, "setype": null, "attributes": null}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'rm -f -r /home/ec2-user/.ansible/tmp/ansible-tmp-1721489255.0465646-326868-43185437485216/ > /dev/null 2>&1 && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
changed: [master] => {
    "changed": true,
    "diff": {
        "after": {
            "path": "/etc/containerd",
            "state": "directory"
        },
        "before": {
            "path": "/etc/containerd",
            "state": "absent"
        }
    },
    "gid": 0,
    "group": "root",
    "invocation": {
        "module_args": {
            "_diff_peek": null,
            "_original_basename": null,
            "access_time": null,
            "access_time_format": "%Y%m%d%H%M.%S",
            "attributes": null,
            "follow": true,
            "force": false,
            "group": null,
            "mode": null,
            "modification_time": null,
            "modification_time_format": "%Y%m%d%H%M.%S",
            "owner": null,
            "path": "/etc/containerd",
            "recurse": false,
            "selevel": null,
            "serole": null,
            "setype": null,
            "seuser": null,
            "src": null,
            "state": "directory",
            "unsafe_writes": false
        }
    },
    "mode": "0755",
    "owner": "root",
    "path": "/etc/containerd",
    "secontext": "unconfined_u:object_r:etc_t:s0",
    "size": 6,
    "state": "directory",
    "uid": 0
}

TASK [Generate default containerd config] **************************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:116
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'echo ~ec2-user && sleep 0'"'"''
<10.0.1.171> (0, b'/home/ec2-user\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /home/ec2-user/.ansible/tmp `"&& mkdir "` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489255.6748192-326877-230236118722969 `" && echo ansible-tmp-1721489255.6748192-326877-230236118722969="` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489255.6748192-326877-230236118722969 `" ) && sleep 0'"'"''
<10.0.1.171> (0, b'ansible-tmp-1721489255.6748192-326877-230236118722969=/home/ec2-user/.ansible/tmp/ansible-tmp-1721489255.6748192-326877-230236118722969\n', b'')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/command.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpp1dj5bb9 TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489255.6748192-326877-230236118722969/AnsiballZ_command.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpp1dj5bb9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489255.6748192-326877-230236118722969/AnsiballZ_command.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489255.6748192-326877-230236118722969/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489255.6748192-326877-230236118722969/AnsiballZ_command.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-atrrzkawlsgerqelominihzhxjutaocx ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489255.6748192-326877-230236118722969/AnsiballZ_command.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"changed": true, "stdout": "disabled_plugins = []\\nimports = []\\noom_score = 0\\nplugin_dir = \\"\\"\\nrequired_plugins = []\\nroot = \\"/var/lib/containerd\\"\\nstate = \\"/run/containerd\\"\\ntemp = \\"\\"\\nversion = 2\\n\\n[cgroup]\\n  path = \\"\\"\\n\\n[debug]\\n  address = \\"\\"\\n  format = \\"\\"\\n  gid = 0\\n  level = \\"\\"\\n  uid = 0\\n\\n[grpc]\\n  address = \\"/run/containerd/containerd.sock\\"\\n  gid = 0\\n  max_recv_message_size = 16777216\\n  max_send_message_size = 16777216\\n  tcp_address = \\"\\"\\n  tcp_tls_ca = \\"\\"\\n  tcp_tls_cert = \\"\\"\\n  tcp_tls_key = \\"\\"\\n  uid = 0\\n\\n[metrics]\\n  address = \\"\\"\\n  grpc_histogram = false\\n\\n[plugins]\\n\\n  [plugins.\\"io.containerd.gc.v1.scheduler\\"]\\n    deletion_threshold = 0\\n    mutation_threshold = 100\\n    pause_threshold = 0.02\\n    schedule_delay = \\"0s\\"\\n    startup_delay = \\"100ms\\"\\n\\n  [plugins.\\"io.containerd.grpc.v1.cri\\"]\\n    device_ownership_from_security_context = false\\n    disable_apparmor = false\\n    disable_cgroup = false\\n    disable_hugetlb_controller = true\\n    disable_proc_mount = false\\n    disable_tcp_service = true\\n    enable_selinux = false\\n    enable_tls_streaming = false\\n    enable_unprivileged_icmp = false\\n    enable_unprivileged_ports = false\\n    ignore_image_defined_volumes = false\\n    max_concurrent_downloads = 3\\n    max_container_log_line_size = 16384\\n    netns_mounts_under_state_dir = false\\n    restrict_oom_score_adj = false\\n    sandbox_image = \\"k8s.gcr.io/pause:3.6\\"\\n    selinux_category_range = 1024\\n    stats_collect_period = 10\\n    stream_idle_timeout = \\"4h0m0s\\"\\n    stream_server_address = \\"127.0.0.1\\"\\n    stream_server_port = \\"0\\"\\n    systemd_cgroup = false\\n    tolerate_missing_hugetlb_controller = true\\n    unset_seccomp_profile = \\"\\"\\n\\n    [plugins.\\"io.containerd.grpc.v1.cri\\".cni]\\n      bin_dir = \\"/opt/cni/bin\\"\\n      conf_dir = \\"/etc/cni/net.d\\"\\n      conf_template = \\"\\"\\n      ip_pref = \\"\\"\\n      max_conf_num = 1\\n\\n    [plugins.\\"io.containerd.grpc.v1.cri\\".containerd]\\n      default_runtime_name = \\"runc\\"\\n      disable_snapshot_annotations = true\\n      discard_unpacked_layers = false\\n      ignore_rdt_not_enabled_errors = false\\n      no_pivot = false\\n      snapshotter = \\"overlayfs\\"\\n\\n      [plugins.\\"io.containerd.grpc.v1.cri\\".containerd.default_runtime]\\n        base_runtime_spec = \\"\\"\\n        cni_conf_dir = \\"\\"\\n        cni_max_conf_num = 0\\n        container_annotations = []\\n        pod_annotations = []\\n        privileged_without_host_devices = false\\n        runtime_engine = \\"\\"\\n        runtime_path = \\"\\"\\n        runtime_root = \\"\\"\\n        runtime_type = \\"\\"\\n\\n        [plugins.\\"io.containerd.grpc.v1.cri\\".containerd.default_runtime.options]\\n\\n      [plugins.\\"io.containerd.grpc.v1.cri\\".containerd.runtimes]\\n\\n        [plugins.\\"io.containerd.grpc.v1.cri\\".containerd.runtimes.runc]\\n          base_runtime_spec = \\"\\"\\n          cni_conf_dir = \\"\\"\\n          cni_max_conf_num = 0\\n          container_annotations = []\\n          pod_annotations = []\\n          privileged_without_host_devices = false\\n          runtime_engine = \\"\\"\\n          runtime_path = \\"\\"\\n          runtime_root = \\"\\"\\n          runtime_type = \\"io.containerd.runc.v2\\"\\n\\n          [plugins.\\"io.containerd.grpc.v1.cri\\".containerd.runtimes.runc.options]\\n            BinaryName = \\"\\"\\n            CriuImagePath = \\"\\"\\n            CriuPath = \\"\\"\\n            CriuWorkPath = \\"\\"\\n            IoGid = 0\\n            IoUid = 0\\n            NoNewKeyring = false\\n            NoPivotRoot = false\\n            Root = \\"\\"\\n            ShimCgroup = \\"\\"\\n            SystemdCgroup = false\\n\\n      [plugins.\\"io.containerd.grpc.v1.cri\\".containerd.untrusted_workload_runtime]\\n        base_runtime_spec = \\"\\"\\n        cni_conf_dir = \\"\\"\\n        cni_max_conf_num = 0\\n        container_annotations = []\\n        pod_annotations = []\\n        privileged_without_host_devices = false\\n        runtime_engine = \\"\\"\\n        runtime_path = \\"\\"\\n        runtime_root = \\"\\"\\n        runtime_type = \\"\\"\\n\\n        [plugins.\\"io.containerd.grpc.v1.cri\\".containerd.untrusted_workload_runtime.options]\\n\\n    [plugins.\\"io.containerd.grpc.v1.cri\\".image_decryption]\\n      key_model = \\"node\\"\\n\\n    [plugins.\\"io.containerd.grpc.v1.cri\\".registry]\\n      config_path = \\"\\"\\n\\n      [plugins.\\"io.containerd.grpc.v1.cri\\".registry.auths]\\n\\n      [plugins.\\"io.containerd.grpc.v1.cri\\".registry.configs]\\n\\n      [plugins.\\"io.containerd.grpc.v1.cri\\".registry.headers]\\n\\n      [plugins.\\"io.containerd.grpc.v1.cri\\".registry.mirrors]\\n\\n    [plugins.\\"io.containerd.grpc.v1.cri\\".x509_key_pair_streaming]\\n      tls_cert_file = \\"\\"\\n      tls_key_file = \\"\\"\\n\\n  [plugins.\\"io.containerd.internal.v1.opt\\"]\\n    path = \\"/opt/containerd\\"\\n\\n  [plugins.\\"io.containerd.internal.v1.restart\\"]\\n    interval = \\"10s\\"\\n\\n  [plugins.\\"io.containerd.internal.v1.tracing\\"]\\n    sampling_ratio = 1.0\\n    service_name = \\"containerd\\"\\n\\n  [plugins.\\"io.containerd.metadata.v1.bolt\\"]\\n    content_sharing_policy = \\"shared\\"\\n\\n  [plugins.\\"io.containerd.monitor.v1.cgroups\\"]\\n    no_prometheus = false\\n\\n  [plugins.\\"io.containerd.runtime.v1.linux\\"]\\n    no_shim = false\\n    runtime = \\"runc\\"\\n    runtime_root = \\"\\"\\n    shim = \\"containerd-shim\\"\\n    shim_debug = false\\n\\n  [plugins.\\"io.containerd.runtime.v2.task\\"]\\n    platforms = [\\"linux/amd64\\"]\\n    sched_core = false\\n\\n  [plugins.\\"io.containerd.service.v1.diff-service\\"]\\n    default = [\\"walking\\"]\\n\\n  [plugins.\\"io.containerd.service.v1.tasks-service\\"]\\n    rdt_config_file = \\"\\"\\n\\n  [plugins.\\"io.containerd.snapshotter.v1.aufs\\"]\\n    root_path = \\"\\"\\n\\n  [plugins.\\"io.containerd.snapshotter.v1.btrfs\\"]\\n    root_path = \\"\\"\\n\\n  [plugins.\\"io.containerd.snapshotter.v1.devmapper\\"]\\n    async_remove = false\\n    base_image_size = \\"\\"\\n    discard_blocks = false\\n    fs_options = \\"\\"\\n    fs_type = \\"\\"\\n    pool_name = \\"\\"\\n    root_path = \\"\\"\\n\\n  [plugins.\\"io.containerd.snapshotter.v1.native\\"]\\n    root_path = \\"\\"\\n\\n  [plugins.\\"io.containerd.snapshotter.v1.overlayfs\\"]\\n    root_path = \\"\\"\\n    upperdir_label = false\\n\\n  [plugins.\\"io.containerd.snapshotter.v1.zfs\\"]\\n    root_path = \\"\\"\\n\\n  [plugins.\\"io.containerd.tracing.processor.v1.otlp\\"]\\n    endpoint = \\"\\"\\n    insecure = false\\n    protocol = \\"\\"\\n\\n[proxy_plugins]\\n\\n[stream_processors]\\n\\n  [stream_processors.\\"io.containerd.ocicrypt.decoder.v1.tar\\"]\\n    accepts = [\\"application/vnd.oci.image.layer.v1.tar+encrypted\\"]\\n    args = [\\"--decryption-keys-path\\", \\"/etc/containerd/ocicrypt/keys\\"]\\n    env = [\\"OCICRYPT_KEYPROVIDER_CONFIG=/etc/containerd/ocicrypt/ocicrypt_keyprovider.conf\\"]\\n    path = \\"ctd-decoder\\"\\n    returns = \\"application/vnd.oci.image.layer.v1.tar\\"\\n\\n  [stream_processors.\\"io.containerd.ocicrypt.decoder.v1.tar.gzip\\"]\\n    accepts = [\\"application/vnd.oci.image.layer.v1.tar+gzip+encrypted\\"]\\n    args = [\\"--decryption-keys-path\\", \\"/etc/containerd/ocicrypt/keys\\"]\\n    env = [\\"OCICRYPT_KEYPROVIDER_CONFIG=/etc/containerd/ocicrypt/ocicrypt_keyprovider.conf\\"]\\n    path = \\"ctd-decoder\\"\\n    returns = \\"application/vnd.oci.image.layer.v1.tar+gzip\\"\\n\\n[timeouts]\\n  \\"io.containerd.timeout.bolt.open\\" = \\"0s\\"\\n  \\"io.containerd.timeout.shim.cleanup\\" = \\"5s\\"\\n  \\"io.containerd.timeout.shim.load\\" = \\"5s\\"\\n  \\"io.containerd.timeout.shim.shutdown\\" = \\"3s\\"\\n  \\"io.containerd.timeout.task.state\\" = \\"2s\\"\\n\\n[ttrpc]\\n  address = \\"\\"\\n  gid = 0\\n  uid = 0", "stderr": "", "rc": 0, "cmd": "containerd config default | tee /etc/containerd/config.toml", "start": "2024-07-20 15:27:36.172486", "end": "2024-07-20 15:27:36.225168", "delta": "0:00:00.052682", "msg": "", "invocation": {"module_args": {"_raw_params": "containerd config default | tee /etc/containerd/config.toml", "_uses_shell": true, "stdin_add_newline": true, "strip_empty_ends": true, "argv": null, "chdir": null, "executable": null, "creates": null, "removes": null, "stdin": null}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'rm -f -r /home/ec2-user/.ansible/tmp/ansible-tmp-1721489255.6748192-326877-230236118722969/ > /dev/null 2>&1 && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
changed: [master] => {
    "changed": true,
    "cmd": "containerd config default | tee /etc/containerd/config.toml",
    "delta": "0:00:00.052682",
    "end": "2024-07-20 15:27:36.225168",
    "invocation": {
        "module_args": {
            "_raw_params": "containerd config default | tee /etc/containerd/config.toml",
            "_uses_shell": true,
            "argv": null,
            "chdir": null,
            "creates": null,
            "executable": null,
            "removes": null,
            "stdin": null,
            "stdin_add_newline": true,
            "strip_empty_ends": true
        }
    },
    "msg": "",
    "rc": 0,
    "start": "2024-07-20 15:27:36.172486",
    "stderr": "",
    "stderr_lines": [],
    "stdout": "disabled_plugins = []\nimports = []\noom_score = 0\nplugin_dir = \"\"\nrequired_plugins = []\nroot = \"/var/lib/containerd\"\nstate = \"/run/containerd\"\ntemp = \"\"\nversion = 2\n\n[cgroup]\n  path = \"\"\n\n[debug]\n  address = \"\"\n  format = \"\"\n  gid = 0\n  level = \"\"\n  uid = 0\n\n[grpc]\n  address = \"/run/containerd/containerd.sock\"\n  gid = 0\n  max_recv_message_size = 16777216\n  max_send_message_size = 16777216\n  tcp_address = \"\"\n  tcp_tls_ca = \"\"\n  tcp_tls_cert = \"\"\n  tcp_tls_key = \"\"\n  uid = 0\n\n[metrics]\n  address = \"\"\n  grpc_histogram = false\n\n[plugins]\n\n  [plugins.\"io.containerd.gc.v1.scheduler\"]\n    deletion_threshold = 0\n    mutation_threshold = 100\n    pause_threshold = 0.02\n    schedule_delay = \"0s\"\n    startup_delay = \"100ms\"\n\n  [plugins.\"io.containerd.grpc.v1.cri\"]\n    device_ownership_from_security_context = false\n    disable_apparmor = false\n    disable_cgroup = false\n    disable_hugetlb_controller = true\n    disable_proc_mount = false\n    disable_tcp_service = true\n    enable_selinux = false\n    enable_tls_streaming = false\n    enable_unprivileged_icmp = false\n    enable_unprivileged_ports = false\n    ignore_image_defined_volumes = false\n    max_concurrent_downloads = 3\n    max_container_log_line_size = 16384\n    netns_mounts_under_state_dir = false\n    restrict_oom_score_adj = false\n    sandbox_image = \"k8s.gcr.io/pause:3.6\"\n    selinux_category_range = 1024\n    stats_collect_period = 10\n    stream_idle_timeout = \"4h0m0s\"\n    stream_server_address = \"127.0.0.1\"\n    stream_server_port = \"0\"\n    systemd_cgroup = false\n    tolerate_missing_hugetlb_controller = true\n    unset_seccomp_profile = \"\"\n\n    [plugins.\"io.containerd.grpc.v1.cri\".cni]\n      bin_dir = \"/opt/cni/bin\"\n      conf_dir = \"/etc/cni/net.d\"\n      conf_template = \"\"\n      ip_pref = \"\"\n      max_conf_num = 1\n\n    [plugins.\"io.containerd.grpc.v1.cri\".containerd]\n      default_runtime_name = \"runc\"\n      disable_snapshot_annotations = true\n      discard_unpacked_layers = false\n      ignore_rdt_not_enabled_errors = false\n      no_pivot = false\n      snapshotter = \"overlayfs\"\n\n      [plugins.\"io.containerd.grpc.v1.cri\".containerd.default_runtime]\n        base_runtime_spec = \"\"\n        cni_conf_dir = \"\"\n        cni_max_conf_num = 0\n        container_annotations = []\n        pod_annotations = []\n        privileged_without_host_devices = false\n        runtime_engine = \"\"\n        runtime_path = \"\"\n        runtime_root = \"\"\n        runtime_type = \"\"\n\n        [plugins.\"io.containerd.grpc.v1.cri\".containerd.default_runtime.options]\n\n      [plugins.\"io.containerd.grpc.v1.cri\".containerd.runtimes]\n\n        [plugins.\"io.containerd.grpc.v1.cri\".containerd.runtimes.runc]\n          base_runtime_spec = \"\"\n          cni_conf_dir = \"\"\n          cni_max_conf_num = 0\n          container_annotations = []\n          pod_annotations = []\n          privileged_without_host_devices = false\n          runtime_engine = \"\"\n          runtime_path = \"\"\n          runtime_root = \"\"\n          runtime_type = \"io.containerd.runc.v2\"\n\n          [plugins.\"io.containerd.grpc.v1.cri\".containerd.runtimes.runc.options]\n            BinaryName = \"\"\n            CriuImagePath = \"\"\n            CriuPath = \"\"\n            CriuWorkPath = \"\"\n            IoGid = 0\n            IoUid = 0\n            NoNewKeyring = false\n            NoPivotRoot = false\n            Root = \"\"\n            ShimCgroup = \"\"\n            SystemdCgroup = false\n\n      [plugins.\"io.containerd.grpc.v1.cri\".containerd.untrusted_workload_runtime]\n        base_runtime_spec = \"\"\n        cni_conf_dir = \"\"\n        cni_max_conf_num = 0\n        container_annotations = []\n        pod_annotations = []\n        privileged_without_host_devices = false\n        runtime_engine = \"\"\n        runtime_path = \"\"\n        runtime_root = \"\"\n        runtime_type = \"\"\n\n        [plugins.\"io.containerd.grpc.v1.cri\".containerd.untrusted_workload_runtime.options]\n\n    [plugins.\"io.containerd.grpc.v1.cri\".image_decryption]\n      key_model = \"node\"\n\n    [plugins.\"io.containerd.grpc.v1.cri\".registry]\n      config_path = \"\"\n\n      [plugins.\"io.containerd.grpc.v1.cri\".registry.auths]\n\n      [plugins.\"io.containerd.grpc.v1.cri\".registry.configs]\n\n      [plugins.\"io.containerd.grpc.v1.cri\".registry.headers]\n\n      [plugins.\"io.containerd.grpc.v1.cri\".registry.mirrors]\n\n    [plugins.\"io.containerd.grpc.v1.cri\".x509_key_pair_streaming]\n      tls_cert_file = \"\"\n      tls_key_file = \"\"\n\n  [plugins.\"io.containerd.internal.v1.opt\"]\n    path = \"/opt/containerd\"\n\n  [plugins.\"io.containerd.internal.v1.restart\"]\n    interval = \"10s\"\n\n  [plugins.\"io.containerd.internal.v1.tracing\"]\n    sampling_ratio = 1.0\n    service_name = \"containerd\"\n\n  [plugins.\"io.containerd.metadata.v1.bolt\"]\n    content_sharing_policy = \"shared\"\n\n  [plugins.\"io.containerd.monitor.v1.cgroups\"]\n    no_prometheus = false\n\n  [plugins.\"io.containerd.runtime.v1.linux\"]\n    no_shim = false\n    runtime = \"runc\"\n    runtime_root = \"\"\n    shim = \"containerd-shim\"\n    shim_debug = false\n\n  [plugins.\"io.containerd.runtime.v2.task\"]\n    platforms = [\"linux/amd64\"]\n    sched_core = false\n\n  [plugins.\"io.containerd.service.v1.diff-service\"]\n    default = [\"walking\"]\n\n  [plugins.\"io.containerd.service.v1.tasks-service\"]\n    rdt_config_file = \"\"\n\n  [plugins.\"io.containerd.snapshotter.v1.aufs\"]\n    root_path = \"\"\n\n  [plugins.\"io.containerd.snapshotter.v1.btrfs\"]\n    root_path = \"\"\n\n  [plugins.\"io.containerd.snapshotter.v1.devmapper\"]\n    async_remove = false\n    base_image_size = \"\"\n    discard_blocks = false\n    fs_options = \"\"\n    fs_type = \"\"\n    pool_name = \"\"\n    root_path = \"\"\n\n  [plugins.\"io.containerd.snapshotter.v1.native\"]\n    root_path = \"\"\n\n  [plugins.\"io.containerd.snapshotter.v1.overlayfs\"]\n    root_path = \"\"\n    upperdir_label = false\n\n  [plugins.\"io.containerd.snapshotter.v1.zfs\"]\n    root_path = \"\"\n\n  [plugins.\"io.containerd.tracing.processor.v1.otlp\"]\n    endpoint = \"\"\n    insecure = false\n    protocol = \"\"\n\n[proxy_plugins]\n\n[stream_processors]\n\n  [stream_processors.\"io.containerd.ocicrypt.decoder.v1.tar\"]\n    accepts = [\"application/vnd.oci.image.layer.v1.tar+encrypted\"]\n    args = [\"--decryption-keys-path\", \"/etc/containerd/ocicrypt/keys\"]\n    env = [\"OCICRYPT_KEYPROVIDER_CONFIG=/etc/containerd/ocicrypt/ocicrypt_keyprovider.conf\"]\n    path = \"ctd-decoder\"\n    returns = \"application/vnd.oci.image.layer.v1.tar\"\n\n  [stream_processors.\"io.containerd.ocicrypt.decoder.v1.tar.gzip\"]\n    accepts = [\"application/vnd.oci.image.layer.v1.tar+gzip+encrypted\"]\n    args = [\"--decryption-keys-path\", \"/etc/containerd/ocicrypt/keys\"]\n    env = [\"OCICRYPT_KEYPROVIDER_CONFIG=/etc/containerd/ocicrypt/ocicrypt_keyprovider.conf\"]\n    path = \"ctd-decoder\"\n    returns = \"application/vnd.oci.image.layer.v1.tar+gzip\"\n\n[timeouts]\n  \"io.containerd.timeout.bolt.open\" = \"0s\"\n  \"io.containerd.timeout.shim.cleanup\" = \"5s\"\n  \"io.containerd.timeout.shim.load\" = \"5s\"\n  \"io.containerd.timeout.shim.shutdown\" = \"3s\"\n  \"io.containerd.timeout.task.state\" = \"2s\"\n\n[ttrpc]\n  address = \"\"\n  gid = 0\n  uid = 0",
    "stdout_lines": [
        "disabled_plugins = []",
        "imports = []",
        "oom_score = 0",
        "plugin_dir = \"\"",
        "required_plugins = []",
        "root = \"/var/lib/containerd\"",
        "state = \"/run/containerd\"",
        "temp = \"\"",
        "version = 2",
        "",
        "[cgroup]",
        "  path = \"\"",
        "",
        "[debug]",
        "  address = \"\"",
        "  format = \"\"",
        "  gid = 0",
        "  level = \"\"",
        "  uid = 0",
        "",
        "[grpc]",
        "  address = \"/run/containerd/containerd.sock\"",
        "  gid = 0",
        "  max_recv_message_size = 16777216",
        "  max_send_message_size = 16777216",
        "  tcp_address = \"\"",
        "  tcp_tls_ca = \"\"",
        "  tcp_tls_cert = \"\"",
        "  tcp_tls_key = \"\"",
        "  uid = 0",
        "",
        "[metrics]",
        "  address = \"\"",
        "  grpc_histogram = false",
        "",
        "[plugins]",
        "",
        "  [plugins.\"io.containerd.gc.v1.scheduler\"]",
        "    deletion_threshold = 0",
        "    mutation_threshold = 100",
        "    pause_threshold = 0.02",
        "    schedule_delay = \"0s\"",
        "    startup_delay = \"100ms\"",
        "",
        "  [plugins.\"io.containerd.grpc.v1.cri\"]",
        "    device_ownership_from_security_context = false",
        "    disable_apparmor = false",
        "    disable_cgroup = false",
        "    disable_hugetlb_controller = true",
        "    disable_proc_mount = false",
        "    disable_tcp_service = true",
        "    enable_selinux = false",
        "    enable_tls_streaming = false",
        "    enable_unprivileged_icmp = false",
        "    enable_unprivileged_ports = false",
        "    ignore_image_defined_volumes = false",
        "    max_concurrent_downloads = 3",
        "    max_container_log_line_size = 16384",
        "    netns_mounts_under_state_dir = false",
        "    restrict_oom_score_adj = false",
        "    sandbox_image = \"k8s.gcr.io/pause:3.6\"",
        "    selinux_category_range = 1024",
        "    stats_collect_period = 10",
        "    stream_idle_timeout = \"4h0m0s\"",
        "    stream_server_address = \"127.0.0.1\"",
        "    stream_server_port = \"0\"",
        "    systemd_cgroup = false",
        "    tolerate_missing_hugetlb_controller = true",
        "    unset_seccomp_profile = \"\"",
        "",
        "    [plugins.\"io.containerd.grpc.v1.cri\".cni]",
        "      bin_dir = \"/opt/cni/bin\"",
        "      conf_dir = \"/etc/cni/net.d\"",
        "      conf_template = \"\"",
        "      ip_pref = \"\"",
        "      max_conf_num = 1",
        "",
        "    [plugins.\"io.containerd.grpc.v1.cri\".containerd]",
        "      default_runtime_name = \"runc\"",
        "      disable_snapshot_annotations = true",
        "      discard_unpacked_layers = false",
        "      ignore_rdt_not_enabled_errors = false",
        "      no_pivot = false",
        "      snapshotter = \"overlayfs\"",
        "",
        "      [plugins.\"io.containerd.grpc.v1.cri\".containerd.default_runtime]",
        "        base_runtime_spec = \"\"",
        "        cni_conf_dir = \"\"",
        "        cni_max_conf_num = 0",
        "        container_annotations = []",
        "        pod_annotations = []",
        "        privileged_without_host_devices = false",
        "        runtime_engine = \"\"",
        "        runtime_path = \"\"",
        "        runtime_root = \"\"",
        "        runtime_type = \"\"",
        "",
        "        [plugins.\"io.containerd.grpc.v1.cri\".containerd.default_runtime.options]",
        "",
        "      [plugins.\"io.containerd.grpc.v1.cri\".containerd.runtimes]",
        "",
        "        [plugins.\"io.containerd.grpc.v1.cri\".containerd.runtimes.runc]",
        "          base_runtime_spec = \"\"",
        "          cni_conf_dir = \"\"",
        "          cni_max_conf_num = 0",
        "          container_annotations = []",
        "          pod_annotations = []",
        "          privileged_without_host_devices = false",
        "          runtime_engine = \"\"",
        "          runtime_path = \"\"",
        "          runtime_root = \"\"",
        "          runtime_type = \"io.containerd.runc.v2\"",
        "",
        "          [plugins.\"io.containerd.grpc.v1.cri\".containerd.runtimes.runc.options]",
        "            BinaryName = \"\"",
        "            CriuImagePath = \"\"",
        "            CriuPath = \"\"",
        "            CriuWorkPath = \"\"",
        "            IoGid = 0",
        "            IoUid = 0",
        "            NoNewKeyring = false",
        "            NoPivotRoot = false",
        "            Root = \"\"",
        "            ShimCgroup = \"\"",
        "            SystemdCgroup = false",
        "",
        "      [plugins.\"io.containerd.grpc.v1.cri\".containerd.untrusted_workload_runtime]",
        "        base_runtime_spec = \"\"",
        "        cni_conf_dir = \"\"",
        "        cni_max_conf_num = 0",
        "        container_annotations = []",
        "        pod_annotations = []",
        "        privileged_without_host_devices = false",
        "        runtime_engine = \"\"",
        "        runtime_path = \"\"",
        "        runtime_root = \"\"",
        "        runtime_type = \"\"",
        "",
        "        [plugins.\"io.containerd.grpc.v1.cri\".containerd.untrusted_workload_runtime.options]",
        "",
        "    [plugins.\"io.containerd.grpc.v1.cri\".image_decryption]",
        "      key_model = \"node\"",
        "",
        "    [plugins.\"io.containerd.grpc.v1.cri\".registry]",
        "      config_path = \"\"",
        "",
        "      [plugins.\"io.containerd.grpc.v1.cri\".registry.auths]",
        "",
        "      [plugins.\"io.containerd.grpc.v1.cri\".registry.configs]",
        "",
        "      [plugins.\"io.containerd.grpc.v1.cri\".registry.headers]",
        "",
        "      [plugins.\"io.containerd.grpc.v1.cri\".registry.mirrors]",
        "",
        "    [plugins.\"io.containerd.grpc.v1.cri\".x509_key_pair_streaming]",
        "      tls_cert_file = \"\"",
        "      tls_key_file = \"\"",
        "",
        "  [plugins.\"io.containerd.internal.v1.opt\"]",
        "    path = \"/opt/containerd\"",
        "",
        "  [plugins.\"io.containerd.internal.v1.restart\"]",
        "    interval = \"10s\"",
        "",
        "  [plugins.\"io.containerd.internal.v1.tracing\"]",
        "    sampling_ratio = 1.0",
        "    service_name = \"containerd\"",
        "",
        "  [plugins.\"io.containerd.metadata.v1.bolt\"]",
        "    content_sharing_policy = \"shared\"",
        "",
        "  [plugins.\"io.containerd.monitor.v1.cgroups\"]",
        "    no_prometheus = false",
        "",
        "  [plugins.\"io.containerd.runtime.v1.linux\"]",
        "    no_shim = false",
        "    runtime = \"runc\"",
        "    runtime_root = \"\"",
        "    shim = \"containerd-shim\"",
        "    shim_debug = false",
        "",
        "  [plugins.\"io.containerd.runtime.v2.task\"]",
        "    platforms = [\"linux/amd64\"]",
        "    sched_core = false",
        "",
        "  [plugins.\"io.containerd.service.v1.diff-service\"]",
        "    default = [\"walking\"]",
        "",
        "  [plugins.\"io.containerd.service.v1.tasks-service\"]",
        "    rdt_config_file = \"\"",
        "",
        "  [plugins.\"io.containerd.snapshotter.v1.aufs\"]",
        "    root_path = \"\"",
        "",
        "  [plugins.\"io.containerd.snapshotter.v1.btrfs\"]",
        "    root_path = \"\"",
        "",
        "  [plugins.\"io.containerd.snapshotter.v1.devmapper\"]",
        "    async_remove = false",
        "    base_image_size = \"\"",
        "    discard_blocks = false",
        "    fs_options = \"\"",
        "    fs_type = \"\"",
        "    pool_name = \"\"",
        "    root_path = \"\"",
        "",
        "  [plugins.\"io.containerd.snapshotter.v1.native\"]",
        "    root_path = \"\"",
        "",
        "  [plugins.\"io.containerd.snapshotter.v1.overlayfs\"]",
        "    root_path = \"\"",
        "    upperdir_label = false",
        "",
        "  [plugins.\"io.containerd.snapshotter.v1.zfs\"]",
        "    root_path = \"\"",
        "",
        "  [plugins.\"io.containerd.tracing.processor.v1.otlp\"]",
        "    endpoint = \"\"",
        "    insecure = false",
        "    protocol = \"\"",
        "",
        "[proxy_plugins]",
        "",
        "[stream_processors]",
        "",
        "  [stream_processors.\"io.containerd.ocicrypt.decoder.v1.tar\"]",
        "    accepts = [\"application/vnd.oci.image.layer.v1.tar+encrypted\"]",
        "    args = [\"--decryption-keys-path\", \"/etc/containerd/ocicrypt/keys\"]",
        "    env = [\"OCICRYPT_KEYPROVIDER_CONFIG=/etc/containerd/ocicrypt/ocicrypt_keyprovider.conf\"]",
        "    path = \"ctd-decoder\"",
        "    returns = \"application/vnd.oci.image.layer.v1.tar\"",
        "",
        "  [stream_processors.\"io.containerd.ocicrypt.decoder.v1.tar.gzip\"]",
        "    accepts = [\"application/vnd.oci.image.layer.v1.tar+gzip+encrypted\"]",
        "    args = [\"--decryption-keys-path\", \"/etc/containerd/ocicrypt/keys\"]",
        "    env = [\"OCICRYPT_KEYPROVIDER_CONFIG=/etc/containerd/ocicrypt/ocicrypt_keyprovider.conf\"]",
        "    path = \"ctd-decoder\"",
        "    returns = \"application/vnd.oci.image.layer.v1.tar+gzip\"",
        "",
        "[timeouts]",
        "  \"io.containerd.timeout.bolt.open\" = \"0s\"",
        "  \"io.containerd.timeout.shim.cleanup\" = \"5s\"",
        "  \"io.containerd.timeout.shim.load\" = \"5s\"",
        "  \"io.containerd.timeout.shim.shutdown\" = \"3s\"",
        "  \"io.containerd.timeout.task.state\" = \"2s\"",
        "",
        "[ttrpc]",
        "  address = \"\"",
        "  gid = 0",
        "  uid = 0"
    ]
}

TASK [Update containerd config] ************************************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:119
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'echo ~ec2-user && sleep 0'"'"''
<10.0.1.171> (0, b'/home/ec2-user\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /home/ec2-user/.ansible/tmp `"&& mkdir "` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489256.3970137-326896-85498354943051 `" && echo ansible-tmp-1721489256.3970137-326896-85498354943051="` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489256.3970137-326896-85498354943051 `" ) && sleep 0'"'"''
<10.0.1.171> (0, b'ansible-tmp-1721489256.3970137-326896-85498354943051=/home/ec2-user/.ansible/tmp/ansible-tmp-1721489256.3970137-326896-85498354943051\n', b'')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/replace.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpz8zh49rz TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489256.3970137-326896-85498354943051/AnsiballZ_replace.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpz8zh49rz /home/ec2-user/.ansible/tmp/ansible-tmp-1721489256.3970137-326896-85498354943051/AnsiballZ_replace.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489256.3970137-326896-85498354943051/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489256.3970137-326896-85498354943051/AnsiballZ_replace.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-pqpqhjcwjkxgwsbpeovmzqrurkbuqlxy ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489256.3970137-326896-85498354943051/AnsiballZ_replace.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"rc": 0, "msg": "1 replacements made", "changed": true, "invocation": {"module_args": {"path": "/etc/containerd/config.toml", "regexp": "SystemdCgroup = false", "replace": "SystemdCgroup = true", "backup": false, "encoding": "utf-8", "unsafe_writes": false, "after": null, "before": null, "validate": null, "mode": null, "owner": null, "group": null, "seuser": null, "serole": null, "selevel": null, "setype": null, "attributes": null}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'rm -f -r /home/ec2-user/.ansible/tmp/ansible-tmp-1721489256.3970137-326896-85498354943051/ > /dev/null 2>&1 && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
changed: [master] => {
    "changed": true,
    "invocation": {
        "module_args": {
            "after": null,
            "attributes": null,
            "backup": false,
            "before": null,
            "encoding": "utf-8",
            "group": null,
            "mode": null,
            "owner": null,
            "path": "/etc/containerd/config.toml",
            "regexp": "SystemdCgroup = false",
            "replace": "SystemdCgroup = true",
            "selevel": null,
            "serole": null,
            "setype": null,
            "seuser": null,
            "unsafe_writes": false,
            "validate": null
        }
    },
    "msg": "1 replacements made",
    "rc": 0
}

TASK [Set sandbox image in containerd config] **********************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:125
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'echo ~ec2-user && sleep 0'"'"''
<10.0.1.171> (0, b'/home/ec2-user\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /home/ec2-user/.ansible/tmp `"&& mkdir "` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489257.123242-326907-4052917174184 `" && echo ansible-tmp-1721489257.123242-326907-4052917174184="` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489257.123242-326907-4052917174184 `" ) && sleep 0'"'"''
<10.0.1.171> (0, b'ansible-tmp-1721489257.123242-326907-4052917174184=/home/ec2-user/.ansible/tmp/ansible-tmp-1721489257.123242-326907-4052917174184\n', b'')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/replace.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmp04v0qu6k TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489257.123242-326907-4052917174184/AnsiballZ_replace.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmp04v0qu6k /home/ec2-user/.ansible/tmp/ansible-tmp-1721489257.123242-326907-4052917174184/AnsiballZ_replace.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489257.123242-326907-4052917174184/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489257.123242-326907-4052917174184/AnsiballZ_replace.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-dptispsfrihjxqtxeqhjopijhwvqzxrv ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489257.123242-326907-4052917174184/AnsiballZ_replace.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"rc": 0, "msg": "1 replacements made", "changed": true, "invocation": {"module_args": {"path": "/etc/containerd/config.toml", "regexp": "^(\\\\s*sandbox_image\\\\s*=\\\\s*).+\\"k8s.gcr.io/pause:3.6\\"", "replace": "\\\\1\\"registry.k8s.io/pause:3.2\\"", "backup": false, "encoding": "utf-8", "unsafe_writes": false, "after": null, "before": null, "validate": null, "mode": null, "owner": null, "group": null, "seuser": null, "serole": null, "selevel": null, "setype": null, "attributes": null}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'rm -f -r /home/ec2-user/.ansible/tmp/ansible-tmp-1721489257.123242-326907-4052917174184/ > /dev/null 2>&1 && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
changed: [master] => {
    "changed": true,
    "invocation": {
        "module_args": {
            "after": null,
            "attributes": null,
            "backup": false,
            "before": null,
            "encoding": "utf-8",
            "group": null,
            "mode": null,
            "owner": null,
            "path": "/etc/containerd/config.toml",
            "regexp": "^(\\s*sandbox_image\\s*=\\s*).+\"k8s.gcr.io/pause:3.6\"",
            "replace": "\\1\"registry.k8s.io/pause:3.2\"",
            "selevel": null,
            "serole": null,
            "setype": null,
            "seuser": null,
            "unsafe_writes": false,
            "validate": null
        }
    },
    "msg": "1 replacements made",
    "rc": 0
}

TASK [Restart containerd] ******************************************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:131
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'echo ~ec2-user && sleep 0'"'"''
<10.0.1.171> (0, b'/home/ec2-user\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /home/ec2-user/.ansible/tmp `"&& mkdir "` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489257.7794018-326916-259400543411921 `" && echo ansible-tmp-1721489257.7794018-326916-259400543411921="` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489257.7794018-326916-259400543411921 `" ) && sleep 0'"'"''
<10.0.1.171> (0, b'ansible-tmp-1721489257.7794018-326916-259400543411921=/home/ec2-user/.ansible/tmp/ansible-tmp-1721489257.7794018-326916-259400543411921\n', b'')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/systemd.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpchtkkwtp TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489257.7794018-326916-259400543411921/AnsiballZ_systemd.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpchtkkwtp /home/ec2-user/.ansible/tmp/ansible-tmp-1721489257.7794018-326916-259400543411921/AnsiballZ_systemd.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489257.7794018-326916-259400543411921/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489257.7794018-326916-259400543411921/AnsiballZ_systemd.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-qejfqbopkutayoptudugwdorafkjtbxm ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489257.7794018-326916-259400543411921/AnsiballZ_systemd.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"name": "containerd", "changed": true, "status": {"Type": "notify", "ExitType": "main", "Restart": "always", "NotifyAccess": "main", "RestartUSec": "5s", "TimeoutStartUSec": "1min 30s", "TimeoutStopUSec": "1min 30s", "TimeoutAbortUSec": "1min 30s", "TimeoutStartFailureMode": "terminate", "TimeoutStopFailureMode": "terminate", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "WatchdogUSec": "0", "WatchdogTimestampMonotonic": "0", "RootDirectoryStartOnly": "no", "RemainAfterExit": "no", "GuessMainPID": "yes", "MainPID": "3645", "ControlPID": "0", "FileDescriptorStoreMax": "0", "NFileDescriptorStore": "0", "StatusErrno": "0", "Result": "success", "ReloadResult": "success", "CleanResult": "success", "UID": "[not set]", "GID": "[not set]", "NRestarts": "0", "OOMPolicy": "continue", "ExecMainStartTimestamp": "Sat 2024-07-20 15:27:26 UTC", "ExecMainStartTimestampMonotonic": "49893482", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "3645", "ExecMainCode": "0", "ExecMainStatus": "0", "ExecStartPre": "{ path=/sbin/modprobe ; argv[]=/sbin/modprobe overlay ; ignore_errors=yes ; start_time=[Sat 2024-07-20 15:27:26 UTC] ; stop_time=[Sat 2024-07-20 15:27:26 UTC] ; pid=3644 ; code=exited ; status=0 }", "ExecStartPreEx": "{ path=/sbin/modprobe ; argv[]=/sbin/modprobe overlay ; flags=ignore-failure ; start_time=[Sat 2024-07-20 15:27:26 UTC] ; stop_time=[Sat 2024-07-20 15:27:26 UTC] ; pid=3644 ; code=exited ; status=0 }", "ExecStart": "{ path=/usr/local/bin/containerd ; argv[]=/usr/local/bin/containerd ; ignore_errors=no ; start_time=[Sat 2024-07-20 15:27:26 UTC] ; stop_time=[n/a] ; pid=3645 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/local/bin/containerd ; argv[]=/usr/local/bin/containerd ; flags= ; start_time=[Sat 2024-07-20 15:27:26 UTC] ; stop_time=[n/a] ; pid=3645 ; code=(null) ; status=0/0 }", "Slice": "system.slice", "ControlGroup": "/system.slice/containerd.service", "ControlGroupId": "5178", "MemoryCurrent": "20037632", "MemoryAvailable": "infinity", "CPUUsageNSec": "102311000", "EffectiveCPUs": "0-1", "EffectiveMemoryNodes": "0", "TasksCurrent": "10", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "Delegate": "yes", "DelegateControllers": "cpu cpuset io memory pids", "CPUAccounting": "yes", "CPUWeight": "[not set]", "StartupCPUWeight": "[not set]", "CPUShares": "[not set]", "StartupCPUShares": "[not set]", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "IOAccounting": "no", "IOWeight": "[not set]", "StartupIOWeight": "[not set]", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "StartupBlockIOWeight": "[not set]", "MemoryAccounting": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "MemoryMin": "0", "MemoryLow": "0", "MemoryHigh": "infinity", "MemoryMax": "infinity", "MemorySwapMax": "infinity", "MemoryLimit": "infinity", "DevicePolicy": "auto", "TasksAccounting": "yes", "TasksMax": "infinity", "IPAccounting": "no", "ManagedOOMSwap": "auto", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "UMask": "0022", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitSTACK": "10485760", "LimitSTACKSoft": "10485760", "LimitCORE": "infinity", "LimitCORESoft": "infinity", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitNOFILE": "65535", "LimitNOFILESoft": "65535", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitNPROC": "infinity", "LimitNPROCSoft": "infinity", "LimitMEMLOCK": "infinity", "LimitMEMLOCKSoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitSIGPENDING": "30446", "LimitSIGPENDINGSoft": "30446", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "OOMScoreAdjust": "-999", "CoredumpFilter": "0x33", "Nice": "0", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUAffinityFromNUMA": "no", "NUMAPolicy": "n/a", "TimerSlackNSec": "50000", "CPUSchedulingResetOnFork": "no", "NonBlocking": "no", "StandardInput": "null", "StandardOutput": "journal", "StandardError": "inherit", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "SyslogPriority": "30", "SyslogLevelPrefix": "yes", "SyslogLevel": "6", "SyslogFacility": "3", "LogLevelMax": "-1", "LogRateLimitIntervalUSec": "0", "LogRateLimitBurst": "0", "SecureBits": "0", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "DynamicUser": "no", "RemoveIPC": "no", "PrivateTmp": "no", "PrivateDevices": "no", "ProtectClock": "no", "ProtectKernelTunables": "no", "ProtectKernelModules": "no", "ProtectKernelLogs": "no", "ProtectControlGroups": "no", "PrivateNetwork": "no", "PrivateUsers": "no", "PrivateMounts": "no", "PrivateIPC": "no", "ProtectHome": "no", "ProtectSystem": "no", "SameProcessGroup": "no", "UtmpMode": "init", "IgnoreSIGPIPE": "yes", "NoNewPrivileges": "no", "SystemCallErrorNumber": "2147483646", "LockPersonality": "no", "RuntimeDirectoryPreserve": "no", "RuntimeDirectoryMode": "0755", "StateDirectoryMode": "0755", "CacheDirectoryMode": "0755", "LogsDirectoryMode": "0755", "ConfigurationDirectoryMode": "0755", "TimeoutCleanUSec": "infinity", "MemoryDenyWriteExecute": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "RestrictNamespaces": "no", "MountAPIVFS": "no", "KeyringMode": "private", "ProtectProc": "default", "ProcSubset": "all", "ProtectHostname": "no", "KillMode": "process", "KillSignal": "15", "RestartKillSignal": "15", "FinalKillSignal": "9", "SendSIGKILL": "yes", "SendSIGHUP": "no", "WatchdogSignal": "6", "Id": "containerd.service", "Names": "containerd.service", "Requires": "system.slice sysinit.target", "WantedBy": "multi-user.target", "Conflicts": "shutdown.target", "Before": "multi-user.target shutdown.target", "After": "basic.target systemd-journald.socket local-fs.target network.target system.slice sysinit.target", "Documentation": "https://containerd.io", "Description": "containerd container runtime", "AccessSELinuxContext": "system_u:object_r:systemd_unit_file_t:s0", "LoadState": "loaded", "ActiveState": "active", "FreezerState": "running", "SubState": "running", "FragmentPath": "/etc/systemd/system/containerd.service", "UnitFileState": "enabled", "UnitFilePreset": "disabled", "StateChangeTimestamp": "Sat 2024-07-20 15:27:26 UTC", "StateChangeTimestampMonotonic": "49959868", "InactiveExitTimestamp": "Sat 2024-07-20 15:27:26 UTC", "InactiveExitTimestampMonotonic": "49887349", "ActiveEnterTimestamp": "Sat 2024-07-20 15:27:26 UTC", "ActiveEnterTimestampMonotonic": "49959868", "ActiveExitTimestampMonotonic": "0", "InactiveEnterTimestampMonotonic": "0", "CanStart": "yes", "CanStop": "yes", "CanReload": "no", "CanIsolate": "no", "CanFreeze": "yes", "StopWhenUnneeded": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "AllowIsolate": "no", "DefaultDependencies": "yes", "OnSuccessJobMode": "fail", "OnFailureJobMode": "replace", "IgnoreOnIsolate": "no", "NeedDaemonReload": "no", "JobTimeoutUSec": "infinity", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "ConditionResult": "yes", "AssertResult": "yes", "ConditionTimestamp": "Sat 2024-07-20 15:27:26 UTC", "ConditionTimestampMonotonic": "49884484", "AssertTimestamp": "Sat 2024-07-20 15:27:26 UTC", "AssertTimestampMonotonic": "49884488", "Transient": "no", "Perpetual": "no", "StartLimitIntervalUSec": "10s", "StartLimitBurst": "5", "StartLimitAction": "none", "FailureAction": "none", "SuccessAction": "none", "InvocationID": "e2bca7c9593548f2945d718f40471e9e", "CollectMode": "inactive"}, "state": "started", "invocation": {"module_args": {"name": "containerd", "state": "restarted", "daemon_reload": false, "daemon_reexec": false, "scope": "system", "no_block": false, "enabled": null, "force": null, "masked": null}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'rm -f -r /home/ec2-user/.ansible/tmp/ansible-tmp-1721489257.7794018-326916-259400543411921/ > /dev/null 2>&1 && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
changed: [master] => {
    "changed": true,
    "invocation": {
        "module_args": {
            "daemon_reexec": false,
            "daemon_reload": false,
            "enabled": null,
            "force": null,
            "masked": null,
            "name": "containerd",
            "no_block": false,
            "scope": "system",
            "state": "restarted"
        }
    },
    "name": "containerd",
    "state": "started",
    "status": {
        "AccessSELinuxContext": "system_u:object_r:systemd_unit_file_t:s0",
        "ActiveEnterTimestamp": "Sat 2024-07-20 15:27:26 UTC",
        "ActiveEnterTimestampMonotonic": "49959868",
        "ActiveExitTimestampMonotonic": "0",
        "ActiveState": "active",
        "After": "basic.target systemd-journald.socket local-fs.target network.target system.slice sysinit.target",
        "AllowIsolate": "no",
        "AssertResult": "yes",
        "AssertTimestamp": "Sat 2024-07-20 15:27:26 UTC",
        "AssertTimestampMonotonic": "49884488",
        "Before": "multi-user.target shutdown.target",
        "BlockIOAccounting": "no",
        "BlockIOWeight": "[not set]",
        "CPUAccounting": "yes",
        "CPUAffinityFromNUMA": "no",
        "CPUQuotaPerSecUSec": "infinity",
        "CPUQuotaPeriodUSec": "infinity",
        "CPUSchedulingPolicy": "0",
        "CPUSchedulingPriority": "0",
        "CPUSchedulingResetOnFork": "no",
        "CPUShares": "[not set]",
        "CPUUsageNSec": "102311000",
        "CPUWeight": "[not set]",
        "CacheDirectoryMode": "0755",
        "CanFreeze": "yes",
        "CanIsolate": "no",
        "CanReload": "no",
        "CanStart": "yes",
        "CanStop": "yes",
        "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore",
        "CleanResult": "success",
        "CollectMode": "inactive",
        "ConditionResult": "yes",
        "ConditionTimestamp": "Sat 2024-07-20 15:27:26 UTC",
        "ConditionTimestampMonotonic": "49884484",
        "ConfigurationDirectoryMode": "0755",
        "Conflicts": "shutdown.target",
        "ControlGroup": "/system.slice/containerd.service",
        "ControlGroupId": "5178",
        "ControlPID": "0",
        "CoredumpFilter": "0x33",
        "DefaultDependencies": "yes",
        "DefaultMemoryLow": "0",
        "DefaultMemoryMin": "0",
        "Delegate": "yes",
        "DelegateControllers": "cpu cpuset io memory pids",
        "Description": "containerd container runtime",
        "DevicePolicy": "auto",
        "Documentation": "https://containerd.io",
        "DynamicUser": "no",
        "EffectiveCPUs": "0-1",
        "EffectiveMemoryNodes": "0",
        "ExecMainCode": "0",
        "ExecMainExitTimestampMonotonic": "0",
        "ExecMainPID": "3645",
        "ExecMainStartTimestamp": "Sat 2024-07-20 15:27:26 UTC",
        "ExecMainStartTimestampMonotonic": "49893482",
        "ExecMainStatus": "0",
        "ExecStart": "{ path=/usr/local/bin/containerd ; argv[]=/usr/local/bin/containerd ; ignore_errors=no ; start_time=[Sat 2024-07-20 15:27:26 UTC] ; stop_time=[n/a] ; pid=3645 ; code=(null) ; status=0/0 }",
        "ExecStartEx": "{ path=/usr/local/bin/containerd ; argv[]=/usr/local/bin/containerd ; flags= ; start_time=[Sat 2024-07-20 15:27:26 UTC] ; stop_time=[n/a] ; pid=3645 ; code=(null) ; status=0/0 }",
        "ExecStartPre": "{ path=/sbin/modprobe ; argv[]=/sbin/modprobe overlay ; ignore_errors=yes ; start_time=[Sat 2024-07-20 15:27:26 UTC] ; stop_time=[Sat 2024-07-20 15:27:26 UTC] ; pid=3644 ; code=exited ; status=0 }",
        "ExecStartPreEx": "{ path=/sbin/modprobe ; argv[]=/sbin/modprobe overlay ; flags=ignore-failure ; start_time=[Sat 2024-07-20 15:27:26 UTC] ; stop_time=[Sat 2024-07-20 15:27:26 UTC] ; pid=3644 ; code=exited ; status=0 }",
        "ExitType": "main",
        "FailureAction": "none",
        "FileDescriptorStoreMax": "0",
        "FinalKillSignal": "9",
        "FragmentPath": "/etc/systemd/system/containerd.service",
        "FreezerState": "running",
        "GID": "[not set]",
        "GuessMainPID": "yes",
        "IOAccounting": "no",
        "IOReadBytes": "18446744073709551615",
        "IOReadOperations": "18446744073709551615",
        "IOSchedulingClass": "2",
        "IOSchedulingPriority": "4",
        "IOWeight": "[not set]",
        "IOWriteBytes": "18446744073709551615",
        "IOWriteOperations": "18446744073709551615",
        "IPAccounting": "no",
        "IPEgressBytes": "[no data]",
        "IPEgressPackets": "[no data]",
        "IPIngressBytes": "[no data]",
        "IPIngressPackets": "[no data]",
        "Id": "containerd.service",
        "IgnoreOnIsolate": "no",
        "IgnoreSIGPIPE": "yes",
        "InactiveEnterTimestampMonotonic": "0",
        "InactiveExitTimestamp": "Sat 2024-07-20 15:27:26 UTC",
        "InactiveExitTimestampMonotonic": "49887349",
        "InvocationID": "e2bca7c9593548f2945d718f40471e9e",
        "JobRunningTimeoutUSec": "infinity",
        "JobTimeoutAction": "none",
        "JobTimeoutUSec": "infinity",
        "KeyringMode": "private",
        "KillMode": "process",
        "KillSignal": "15",
        "LimitAS": "infinity",
        "LimitASSoft": "infinity",
        "LimitCORE": "infinity",
        "LimitCORESoft": "infinity",
        "LimitCPU": "infinity",
        "LimitCPUSoft": "infinity",
        "LimitDATA": "infinity",
        "LimitDATASoft": "infinity",
        "LimitFSIZE": "infinity",
        "LimitFSIZESoft": "infinity",
        "LimitLOCKS": "infinity",
        "LimitLOCKSSoft": "infinity",
        "LimitMEMLOCK": "infinity",
        "LimitMEMLOCKSoft": "infinity",
        "LimitMSGQUEUE": "819200",
        "LimitMSGQUEUESoft": "819200",
        "LimitNICE": "0",
        "LimitNICESoft": "0",
        "LimitNOFILE": "65535",
        "LimitNOFILESoft": "65535",
        "LimitNPROC": "infinity",
        "LimitNPROCSoft": "infinity",
        "LimitRSS": "infinity",
        "LimitRSSSoft": "infinity",
        "LimitRTPRIO": "0",
        "LimitRTPRIOSoft": "0",
        "LimitRTTIME": "infinity",
        "LimitRTTIMESoft": "infinity",
        "LimitSIGPENDING": "30446",
        "LimitSIGPENDINGSoft": "30446",
        "LimitSTACK": "10485760",
        "LimitSTACKSoft": "10485760",
        "LoadState": "loaded",
        "LockPersonality": "no",
        "LogLevelMax": "-1",
        "LogRateLimitBurst": "0",
        "LogRateLimitIntervalUSec": "0",
        "LogsDirectoryMode": "0755",
        "MainPID": "3645",
        "ManagedOOMMemoryPressure": "auto",
        "ManagedOOMMemoryPressureLimit": "0",
        "ManagedOOMPreference": "none",
        "ManagedOOMSwap": "auto",
        "MemoryAccounting": "yes",
        "MemoryAvailable": "infinity",
        "MemoryCurrent": "20037632",
        "MemoryDenyWriteExecute": "no",
        "MemoryHigh": "infinity",
        "MemoryLimit": "infinity",
        "MemoryLow": "0",
        "MemoryMax": "infinity",
        "MemoryMin": "0",
        "MemorySwapMax": "infinity",
        "MountAPIVFS": "no",
        "NFileDescriptorStore": "0",
        "NRestarts": "0",
        "NUMAPolicy": "n/a",
        "Names": "containerd.service",
        "NeedDaemonReload": "no",
        "Nice": "0",
        "NoNewPrivileges": "no",
        "NonBlocking": "no",
        "NotifyAccess": "main",
        "OOMPolicy": "continue",
        "OOMScoreAdjust": "-999",
        "OnFailureJobMode": "replace",
        "OnSuccessJobMode": "fail",
        "Perpetual": "no",
        "PrivateDevices": "no",
        "PrivateIPC": "no",
        "PrivateMounts": "no",
        "PrivateNetwork": "no",
        "PrivateTmp": "no",
        "PrivateUsers": "no",
        "ProcSubset": "all",
        "ProtectClock": "no",
        "ProtectControlGroups": "no",
        "ProtectHome": "no",
        "ProtectHostname": "no",
        "ProtectKernelLogs": "no",
        "ProtectKernelModules": "no",
        "ProtectKernelTunables": "no",
        "ProtectProc": "default",
        "ProtectSystem": "no",
        "RefuseManualStart": "no",
        "RefuseManualStop": "no",
        "ReloadResult": "success",
        "RemainAfterExit": "no",
        "RemoveIPC": "no",
        "Requires": "system.slice sysinit.target",
        "Restart": "always",
        "RestartKillSignal": "15",
        "RestartUSec": "5s",
        "RestrictNamespaces": "no",
        "RestrictRealtime": "no",
        "RestrictSUIDSGID": "no",
        "Result": "success",
        "RootDirectoryStartOnly": "no",
        "RuntimeDirectoryMode": "0755",
        "RuntimeDirectoryPreserve": "no",
        "RuntimeMaxUSec": "infinity",
        "RuntimeRandomizedExtraUSec": "0",
        "SameProcessGroup": "no",
        "SecureBits": "0",
        "SendSIGHUP": "no",
        "SendSIGKILL": "yes",
        "Slice": "system.slice",
        "StandardError": "inherit",
        "StandardInput": "null",
        "StandardOutput": "journal",
        "StartLimitAction": "none",
        "StartLimitBurst": "5",
        "StartLimitIntervalUSec": "10s",
        "StartupBlockIOWeight": "[not set]",
        "StartupCPUShares": "[not set]",
        "StartupCPUWeight": "[not set]",
        "StartupIOWeight": "[not set]",
        "StateChangeTimestamp": "Sat 2024-07-20 15:27:26 UTC",
        "StateChangeTimestampMonotonic": "49959868",
        "StateDirectoryMode": "0755",
        "StatusErrno": "0",
        "StopWhenUnneeded": "no",
        "SubState": "running",
        "SuccessAction": "none",
        "SyslogFacility": "3",
        "SyslogLevel": "6",
        "SyslogLevelPrefix": "yes",
        "SyslogPriority": "30",
        "SystemCallErrorNumber": "2147483646",
        "TTYReset": "no",
        "TTYVHangup": "no",
        "TTYVTDisallocate": "no",
        "TasksAccounting": "yes",
        "TasksCurrent": "10",
        "TasksMax": "infinity",
        "TimeoutAbortUSec": "1min 30s",
        "TimeoutCleanUSec": "infinity",
        "TimeoutStartFailureMode": "terminate",
        "TimeoutStartUSec": "1min 30s",
        "TimeoutStopFailureMode": "terminate",
        "TimeoutStopUSec": "1min 30s",
        "TimerSlackNSec": "50000",
        "Transient": "no",
        "Type": "notify",
        "UID": "[not set]",
        "UMask": "0022",
        "UnitFilePreset": "disabled",
        "UnitFileState": "enabled",
        "UtmpMode": "init",
        "WantedBy": "multi-user.target",
        "WatchdogSignal": "6",
        "WatchdogTimestampMonotonic": "0",
        "WatchdogUSec": "0"
    }
}

TASK [Set SELinux in permissive mode] ******************************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:138
redirecting (type: modules) ansible.builtin.selinux to ansible.posix.selinux
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'echo ~ec2-user && sleep 0'"'"''
<10.0.1.171> (0, b'/home/ec2-user\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /home/ec2-user/.ansible/tmp `"&& mkdir "` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489258.8745341-326931-191662107774635 `" && echo ansible-tmp-1721489258.8745341-326931-191662107774635="` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489258.8745341-326931-191662107774635 `" ) && sleep 0'"'"''
<10.0.1.171> (0, b'ansible-tmp-1721489258.8745341-326931-191662107774635=/home/ec2-user/.ansible/tmp/ansible-tmp-1721489258.8745341-326931-191662107774635\n', b'')
redirecting (type: modules) ansible.builtin.selinux to ansible.posix.selinux
Using module file /usr/lib/python3.9/site-packages/ansible_collections/ansible/posix/plugins/modules/selinux.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmp2fri0h5a TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489258.8745341-326931-191662107774635/AnsiballZ_selinux.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmp2fri0h5a /home/ec2-user/.ansible/tmp/ansible-tmp-1721489258.8745341-326931-191662107774635/AnsiballZ_selinux.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489258.8745341-326931-191662107774635/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489258.8745341-326931-191662107774635/AnsiballZ_selinux.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-ikqtsvxjenuzrrnjopshyjzpmnrubiho ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489258.8745341-326931-191662107774635/AnsiballZ_selinux.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"changed": false, "msg": "", "configfile": "/etc/selinux/config", "policy": "targeted", "state": "permissive", "reboot_required": false, "invocation": {"module_args": {"policy": "targeted", "state": "permissive", "configfile": "/etc/selinux/config", "update_kernel_param": false}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'rm -f -r /home/ec2-user/.ansible/tmp/ansible-tmp-1721489258.8745341-326931-191662107774635/ > /dev/null 2>&1 && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
ok: [master] => {
    "changed": false,
    "configfile": "/etc/selinux/config",
    "invocation": {
        "module_args": {
            "configfile": "/etc/selinux/config",
            "policy": "targeted",
            "state": "permissive",
            "update_kernel_param": false
        }
    },
    "msg": "",
    "policy": "targeted",
    "reboot_required": false,
    "state": "permissive"
}

TASK [Ensure SELinux is in permissive mode on reboot] **************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:143
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'echo ~ec2-user && sleep 0'"'"''
<10.0.1.171> (0, b'/home/ec2-user\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /home/ec2-user/.ansible/tmp `"&& mkdir "` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489260.289722-326943-107230745606372 `" && echo ansible-tmp-1721489260.289722-326943-107230745606372="` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489260.289722-326943-107230745606372 `" ) && sleep 0'"'"''
<10.0.1.171> (0, b'ansible-tmp-1721489260.289722-326943-107230745606372=/home/ec2-user/.ansible/tmp/ansible-tmp-1721489260.289722-326943-107230745606372\n', b'')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/replace.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpolqzn6ex TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489260.289722-326943-107230745606372/AnsiballZ_replace.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpolqzn6ex /home/ec2-user/.ansible/tmp/ansible-tmp-1721489260.289722-326943-107230745606372/AnsiballZ_replace.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489260.289722-326943-107230745606372/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489260.289722-326943-107230745606372/AnsiballZ_replace.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-urrfvrciyxeiifrmdyiklrnpnqjswjwp ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489260.289722-326943-107230745606372/AnsiballZ_replace.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"rc": 0, "msg": "", "changed": false, "invocation": {"module_args": {"path": "/etc/selinux/config", "regexp": "^SELINUX=enforcing", "replace": "SELINUX=permissive", "backup": false, "encoding": "utf-8", "unsafe_writes": false, "after": null, "before": null, "validate": null, "mode": null, "owner": null, "group": null, "seuser": null, "serole": null, "selevel": null, "setype": null, "attributes": null}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'rm -f -r /home/ec2-user/.ansible/tmp/ansible-tmp-1721489260.289722-326943-107230745606372/ > /dev/null 2>&1 && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
ok: [master] => {
    "changed": false,
    "invocation": {
        "module_args": {
            "after": null,
            "attributes": null,
            "backup": false,
            "before": null,
            "encoding": "utf-8",
            "group": null,
            "mode": null,
            "owner": null,
            "path": "/etc/selinux/config",
            "regexp": "^SELINUX=enforcing",
            "replace": "SELINUX=permissive",
            "selevel": null,
            "serole": null,
            "setype": null,
            "seuser": null,
            "unsafe_writes": false,
            "validate": null
        }
    },
    "msg": "",
    "rc": 0
}

TASK [Add Kubernetes yum repository without exclude] ***************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:149
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'echo ~ec2-user && sleep 0'"'"''
<10.0.1.171> (0, b'/home/ec2-user\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /home/ec2-user/.ansible/tmp `"&& mkdir "` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489260.8600674-326955-252716520259042 `" && echo ansible-tmp-1721489260.8600674-326955-252716520259042="` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489260.8600674-326955-252716520259042 `" ) && sleep 0'"'"''
<10.0.1.171> (0, b'ansible-tmp-1721489260.8600674-326955-252716520259042=/home/ec2-user/.ansible/tmp/ansible-tmp-1721489260.8600674-326955-252716520259042\n', b'')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/stat.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpxxujq2_6 TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489260.8600674-326955-252716520259042/AnsiballZ_stat.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpxxujq2_6 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489260.8600674-326955-252716520259042/AnsiballZ_stat.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489260.8600674-326955-252716520259042/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489260.8600674-326955-252716520259042/AnsiballZ_stat.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-yurmguzexcoclskfkusqckelwtdqzolj ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489260.8600674-326955-252716520259042/AnsiballZ_stat.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"changed": false, "stat": {"exists": false}, "invocation": {"module_args": {"path": "/etc/yum.repos.d/kubernetes.repo", "follow": false, "get_checksum": true, "checksum_algorithm": "sha1", "get_md5": false, "get_mime": true, "get_attributes": true}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpaesckanq TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489260.8600674-326955-252716520259042/source
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpaesckanq /home/ec2-user/.ansible/tmp/ansible-tmp-1721489260.8600674-326955-252716520259042/source\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489260.8600674-326955-252716520259042/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489260.8600674-326955-252716520259042/source && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/copy.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpkyjknv23 TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489260.8600674-326955-252716520259042/AnsiballZ_copy.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpkyjknv23 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489260.8600674-326955-252716520259042/AnsiballZ_copy.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489260.8600674-326955-252716520259042/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489260.8600674-326955-252716520259042/AnsiballZ_copy.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-cqydhhuanwbzxqxgqqkfltfcffbmijcj ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489260.8600674-326955-252716520259042/AnsiballZ_copy.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"dest": "/etc/yum.repos.d/kubernetes.repo", "src": "/home/ec2-user/.ansible/tmp/ansible-tmp-1721489260.8600674-326955-252716520259042/source", "md5sum": "764a81ed6a72dda13995e1c724946b77", "checksum": "0da9ad1eff06701cfd3bcb1a457afc549f0b8df4", "changed": true, "uid": 0, "gid": 0, "owner": "root", "group": "root", "mode": "0644", "state": "file", "secontext": "system_u:object_r:system_conf_t:s0", "size": 178, "invocation": {"module_args": {"dest": "/etc/yum.repos.d/kubernetes.repo", "src": "/home/ec2-user/.ansible/tmp/ansible-tmp-1721489260.8600674-326955-252716520259042/source", "_original_basename": "tmpaesckanq", "follow": false, "checksum": "0da9ad1eff06701cfd3bcb1a457afc549f0b8df4", "backup": false, "force": true, "unsafe_writes": false, "content": null, "validate": null, "directory_mode": null, "remote_src": null, "local_follow": null, "mode": null, "owner": null, "group": null, "seuser": null, "serole": null, "selevel": null, "setype": null, "attributes": null}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'rm -f -r /home/ec2-user/.ansible/tmp/ansible-tmp-1721489260.8600674-326955-252716520259042/ > /dev/null 2>&1 && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
changed: [master] => {
    "changed": true,
    "checksum": "0da9ad1eff06701cfd3bcb1a457afc549f0b8df4",
    "dest": "/etc/yum.repos.d/kubernetes.repo",
    "diff": [],
    "gid": 0,
    "group": "root",
    "invocation": {
        "module_args": {
            "_original_basename": "tmpaesckanq",
            "attributes": null,
            "backup": false,
            "checksum": "0da9ad1eff06701cfd3bcb1a457afc549f0b8df4",
            "content": null,
            "dest": "/etc/yum.repos.d/kubernetes.repo",
            "directory_mode": null,
            "follow": false,
            "force": true,
            "group": null,
            "local_follow": null,
            "mode": null,
            "owner": null,
            "remote_src": null,
            "selevel": null,
            "serole": null,
            "setype": null,
            "seuser": null,
            "src": "/home/ec2-user/.ansible/tmp/ansible-tmp-1721489260.8600674-326955-252716520259042/source",
            "unsafe_writes": false,
            "validate": null
        }
    },
    "md5sum": "764a81ed6a72dda13995e1c724946b77",
    "mode": "0644",
    "owner": "root",
    "secontext": "system_u:object_r:system_conf_t:s0",
    "size": 178,
    "src": "/home/ec2-user/.ansible/tmp/ansible-tmp-1721489260.8600674-326955-252716520259042/source",
    "state": "file",
    "uid": 0
}

TASK [Install Kubernetes packages] *********************************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:160
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'echo ~ec2-user && sleep 0'"'"''
<10.0.1.171> (0, b'/home/ec2-user\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /home/ec2-user/.ansible/tmp `"&& mkdir "` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489262.116502-326992-258704146434165 `" && echo ansible-tmp-1721489262.116502-326992-258704146434165="` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489262.116502-326992-258704146434165 `" ) && sleep 0'"'"''
<10.0.1.171> (0, b'ansible-tmp-1721489262.116502-326992-258704146434165=/home/ec2-user/.ansible/tmp/ansible-tmp-1721489262.116502-326992-258704146434165\n', b'')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/dnf.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmp1u894nc_ TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489262.116502-326992-258704146434165/AnsiballZ_dnf.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmp1u894nc_ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489262.116502-326992-258704146434165/AnsiballZ_dnf.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489262.116502-326992-258704146434165/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489262.116502-326992-258704146434165/AnsiballZ_dnf.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-qhafrrgcericdkwmzmtmnqlvnhwcoiqx ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489262.116502-326992-258704146434165/AnsiballZ_dnf.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"msg": "", "changed": true, "results": ["Installed: socat-1.7.4.2-1.amzn2023.0.2.x86_64", "Installed: kubectl-1.30.3-150500.1.1.x86_64", "Installed: libnftnl-1.2.2-2.amzn2023.0.2.x86_64", "Installed: iptables-libs-1.8.8-3.amzn2023.0.2.x86_64", "Installed: iptables-nft-1.8.8-3.amzn2023.0.2.x86_64", "Installed: kubeadm-1.30.3-150500.1.1.x86_64", "Installed: libnetfilter_conntrack-1.0.8-2.amzn2023.0.2.x86_64", "Installed: kubelet-1.30.3-150500.1.1.x86_64", "Installed: libnetfilter_cthelper-1.0.0-21.amzn2023.0.2.x86_64", "Installed: kubernetes-cni-1.4.0-150500.1.1.x86_64", "Installed: libnetfilter_cttimeout-1.0.0-19.amzn2023.0.2.x86_64", "Installed: cri-tools-1.30.0-150500.1.1.x86_64", "Installed: libnetfilter_queue-1.0.5-2.amzn2023.0.2.x86_64", "Installed: libnfnetlink-1.0.1-19.amzn2023.0.2.x86_64", "Installed: conntrack-tools-1.4.6-2.amzn2023.0.2.x86_64"], "rc": 0, "invocation": {"module_args": {"name": ["kubelet", "kubeadm", "kubectl"], "state": "present", "allow_downgrade": false, "autoremove": false, "bugfix": false, "cacheonly": false, "disable_gpg_check": false, "disable_plugin": [], "disablerepo": [], "download_only": false, "enable_plugin": [], "enablerepo": [], "exclude": [], "installroot": "/", "install_repoquery": true, "install_weak_deps": true, "security": false, "skip_broken": false, "update_cache": false, "update_only": false, "validate_certs": true, "sslverify": true, "lock_timeout": 30, "allowerasing": false, "nobest": false, "use_backend": "auto", "conf_file": null, "disable_excludes": null, "download_dir": null, "list": null, "releasever": null}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'rm -f -r /home/ec2-user/.ansible/tmp/ansible-tmp-1721489262.116502-326992-258704146434165/ > /dev/null 2>&1 && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
changed: [master] => {
    "changed": true,
    "invocation": {
        "module_args": {
            "allow_downgrade": false,
            "allowerasing": false,
            "autoremove": false,
            "bugfix": false,
            "cacheonly": false,
            "conf_file": null,
            "disable_excludes": null,
            "disable_gpg_check": false,
            "disable_plugin": [],
            "disablerepo": [],
            "download_dir": null,
            "download_only": false,
            "enable_plugin": [],
            "enablerepo": [],
            "exclude": [],
            "install_repoquery": true,
            "install_weak_deps": true,
            "installroot": "/",
            "list": null,
            "lock_timeout": 30,
            "name": [
                "kubelet",
                "kubeadm",
                "kubectl"
            ],
            "nobest": false,
            "releasever": null,
            "security": false,
            "skip_broken": false,
            "sslverify": true,
            "state": "present",
            "update_cache": false,
            "update_only": false,
            "use_backend": "auto",
            "validate_certs": true
        }
    },
    "msg": "",
    "rc": 0,
    "results": [
        "Installed: socat-1.7.4.2-1.amzn2023.0.2.x86_64",
        "Installed: kubectl-1.30.3-150500.1.1.x86_64",
        "Installed: libnftnl-1.2.2-2.amzn2023.0.2.x86_64",
        "Installed: iptables-libs-1.8.8-3.amzn2023.0.2.x86_64",
        "Installed: iptables-nft-1.8.8-3.amzn2023.0.2.x86_64",
        "Installed: kubeadm-1.30.3-150500.1.1.x86_64",
        "Installed: libnetfilter_conntrack-1.0.8-2.amzn2023.0.2.x86_64",
        "Installed: kubelet-1.30.3-150500.1.1.x86_64",
        "Installed: libnetfilter_cthelper-1.0.0-21.amzn2023.0.2.x86_64",
        "Installed: kubernetes-cni-1.4.0-150500.1.1.x86_64",
        "Installed: libnetfilter_cttimeout-1.0.0-19.amzn2023.0.2.x86_64",
        "Installed: cri-tools-1.30.0-150500.1.1.x86_64",
        "Installed: libnetfilter_queue-1.0.5-2.amzn2023.0.2.x86_64",
        "Installed: libnfnetlink-1.0.1-19.amzn2023.0.2.x86_64",
        "Installed: conntrack-tools-1.4.6-2.amzn2023.0.2.x86_64"
    ]
}

TASK [Add exclude parameter to Kubernetes yum repository] **********************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:168
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'echo ~ec2-user && sleep 0'"'"''
<10.0.1.171> (0, b'/home/ec2-user\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /home/ec2-user/.ansible/tmp `"&& mkdir "` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489279.007526-327102-176630463547443 `" && echo ansible-tmp-1721489279.007526-327102-176630463547443="` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489279.007526-327102-176630463547443 `" ) && sleep 0'"'"''
<10.0.1.171> (0, b'ansible-tmp-1721489279.007526-327102-176630463547443=/home/ec2-user/.ansible/tmp/ansible-tmp-1721489279.007526-327102-176630463547443\n', b'')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/lineinfile.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmp925ypq2u TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489279.007526-327102-176630463547443/AnsiballZ_lineinfile.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmp925ypq2u /home/ec2-user/.ansible/tmp/ansible-tmp-1721489279.007526-327102-176630463547443/AnsiballZ_lineinfile.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489279.007526-327102-176630463547443/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489279.007526-327102-176630463547443/AnsiballZ_lineinfile.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-fsrzhxklguzdmbneijdwkaibjtyedzua ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489279.007526-327102-176630463547443/AnsiballZ_lineinfile.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"changed": true, "msg": "line added", "backup": "", "diff": [{"before": "", "after": "", "before_header": "/etc/yum.repos.d/kubernetes.repo (content)", "after_header": "/etc/yum.repos.d/kubernetes.repo (content)"}, {"before_header": "/etc/yum.repos.d/kubernetes.repo (file attributes)", "after_header": "/etc/yum.repos.d/kubernetes.repo (file attributes)"}], "invocation": {"module_args": {"path": "/etc/yum.repos.d/kubernetes.repo", "regexp": "^exclude=", "line": "exclude=kubelet kubeadm kubectl cri-tools kubernetes-cni", "insertafter": "gpgkey=https://pkgs.k8s.io/core:/stable:/v1.30/rpm/repodata/repomd.xml.key", "state": "present", "backrefs": false, "create": false, "backup": false, "firstmatch": false, "unsafe_writes": false, "search_string": null, "insertbefore": null, "validate": null, "mode": null, "owner": null, "group": null, "seuser": null, "serole": null, "selevel": null, "setype": null, "attributes": null}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'rm -f -r /home/ec2-user/.ansible/tmp/ansible-tmp-1721489279.007526-327102-176630463547443/ > /dev/null 2>&1 && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
changed: [master] => {
    "backup": "",
    "changed": true,
    "diff": [
        {
            "after": "",
            "after_header": "/etc/yum.repos.d/kubernetes.repo (content)",
            "before": "",
            "before_header": "/etc/yum.repos.d/kubernetes.repo (content)"
        },
        {
            "after_header": "/etc/yum.repos.d/kubernetes.repo (file attributes)",
            "before_header": "/etc/yum.repos.d/kubernetes.repo (file attributes)"
        }
    ],
    "invocation": {
        "module_args": {
            "attributes": null,
            "backrefs": false,
            "backup": false,
            "create": false,
            "firstmatch": false,
            "group": null,
            "insertafter": "gpgkey=https://pkgs.k8s.io/core:/stable:/v1.30/rpm/repodata/repomd.xml.key",
            "insertbefore": null,
            "line": "exclude=kubelet kubeadm kubectl cri-tools kubernetes-cni",
            "mode": null,
            "owner": null,
            "path": "/etc/yum.repos.d/kubernetes.repo",
            "regexp": "^exclude=",
            "search_string": null,
            "selevel": null,
            "serole": null,
            "setype": null,
            "seuser": null,
            "state": "present",
            "unsafe_writes": false,
            "validate": null
        }
    },
    "msg": "line added"
}

TASK [Enable and start kubelet] ************************************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:175
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'echo ~ec2-user && sleep 0'"'"''
<10.0.1.171> (0, b'/home/ec2-user\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /home/ec2-user/.ansible/tmp `"&& mkdir "` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489279.9637191-327117-218836176300761 `" && echo ansible-tmp-1721489279.9637191-327117-218836176300761="` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489279.9637191-327117-218836176300761 `" ) && sleep 0'"'"''
<10.0.1.171> (0, b'ansible-tmp-1721489279.9637191-327117-218836176300761=/home/ec2-user/.ansible/tmp/ansible-tmp-1721489279.9637191-327117-218836176300761\n', b'')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/systemd.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmp216yyr6n TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489279.9637191-327117-218836176300761/AnsiballZ_systemd.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmp216yyr6n /home/ec2-user/.ansible/tmp/ansible-tmp-1721489279.9637191-327117-218836176300761/AnsiballZ_systemd.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489279.9637191-327117-218836176300761/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489279.9637191-327117-218836176300761/AnsiballZ_systemd.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-feencpagkgimwjgrtclldrybzyngrjpw ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489279.9637191-327117-218836176300761/AnsiballZ_systemd.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"name": "kubelet", "changed": true, "status": {"Type": "simple", "ExitType": "main", "Restart": "always", "NotifyAccess": "none", "RestartUSec": "10s", "TimeoutStartUSec": "1min 30s", "TimeoutStopUSec": "1min 30s", "TimeoutAbortUSec": "1min 30s", "TimeoutStartFailureMode": "terminate", "TimeoutStopFailureMode": "terminate", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "WatchdogUSec": "infinity", "WatchdogTimestampMonotonic": "0", "RootDirectoryStartOnly": "no", "RemainAfterExit": "no", "GuessMainPID": "yes", "MainPID": "0", "ControlPID": "0", "FileDescriptorStoreMax": "0", "NFileDescriptorStore": "0", "StatusErrno": "0", "Result": "success", "ReloadResult": "success", "CleanResult": "success", "UID": "[not set]", "GID": "[not set]", "NRestarts": "0", "OOMPolicy": "stop", "ExecMainStartTimestampMonotonic": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "0", "ExecMainCode": "0", "ExecMainStatus": "0", "ExecStart": "{ path=/usr/bin/kubelet ; argv[]=/usr/bin/kubelet $KUBELET_KUBECONFIG_ARGS $KUBELET_CONFIG_ARGS $KUBELET_KUBEADM_ARGS $KUBELET_EXTRA_ARGS ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/kubelet ; argv[]=/usr/bin/kubelet $KUBELET_KUBECONFIG_ARGS $KUBELET_CONFIG_ARGS $KUBELET_KUBEADM_ARGS $KUBELET_EXTRA_ARGS ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "Slice": "system.slice", "ControlGroupId": "0", "MemoryCurrent": "[not set]", "MemoryAvailable": "infinity", "CPUUsageNSec": "[not set]", "TasksCurrent": "[not set]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "Delegate": "no", "CPUAccounting": "yes", "CPUWeight": "[not set]", "StartupCPUWeight": "[not set]", "CPUShares": "[not set]", "StartupCPUShares": "[not set]", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "IOAccounting": "no", "IOWeight": "[not set]", "StartupIOWeight": "[not set]", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "StartupBlockIOWeight": "[not set]", "MemoryAccounting": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "MemoryMin": "0", "MemoryLow": "0", "MemoryHigh": "infinity", "MemoryMax": "infinity", "MemorySwapMax": "infinity", "MemoryLimit": "infinity", "DevicePolicy": "auto", "TasksAccounting": "yes", "TasksMax": "4567", "IPAccounting": "no", "ManagedOOMSwap": "auto", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "Environment": "\\"KUBELET_KUBECONFIG_ARGS=--bootstrap-kubeconfig=/etc/kubernetes/bootstrap-kubelet.conf --kubeconfig=/etc/kubernetes/kubelet.conf\\" KUBELET_CONFIG_ARGS=--config=/var/lib/kubelet/config.yaml", "EnvironmentFiles": "/etc/sysconfig/kubelet (ignore_errors=yes)", "UMask": "0022", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitSTACK": "10485760", "LimitSTACKSoft": "10485760", "LimitCORE": "infinity", "LimitCORESoft": "infinity", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitNOFILE": "65535", "LimitNOFILESoft": "65535", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitNPROC": "infinity", "LimitNPROCSoft": "infinity", "LimitMEMLOCK": "infinity", "LimitMEMLOCKSoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitSIGPENDING": "30446", "LimitSIGPENDINGSoft": "30446", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "OOMScoreAdjust": "0", "CoredumpFilter": "0x33", "Nice": "0", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUAffinityFromNUMA": "no", "NUMAPolicy": "n/a", "TimerSlackNSec": "50000", "CPUSchedulingResetOnFork": "no", "NonBlocking": "no", "StandardInput": "null", "StandardOutput": "journal", "StandardError": "inherit", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "SyslogPriority": "30", "SyslogLevelPrefix": "yes", "SyslogLevel": "6", "SyslogFacility": "3", "LogLevelMax": "-1", "LogRateLimitIntervalUSec": "0", "LogRateLimitBurst": "0", "SecureBits": "0", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "DynamicUser": "no", "RemoveIPC": "no", "PrivateTmp": "no", "PrivateDevices": "no", "ProtectClock": "no", "ProtectKernelTunables": "no", "ProtectKernelModules": "no", "ProtectKernelLogs": "no", "ProtectControlGroups": "no", "PrivateNetwork": "no", "PrivateUsers": "no", "PrivateMounts": "no", "PrivateIPC": "no", "ProtectHome": "no", "ProtectSystem": "no", "SameProcessGroup": "no", "UtmpMode": "init", "IgnoreSIGPIPE": "yes", "NoNewPrivileges": "no", "SystemCallErrorNumber": "2147483646", "LockPersonality": "no", "RuntimeDirectoryPreserve": "no", "RuntimeDirectoryMode": "0755", "StateDirectoryMode": "0755", "CacheDirectoryMode": "0755", "LogsDirectoryMode": "0755", "ConfigurationDirectoryMode": "0755", "TimeoutCleanUSec": "infinity", "MemoryDenyWriteExecute": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "RestrictNamespaces": "no", "MountAPIVFS": "no", "KeyringMode": "private", "ProtectProc": "default", "ProcSubset": "all", "ProtectHostname": "no", "KillMode": "control-group", "KillSignal": "15", "RestartKillSignal": "15", "FinalKillSignal": "9", "SendSIGKILL": "yes", "SendSIGHUP": "no", "WatchdogSignal": "6", "Id": "kubelet.service", "Names": "kubelet.service", "Requires": "system.slice sysinit.target", "Wants": "network-online.target", "Conflicts": "shutdown.target", "Before": "shutdown.target", "After": "system.slice network-online.target systemd-journald.socket sysinit.target basic.target", "Documentation": "https://kubernetes.io/docs/", "Description": "kubelet: The Kubernetes Node Agent", "AccessSELinuxContext": "system_u:object_r:systemd_unit_file_t:s0", "LoadState": "loaded", "ActiveState": "inactive", "FreezerState": "running", "SubState": "dead", "FragmentPath": "/usr/lib/systemd/system/kubelet.service", "DropInPaths": "/usr/lib/systemd/system/kubelet.service.d/10-kubeadm.conf", "UnitFileState": "disabled", "UnitFilePreset": "disabled", "StateChangeTimestampMonotonic": "0", "InactiveExitTimestampMonotonic": "0", "ActiveEnterTimestampMonotonic": "0", "ActiveExitTimestampMonotonic": "0", "InactiveEnterTimestampMonotonic": "0", "CanStart": "yes", "CanStop": "yes", "CanReload": "no", "CanIsolate": "no", "CanFreeze": "yes", "StopWhenUnneeded": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "AllowIsolate": "no", "DefaultDependencies": "yes", "OnSuccessJobMode": "fail", "OnFailureJobMode": "replace", "IgnoreOnIsolate": "no", "NeedDaemonReload": "no", "JobTimeoutUSec": "infinity", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "ConditionResult": "no", "AssertResult": "no", "ConditionTimestampMonotonic": "0", "AssertTimestampMonotonic": "0", "Transient": "no", "Perpetual": "no", "StartLimitIntervalUSec": "0", "StartLimitBurst": "5", "StartLimitAction": "none", "FailureAction": "none", "SuccessAction": "none", "CollectMode": "inactive"}, "enabled": true, "invocation": {"module_args": {"name": "kubelet", "enabled": true, "daemon_reload": false, "daemon_reexec": false, "scope": "system", "no_block": false, "state": null, "force": null, "masked": null}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'rm -f -r /home/ec2-user/.ansible/tmp/ansible-tmp-1721489279.9637191-327117-218836176300761/ > /dev/null 2>&1 && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
changed: [master] => {
    "changed": true,
    "enabled": true,
    "invocation": {
        "module_args": {
            "daemon_reexec": false,
            "daemon_reload": false,
            "enabled": true,
            "force": null,
            "masked": null,
            "name": "kubelet",
            "no_block": false,
            "scope": "system",
            "state": null
        }
    },
    "name": "kubelet",
    "status": {
        "AccessSELinuxContext": "system_u:object_r:systemd_unit_file_t:s0",
        "ActiveEnterTimestampMonotonic": "0",
        "ActiveExitTimestampMonotonic": "0",
        "ActiveState": "inactive",
        "After": "system.slice network-online.target systemd-journald.socket sysinit.target basic.target",
        "AllowIsolate": "no",
        "AssertResult": "no",
        "AssertTimestampMonotonic": "0",
        "Before": "shutdown.target",
        "BlockIOAccounting": "no",
        "BlockIOWeight": "[not set]",
        "CPUAccounting": "yes",
        "CPUAffinityFromNUMA": "no",
        "CPUQuotaPerSecUSec": "infinity",
        "CPUQuotaPeriodUSec": "infinity",
        "CPUSchedulingPolicy": "0",
        "CPUSchedulingPriority": "0",
        "CPUSchedulingResetOnFork": "no",
        "CPUShares": "[not set]",
        "CPUUsageNSec": "[not set]",
        "CPUWeight": "[not set]",
        "CacheDirectoryMode": "0755",
        "CanFreeze": "yes",
        "CanIsolate": "no",
        "CanReload": "no",
        "CanStart": "yes",
        "CanStop": "yes",
        "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore",
        "CleanResult": "success",
        "CollectMode": "inactive",
        "ConditionResult": "no",
        "ConditionTimestampMonotonic": "0",
        "ConfigurationDirectoryMode": "0755",
        "Conflicts": "shutdown.target",
        "ControlGroupId": "0",
        "ControlPID": "0",
        "CoredumpFilter": "0x33",
        "DefaultDependencies": "yes",
        "DefaultMemoryLow": "0",
        "DefaultMemoryMin": "0",
        "Delegate": "no",
        "Description": "kubelet: The Kubernetes Node Agent",
        "DevicePolicy": "auto",
        "Documentation": "https://kubernetes.io/docs/",
        "DropInPaths": "/usr/lib/systemd/system/kubelet.service.d/10-kubeadm.conf",
        "DynamicUser": "no",
        "Environment": "\"KUBELET_KUBECONFIG_ARGS=--bootstrap-kubeconfig=/etc/kubernetes/bootstrap-kubelet.conf --kubeconfig=/etc/kubernetes/kubelet.conf\" KUBELET_CONFIG_ARGS=--config=/var/lib/kubelet/config.yaml",
        "EnvironmentFiles": "/etc/sysconfig/kubelet (ignore_errors=yes)",
        "ExecMainCode": "0",
        "ExecMainExitTimestampMonotonic": "0",
        "ExecMainPID": "0",
        "ExecMainStartTimestampMonotonic": "0",
        "ExecMainStatus": "0",
        "ExecStart": "{ path=/usr/bin/kubelet ; argv[]=/usr/bin/kubelet $KUBELET_KUBECONFIG_ARGS $KUBELET_CONFIG_ARGS $KUBELET_KUBEADM_ARGS $KUBELET_EXTRA_ARGS ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }",
        "ExecStartEx": "{ path=/usr/bin/kubelet ; argv[]=/usr/bin/kubelet $KUBELET_KUBECONFIG_ARGS $KUBELET_CONFIG_ARGS $KUBELET_KUBEADM_ARGS $KUBELET_EXTRA_ARGS ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }",
        "ExitType": "main",
        "FailureAction": "none",
        "FileDescriptorStoreMax": "0",
        "FinalKillSignal": "9",
        "FragmentPath": "/usr/lib/systemd/system/kubelet.service",
        "FreezerState": "running",
        "GID": "[not set]",
        "GuessMainPID": "yes",
        "IOAccounting": "no",
        "IOReadBytes": "18446744073709551615",
        "IOReadOperations": "18446744073709551615",
        "IOSchedulingClass": "2",
        "IOSchedulingPriority": "4",
        "IOWeight": "[not set]",
        "IOWriteBytes": "18446744073709551615",
        "IOWriteOperations": "18446744073709551615",
        "IPAccounting": "no",
        "IPEgressBytes": "[no data]",
        "IPEgressPackets": "[no data]",
        "IPIngressBytes": "[no data]",
        "IPIngressPackets": "[no data]",
        "Id": "kubelet.service",
        "IgnoreOnIsolate": "no",
        "IgnoreSIGPIPE": "yes",
        "InactiveEnterTimestampMonotonic": "0",
        "InactiveExitTimestampMonotonic": "0",
        "JobRunningTimeoutUSec": "infinity",
        "JobTimeoutAction": "none",
        "JobTimeoutUSec": "infinity",
        "KeyringMode": "private",
        "KillMode": "control-group",
        "KillSignal": "15",
        "LimitAS": "infinity",
        "LimitASSoft": "infinity",
        "LimitCORE": "infinity",
        "LimitCORESoft": "infinity",
        "LimitCPU": "infinity",
        "LimitCPUSoft": "infinity",
        "LimitDATA": "infinity",
        "LimitDATASoft": "infinity",
        "LimitFSIZE": "infinity",
        "LimitFSIZESoft": "infinity",
        "LimitLOCKS": "infinity",
        "LimitLOCKSSoft": "infinity",
        "LimitMEMLOCK": "infinity",
        "LimitMEMLOCKSoft": "infinity",
        "LimitMSGQUEUE": "819200",
        "LimitMSGQUEUESoft": "819200",
        "LimitNICE": "0",
        "LimitNICESoft": "0",
        "LimitNOFILE": "65535",
        "LimitNOFILESoft": "65535",
        "LimitNPROC": "infinity",
        "LimitNPROCSoft": "infinity",
        "LimitRSS": "infinity",
        "LimitRSSSoft": "infinity",
        "LimitRTPRIO": "0",
        "LimitRTPRIOSoft": "0",
        "LimitRTTIME": "infinity",
        "LimitRTTIMESoft": "infinity",
        "LimitSIGPENDING": "30446",
        "LimitSIGPENDINGSoft": "30446",
        "LimitSTACK": "10485760",
        "LimitSTACKSoft": "10485760",
        "LoadState": "loaded",
        "LockPersonality": "no",
        "LogLevelMax": "-1",
        "LogRateLimitBurst": "0",
        "LogRateLimitIntervalUSec": "0",
        "LogsDirectoryMode": "0755",
        "MainPID": "0",
        "ManagedOOMMemoryPressure": "auto",
        "ManagedOOMMemoryPressureLimit": "0",
        "ManagedOOMPreference": "none",
        "ManagedOOMSwap": "auto",
        "MemoryAccounting": "yes",
        "MemoryAvailable": "infinity",
        "MemoryCurrent": "[not set]",
        "MemoryDenyWriteExecute": "no",
        "MemoryHigh": "infinity",
        "MemoryLimit": "infinity",
        "MemoryLow": "0",
        "MemoryMax": "infinity",
        "MemoryMin": "0",
        "MemorySwapMax": "infinity",
        "MountAPIVFS": "no",
        "NFileDescriptorStore": "0",
        "NRestarts": "0",
        "NUMAPolicy": "n/a",
        "Names": "kubelet.service",
        "NeedDaemonReload": "no",
        "Nice": "0",
        "NoNewPrivileges": "no",
        "NonBlocking": "no",
        "NotifyAccess": "none",
        "OOMPolicy": "stop",
        "OOMScoreAdjust": "0",
        "OnFailureJobMode": "replace",
        "OnSuccessJobMode": "fail",
        "Perpetual": "no",
        "PrivateDevices": "no",
        "PrivateIPC": "no",
        "PrivateMounts": "no",
        "PrivateNetwork": "no",
        "PrivateTmp": "no",
        "PrivateUsers": "no",
        "ProcSubset": "all",
        "ProtectClock": "no",
        "ProtectControlGroups": "no",
        "ProtectHome": "no",
        "ProtectHostname": "no",
        "ProtectKernelLogs": "no",
        "ProtectKernelModules": "no",
        "ProtectKernelTunables": "no",
        "ProtectProc": "default",
        "ProtectSystem": "no",
        "RefuseManualStart": "no",
        "RefuseManualStop": "no",
        "ReloadResult": "success",
        "RemainAfterExit": "no",
        "RemoveIPC": "no",
        "Requires": "system.slice sysinit.target",
        "Restart": "always",
        "RestartKillSignal": "15",
        "RestartUSec": "10s",
        "RestrictNamespaces": "no",
        "RestrictRealtime": "no",
        "RestrictSUIDSGID": "no",
        "Result": "success",
        "RootDirectoryStartOnly": "no",
        "RuntimeDirectoryMode": "0755",
        "RuntimeDirectoryPreserve": "no",
        "RuntimeMaxUSec": "infinity",
        "RuntimeRandomizedExtraUSec": "0",
        "SameProcessGroup": "no",
        "SecureBits": "0",
        "SendSIGHUP": "no",
        "SendSIGKILL": "yes",
        "Slice": "system.slice",
        "StandardError": "inherit",
        "StandardInput": "null",
        "StandardOutput": "journal",
        "StartLimitAction": "none",
        "StartLimitBurst": "5",
        "StartLimitIntervalUSec": "0",
        "StartupBlockIOWeight": "[not set]",
        "StartupCPUShares": "[not set]",
        "StartupCPUWeight": "[not set]",
        "StartupIOWeight": "[not set]",
        "StateChangeTimestampMonotonic": "0",
        "StateDirectoryMode": "0755",
        "StatusErrno": "0",
        "StopWhenUnneeded": "no",
        "SubState": "dead",
        "SuccessAction": "none",
        "SyslogFacility": "3",
        "SyslogLevel": "6",
        "SyslogLevelPrefix": "yes",
        "SyslogPriority": "30",
        "SystemCallErrorNumber": "2147483646",
        "TTYReset": "no",
        "TTYVHangup": "no",
        "TTYVTDisallocate": "no",
        "TasksAccounting": "yes",
        "TasksCurrent": "[not set]",
        "TasksMax": "4567",
        "TimeoutAbortUSec": "1min 30s",
        "TimeoutCleanUSec": "infinity",
        "TimeoutStartFailureMode": "terminate",
        "TimeoutStartUSec": "1min 30s",
        "TimeoutStopFailureMode": "terminate",
        "TimeoutStopUSec": "1min 30s",
        "TimerSlackNSec": "50000",
        "Transient": "no",
        "Type": "simple",
        "UID": "[not set]",
        "UMask": "0022",
        "UnitFilePreset": "disabled",
        "UnitFileState": "disabled",
        "UtmpMode": "init",
        "Wants": "network-online.target",
        "WatchdogSignal": "6",
        "WatchdogTimestampMonotonic": "0",
        "WatchdogUSec": "infinity"
    }
}

TASK [Install iproute-tc package] **********************************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:180
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'echo ~ec2-user && sleep 0'"'"''
<10.0.1.171> (0, b'/home/ec2-user\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /home/ec2-user/.ansible/tmp `"&& mkdir "` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489281.585832-327132-85708603637040 `" && echo ansible-tmp-1721489281.585832-327132-85708603637040="` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489281.585832-327132-85708603637040 `" ) && sleep 0'"'"''
<10.0.1.171> (0, b'ansible-tmp-1721489281.585832-327132-85708603637040=/home/ec2-user/.ansible/tmp/ansible-tmp-1721489281.585832-327132-85708603637040\n', b'')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/dnf.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmp5imnl9mv TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489281.585832-327132-85708603637040/AnsiballZ_dnf.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmp5imnl9mv /home/ec2-user/.ansible/tmp/ansible-tmp-1721489281.585832-327132-85708603637040/AnsiballZ_dnf.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489281.585832-327132-85708603637040/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489281.585832-327132-85708603637040/AnsiballZ_dnf.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-pqngrxyugahufhxpllhhuoapcxymekaa ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489281.585832-327132-85708603637040/AnsiballZ_dnf.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"msg": "", "changed": true, "results": ["Installed: iproute-tc-5.10.0-2.amzn2023.0.5.x86_64"], "rc": 0, "invocation": {"module_args": {"name": ["iproute-tc"], "state": "present", "allow_downgrade": false, "autoremove": false, "bugfix": false, "cacheonly": false, "disable_gpg_check": false, "disable_plugin": [], "disablerepo": [], "download_only": false, "enable_plugin": [], "enablerepo": [], "exclude": [], "installroot": "/", "install_repoquery": true, "install_weak_deps": true, "security": false, "skip_broken": false, "update_cache": false, "update_only": false, "validate_certs": true, "sslverify": true, "lock_timeout": 30, "allowerasing": false, "nobest": false, "use_backend": "auto", "conf_file": null, "disable_excludes": null, "download_dir": null, "list": null, "releasever": null}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'rm -f -r /home/ec2-user/.ansible/tmp/ansible-tmp-1721489281.585832-327132-85708603637040/ > /dev/null 2>&1 && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
changed: [master] => {
    "changed": true,
    "invocation": {
        "module_args": {
            "allow_downgrade": false,
            "allowerasing": false,
            "autoremove": false,
            "bugfix": false,
            "cacheonly": false,
            "conf_file": null,
            "disable_excludes": null,
            "disable_gpg_check": false,
            "disable_plugin": [],
            "disablerepo": [],
            "download_dir": null,
            "download_only": false,
            "enable_plugin": [],
            "enablerepo": [],
            "exclude": [],
            "install_repoquery": true,
            "install_weak_deps": true,
            "installroot": "/",
            "list": null,
            "lock_timeout": 30,
            "name": [
                "iproute-tc"
            ],
            "nobest": false,
            "releasever": null,
            "security": false,
            "skip_broken": false,
            "sslverify": true,
            "state": "present",
            "update_cache": false,
            "update_only": false,
            "use_backend": "auto",
            "validate_certs": true
        }
    },
    "msg": "",
    "rc": 0,
    "results": [
        "Installed: iproute-tc-5.10.0-2.amzn2023.0.5.x86_64"
    ]
}

TASK [Ensure the hostname is resolvable] ***************************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:185
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'echo ~ec2-user && sleep 0'"'"''
<10.0.1.171> (0, b'/home/ec2-user\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /home/ec2-user/.ansible/tmp `"&& mkdir "` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489284.1968148-327177-87504492325748 `" && echo ansible-tmp-1721489284.1968148-327177-87504492325748="` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489284.1968148-327177-87504492325748 `" ) && sleep 0'"'"''
<10.0.1.171> (0, b'ansible-tmp-1721489284.1968148-327177-87504492325748=/home/ec2-user/.ansible/tmp/ansible-tmp-1721489284.1968148-327177-87504492325748\n', b'')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/lineinfile.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpdrnkqwbb TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489284.1968148-327177-87504492325748/AnsiballZ_lineinfile.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpdrnkqwbb /home/ec2-user/.ansible/tmp/ansible-tmp-1721489284.1968148-327177-87504492325748/AnsiballZ_lineinfile.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489284.1968148-327177-87504492325748/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489284.1968148-327177-87504492325748/AnsiballZ_lineinfile.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-eyzquhndqlmsnbuuhzatbiqtehcutooc ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489284.1968148-327177-87504492325748/AnsiballZ_lineinfile.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"changed": true, "msg": "line added", "backup": "", "diff": [{"before": "", "after": "", "before_header": "/etc/hosts (content)", "after_header": "/etc/hosts (content)"}, {"before_header": "/etc/hosts (file attributes)", "after_header": "/etc/hosts (file attributes)"}], "invocation": {"module_args": {"path": "/etc/hosts", "line": "10.0.1.171 master", "state": "present", "backrefs": false, "create": false, "backup": false, "firstmatch": false, "unsafe_writes": false, "regexp": null, "search_string": null, "insertafter": null, "insertbefore": null, "validate": null, "mode": null, "owner": null, "group": null, "seuser": null, "serole": null, "selevel": null, "setype": null, "attributes": null}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'rm -f -r /home/ec2-user/.ansible/tmp/ansible-tmp-1721489284.1968148-327177-87504492325748/ > /dev/null 2>&1 && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
changed: [master] => {
    "backup": "",
    "changed": true,
    "diff": [
        {
            "after": "",
            "after_header": "/etc/hosts (content)",
            "before": "",
            "before_header": "/etc/hosts (content)"
        },
        {
            "after_header": "/etc/hosts (file attributes)",
            "before_header": "/etc/hosts (file attributes)"
        }
    ],
    "invocation": {
        "module_args": {
            "attributes": null,
            "backrefs": false,
            "backup": false,
            "create": false,
            "firstmatch": false,
            "group": null,
            "insertafter": null,
            "insertbefore": null,
            "line": "10.0.1.171 master",
            "mode": null,
            "owner": null,
            "path": "/etc/hosts",
            "regexp": null,
            "search_string": null,
            "selevel": null,
            "serole": null,
            "setype": null,
            "seuser": null,
            "state": "present",
            "unsafe_writes": false,
            "validate": null
        }
    },
    "msg": "line added"
}

TASK [Pre-pull Kubernetes images] **********************************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:190
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'echo ~ec2-user && sleep 0'"'"''
<10.0.1.171> (0, b'/home/ec2-user\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /home/ec2-user/.ansible/tmp `"&& mkdir "` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489284.9871926-327186-124318747197678 `" && echo ansible-tmp-1721489284.9871926-327186-124318747197678="` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489284.9871926-327186-124318747197678 `" ) && sleep 0'"'"''
<10.0.1.171> (0, b'ansible-tmp-1721489284.9871926-327186-124318747197678=/home/ec2-user/.ansible/tmp/ansible-tmp-1721489284.9871926-327186-124318747197678\n', b'')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/command.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpl8toye_p TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489284.9871926-327186-124318747197678/AnsiballZ_command.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpl8toye_p /home/ec2-user/.ansible/tmp/ansible-tmp-1721489284.9871926-327186-124318747197678/AnsiballZ_command.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489284.9871926-327186-124318747197678/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489284.9871926-327186-124318747197678/AnsiballZ_command.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-bqidllpwqtcdbckeqhwiqqjvqgtoespn ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489284.9871926-327186-124318747197678/AnsiballZ_command.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"changed": true, "stdout": "[config/images] Pulled registry.k8s.io/kube-apiserver:v1.30.2\\n[config/images] Pulled registry.k8s.io/kube-controller-manager:v1.30.2\\n[config/images] Pulled registry.k8s.io/kube-scheduler:v1.30.2\\n[config/images] Pulled registry.k8s.io/kube-proxy:v1.30.2\\n[config/images] Pulled registry.k8s.io/coredns/coredns:v1.11.1\\n[config/images] Pulled registry.k8s.io/pause:3.9\\n[config/images] Pulled registry.k8s.io/etcd:3.5.12-0", "stderr": "", "rc": 0, "cmd": ["kubeadm", "config", "images", "pull", "--kubernetes-version", "v1.30.2"], "start": "2024-07-20 15:28:05.575538", "end": "2024-07-20 15:28:26.303087", "delta": "0:00:20.727549", "msg": "", "invocation": {"module_args": {"_raw_params": "kubeadm config images pull --kubernetes-version v1.30.2", "_uses_shell": false, "stdin_add_newline": true, "strip_empty_ends": true, "argv": null, "chdir": null, "executable": null, "creates": null, "removes": null, "stdin": null}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'rm -f -r /home/ec2-user/.ansible/tmp/ansible-tmp-1721489284.9871926-327186-124318747197678/ > /dev/null 2>&1 && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
changed: [master] => {
    "changed": true,
    "cmd": [
        "kubeadm",
        "config",
        "images",
        "pull",
        "--kubernetes-version",
        "v1.30.2"
    ],
    "delta": "0:00:20.727549",
    "end": "2024-07-20 15:28:26.303087",
    "invocation": {
        "module_args": {
            "_raw_params": "kubeadm config images pull --kubernetes-version v1.30.2",
            "_uses_shell": false,
            "argv": null,
            "chdir": null,
            "creates": null,
            "executable": null,
            "removes": null,
            "stdin": null,
            "stdin_add_newline": true,
            "strip_empty_ends": true
        }
    },
    "msg": "",
    "rc": 0,
    "start": "2024-07-20 15:28:05.575538",
    "stderr": "",
    "stderr_lines": [],
    "stdout": "[config/images] Pulled registry.k8s.io/kube-apiserver:v1.30.2\n[config/images] Pulled registry.k8s.io/kube-controller-manager:v1.30.2\n[config/images] Pulled registry.k8s.io/kube-scheduler:v1.30.2\n[config/images] Pulled registry.k8s.io/kube-proxy:v1.30.2\n[config/images] Pulled registry.k8s.io/coredns/coredns:v1.11.1\n[config/images] Pulled registry.k8s.io/pause:3.9\n[config/images] Pulled registry.k8s.io/etcd:3.5.12-0",
    "stdout_lines": [
        "[config/images] Pulled registry.k8s.io/kube-apiserver:v1.30.2",
        "[config/images] Pulled registry.k8s.io/kube-controller-manager:v1.30.2",
        "[config/images] Pulled registry.k8s.io/kube-scheduler:v1.30.2",
        "[config/images] Pulled registry.k8s.io/kube-proxy:v1.30.2",
        "[config/images] Pulled registry.k8s.io/coredns/coredns:v1.11.1",
        "[config/images] Pulled registry.k8s.io/pause:3.9",
        "[config/images] Pulled registry.k8s.io/etcd:3.5.12-0"
    ]
}

TASK [Initialize Kubernetes cluster] *******************************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:194
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'echo ~ec2-user && sleep 0'"'"''
<10.0.1.171> (0, b'/home/ec2-user\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /home/ec2-user/.ansible/tmp `"&& mkdir "` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489306.4790943-327326-29205235661848 `" && echo ansible-tmp-1721489306.4790943-327326-29205235661848="` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489306.4790943-327326-29205235661848 `" ) && sleep 0'"'"''
<10.0.1.171> (0, b'ansible-tmp-1721489306.4790943-327326-29205235661848=/home/ec2-user/.ansible/tmp/ansible-tmp-1721489306.4790943-327326-29205235661848\n', b'')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/command.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpga8lq5zj TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489306.4790943-327326-29205235661848/AnsiballZ_command.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpga8lq5zj /home/ec2-user/.ansible/tmp/ansible-tmp-1721489306.4790943-327326-29205235661848/AnsiballZ_command.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489306.4790943-327326-29205235661848/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489306.4790943-327326-29205235661848/AnsiballZ_command.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-gqxfrnzxlwbsebzbrbayyyueqtibwosz ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489306.4790943-327326-29205235661848/AnsiballZ_command.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"changed": true, "stdout": "[init] Using Kubernetes version: v1.30.2\\n[preflight] Running pre-flight checks\\n[preflight] Pulling images required for setting up a Kubernetes cluster\\n[preflight] This might take a minute or two, depending on the speed of your internet connection\\n[preflight] You can also perform this action in beforehand using \'kubeadm config images pull\'\\n[certs] Using certificateDir folder \\"/etc/kubernetes/pki\\"\\n[certs] Generating \\"ca\\" certificate and key\\n[certs] Generating \\"apiserver\\" certificate and key\\n[certs] apiserver serving cert is signed for DNS names [kubernetes kubernetes.default kubernetes.default.svc kubernetes.default.svc.cluster.local master] and IPs [10.96.0.1 10.0.1.171 51.21.53.50]\\n[certs] Generating \\"apiserver-kubelet-client\\" certificate and key\\n[certs] Generating \\"front-proxy-ca\\" certificate and key\\n[certs] Generating \\"front-proxy-client\\" certificate and key\\n[certs] Generating \\"etcd/ca\\" certificate and key\\n[certs] Generating \\"etcd/server\\" certificate and key\\n[certs] etcd/server serving cert is signed for DNS names [localhost master] and IPs [10.0.1.171 127.0.0.1 ::1]\\n[certs] Generating \\"etcd/peer\\" certificate and key\\n[certs] etcd/peer serving cert is signed for DNS names [localhost master] and IPs [10.0.1.171 127.0.0.1 ::1]\\n[certs] Generating \\"etcd/healthcheck-client\\" certificate and key\\n[certs] Generating \\"apiserver-etcd-client\\" certificate and key\\n[certs] Generating \\"sa\\" key and public key\\n[kubeconfig] Using kubeconfig folder \\"/etc/kubernetes\\"\\n[kubeconfig] Writing \\"admin.conf\\" kubeconfig file\\n[kubeconfig] Writing \\"super-admin.conf\\" kubeconfig file\\n[kubeconfig] Writing \\"kubelet.conf\\" kubeconfig file\\n[kubeconfig] Writing \\"controller-manager.conf\\" kubeconfig file\\n[kubeconfig] Writing \\"scheduler.conf\\" kubeconfig file\\n[etcd] Creating static Pod manifest for local etcd in \\"/etc/kubernetes/manifests\\"\\n[control-plane] Using manifest folder \\"/etc/kubernetes/manifests\\"\\n[control-plane] Creating static Pod manifest for \\"kube-apiserver\\"\\n[control-plane] Creating static Pod manifest for \\"kube-controller-manager\\"\\n[control-plane] Creating static Pod manifest for \\"kube-scheduler\\"\\n[kubelet-start] Writing kubelet environment file with flags to file \\"/var/lib/kubelet/kubeadm-flags.env\\"\\n[kubelet-start] Writing kubelet configuration to file \\"/var/lib/kubelet/config.yaml\\"\\n[kubelet-start] Starting the kubelet\\n[wait-control-plane] Waiting for the kubelet to boot up the control plane as static Pods from directory \\"/etc/kubernetes/manifests\\"\\n[kubelet-check] Waiting for a healthy kubelet. This can take up to 4m0s\\n[kubelet-check] The kubelet is healthy after 1.001814058s\\n[api-check] Waiting for a healthy API server. This can take up to 4m0s\\n[api-check] The API server is healthy after 7.002152216s\\n[upload-config] Storing the configuration used in ConfigMap \\"kubeadm-config\\" in the \\"kube-system\\" Namespace\\n[kubelet] Creating a ConfigMap \\"kubelet-config\\" in namespace kube-system with the configuration for the kubelets in the cluster\\n[upload-certs] Skipping phase. Please see --upload-certs\\n[mark-control-plane] Marking the node master as control-plane by adding the labels: [node-role.kubernetes.io/control-plane node.kubernetes.io/exclude-from-external-load-balancers]\\n[mark-control-plane] Marking the node master as control-plane by adding the taints [node-role.kubernetes.io/control-plane:NoSchedule]\\n[bootstrap-token] Using token: 9pvavp.07xu7xczwy3puzft\\n[bootstrap-token] Configuring bootstrap tokens, cluster-info ConfigMap, RBAC Roles\\n[bootstrap-token] Configured RBAC rules to allow Node Bootstrap tokens to get nodes\\n[bootstrap-token] Configured RBAC rules to allow Node Bootstrap tokens to post CSRs in order for nodes to get long term certificate credentials\\n[bootstrap-token] Configured RBAC rules to allow the csrapprover controller automatically approve CSRs from a Node Bootstrap Token\\n[bootstrap-token] Configured RBAC rules to allow certificate rotation for all node client certificates in the cluster\\n[bootstrap-token] Creating the \\"cluster-info\\" ConfigMap in the \\"kube-public\\" namespace\\n[kubelet-finalize] Updating \\"/etc/kubernetes/kubelet.conf\\" to point to a rotatable kubelet client certificate and key\\n[addons] Applied essential addon: CoreDNS\\n[addons] Applied essential addon: kube-proxy\\n\\nYour Kubernetes control-plane has initialized successfully!\\n\\nTo start using your cluster, you need to run the following as a regular user:\\n\\n  mkdir -p $HOME/.kube\\n  sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config\\n  sudo chown $(id -u):$(id -g) $HOME/.kube/config\\n\\nAlternatively, if you are the root user, you can run:\\n\\n  export KUBECONFIG=/etc/kubernetes/admin.conf\\n\\nYou should now deploy a pod network to the cluster.\\nRun \\"kubectl apply -f [podnetwork].yaml\\" with one of the options listed at:\\n  https://kubernetes.io/docs/concepts/cluster-administration/addons/\\n\\nYou can now join any number of control-plane nodes by copying certificate authorities\\nand service account keys on each node and then running the following as root:\\n\\n  kubeadm join 51.21.53.50:6443 --token 9pvavp.07xu7xczwy3puzft \\\\\\n\\t--discovery-token-ca-cert-hash sha256:546a40835f91622263b6b632ae0bc320f3b551edbdfdbd56a78280ffc23f2745 \\\\\\n\\t--control-plane \\n\\nThen you can join any number of worker nodes by running the following on each as root:\\n\\nkubeadm join 51.21.53.50:6443 --token 9pvavp.07xu7xczwy3puzft \\\\\\n\\t--discovery-token-ca-cert-hash sha256:546a40835f91622263b6b632ae0bc320f3b551edbdfdbd56a78280ffc23f2745 ", "stderr": "W0720 15:28:27.233347   29541 checks.go:844] detected that the sandbox image \\"registry.k8s.io/pause:3.2\\" of the container runtime is inconsistent with that used by kubeadm.It is recommended to use \\"registry.k8s.io/pause:3.9\\" as the CRI sandbox image.", "rc": 0, "cmd": ["kubeadm", "init", "--control-plane-endpoint=51.21.53.50", "--apiserver-cert-extra-sans=51.21.53.50", "--pod-network-cidr=10.244.0.0/16", "--node-name", "master", "--ignore-preflight-errors=Swap,ImagePull", "--kubernetes-version", "v1.30.2"], "start": "2024-07-20 15:28:26.930289", "end": "2024-07-20 15:28:41.676716", "delta": "0:00:14.746427", "msg": "", "invocation": {"module_args": {"_raw_params": "kubeadm init --control-plane-endpoint=\\"51.21.53.50\\" --apiserver-cert-extra-sans=\\"51.21.53.50\\" --pod-network-cidr=\\"10.244.0.0/16\\" --node-name \\"master\\" --ignore-preflight-errors=Swap,ImagePull --kubernetes-version v1.30.2", "_uses_shell": false, "stdin_add_newline": true, "strip_empty_ends": true, "argv": null, "chdir": null, "executable": null, "creates": null, "removes": null, "stdin": null}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'rm -f -r /home/ec2-user/.ansible/tmp/ansible-tmp-1721489306.4790943-327326-29205235661848/ > /dev/null 2>&1 && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
changed: [master] => {
    "changed": true,
    "cmd": [
        "kubeadm",
        "init",
        "--control-plane-endpoint=51.21.53.50",
        "--apiserver-cert-extra-sans=51.21.53.50",
        "--pod-network-cidr=10.244.0.0/16",
        "--node-name",
        "master",
        "--ignore-preflight-errors=Swap,ImagePull",
        "--kubernetes-version",
        "v1.30.2"
    ],
    "delta": "0:00:14.746427",
    "end": "2024-07-20 15:28:41.676716",
    "invocation": {
        "module_args": {
            "_raw_params": "kubeadm init --control-plane-endpoint=\"51.21.53.50\" --apiserver-cert-extra-sans=\"51.21.53.50\" --pod-network-cidr=\"10.244.0.0/16\" --node-name \"master\" --ignore-preflight-errors=Swap,ImagePull --kubernetes-version v1.30.2",
            "_uses_shell": false,
            "argv": null,
            "chdir": null,
            "creates": null,
            "executable": null,
            "removes": null,
            "stdin": null,
            "stdin_add_newline": true,
            "strip_empty_ends": true
        }
    },
    "msg": "",
    "rc": 0,
    "start": "2024-07-20 15:28:26.930289",
    "stderr": "W0720 15:28:27.233347   29541 checks.go:844] detected that the sandbox image \"registry.k8s.io/pause:3.2\" of the container runtime is inconsistent with that used by kubeadm.It is recommended to use \"registry.k8s.io/pause:3.9\" as the CRI sandbox image.",
    "stderr_lines": [
        "W0720 15:28:27.233347   29541 checks.go:844] detected that the sandbox image \"registry.k8s.io/pause:3.2\" of the container runtime is inconsistent with that used by kubeadm.It is recommended to use \"registry.k8s.io/pause:3.9\" as the CRI sandbox image."
    ],
    "stdout": "[init] Using Kubernetes version: v1.30.2\n[preflight] Running pre-flight checks\n[preflight] Pulling images required for setting up a Kubernetes cluster\n[preflight] This might take a minute or two, depending on the speed of your internet connection\n[preflight] You can also perform this action in beforehand using 'kubeadm config images pull'\n[certs] Using certificateDir folder \"/etc/kubernetes/pki\"\n[certs] Generating \"ca\" certificate and key\n[certs] Generating \"apiserver\" certificate and key\n[certs] apiserver serving cert is signed for DNS names [kubernetes kubernetes.default kubernetes.default.svc kubernetes.default.svc.cluster.local master] and IPs [10.96.0.1 10.0.1.171 51.21.53.50]\n[certs] Generating \"apiserver-kubelet-client\" certificate and key\n[certs] Generating \"front-proxy-ca\" certificate and key\n[certs] Generating \"front-proxy-client\" certificate and key\n[certs] Generating \"etcd/ca\" certificate and key\n[certs] Generating \"etcd/server\" certificate and key\n[certs] etcd/server serving cert is signed for DNS names [localhost master] and IPs [10.0.1.171 127.0.0.1 ::1]\n[certs] Generating \"etcd/peer\" certificate and key\n[certs] etcd/peer serving cert is signed for DNS names [localhost master] and IPs [10.0.1.171 127.0.0.1 ::1]\n[certs] Generating \"etcd/healthcheck-client\" certificate and key\n[certs] Generating \"apiserver-etcd-client\" certificate and key\n[certs] Generating \"sa\" key and public key\n[kubeconfig] Using kubeconfig folder \"/etc/kubernetes\"\n[kubeconfig] Writing \"admin.conf\" kubeconfig file\n[kubeconfig] Writing \"super-admin.conf\" kubeconfig file\n[kubeconfig] Writing \"kubelet.conf\" kubeconfig file\n[kubeconfig] Writing \"controller-manager.conf\" kubeconfig file\n[kubeconfig] Writing \"scheduler.conf\" kubeconfig file\n[etcd] Creating static Pod manifest for local etcd in \"/etc/kubernetes/manifests\"\n[control-plane] Using manifest folder \"/etc/kubernetes/manifests\"\n[control-plane] Creating static Pod manifest for \"kube-apiserver\"\n[control-plane] Creating static Pod manifest for \"kube-controller-manager\"\n[control-plane] Creating static Pod manifest for \"kube-scheduler\"\n[kubelet-start] Writing kubelet environment file with flags to file \"/var/lib/kubelet/kubeadm-flags.env\"\n[kubelet-start] Writing kubelet configuration to file \"/var/lib/kubelet/config.yaml\"\n[kubelet-start] Starting the kubelet\n[wait-control-plane] Waiting for the kubelet to boot up the control plane as static Pods from directory \"/etc/kubernetes/manifests\"\n[kubelet-check] Waiting for a healthy kubelet. This can take up to 4m0s\n[kubelet-check] The kubelet is healthy after 1.001814058s\n[api-check] Waiting for a healthy API server. This can take up to 4m0s\n[api-check] The API server is healthy after 7.002152216s\n[upload-config] Storing the configuration used in ConfigMap \"kubeadm-config\" in the \"kube-system\" Namespace\n[kubelet] Creating a ConfigMap \"kubelet-config\" in namespace kube-system with the configuration for the kubelets in the cluster\n[upload-certs] Skipping phase. Please see --upload-certs\n[mark-control-plane] Marking the node master as control-plane by adding the labels: [node-role.kubernetes.io/control-plane node.kubernetes.io/exclude-from-external-load-balancers]\n[mark-control-plane] Marking the node master as control-plane by adding the taints [node-role.kubernetes.io/control-plane:NoSchedule]\n[bootstrap-token] Using token: 9pvavp.07xu7xczwy3puzft\n[bootstrap-token] Configuring bootstrap tokens, cluster-info ConfigMap, RBAC Roles\n[bootstrap-token] Configured RBAC rules to allow Node Bootstrap tokens to get nodes\n[bootstrap-token] Configured RBAC rules to allow Node Bootstrap tokens to post CSRs in order for nodes to get long term certificate credentials\n[bootstrap-token] Configured RBAC rules to allow the csrapprover controller automatically approve CSRs from a Node Bootstrap Token\n[bootstrap-token] Configured RBAC rules to allow certificate rotation for all node client certificates in the cluster\n[bootstrap-token] Creating the \"cluster-info\" ConfigMap in the \"kube-public\" namespace\n[kubelet-finalize] Updating \"/etc/kubernetes/kubelet.conf\" to point to a rotatable kubelet client certificate and key\n[addons] Applied essential addon: CoreDNS\n[addons] Applied essential addon: kube-proxy\n\nYour Kubernetes control-plane has initialized successfully!\n\nTo start using your cluster, you need to run the following as a regular user:\n\n  mkdir -p $HOME/.kube\n  sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config\n  sudo chown $(id -u):$(id -g) $HOME/.kube/config\n\nAlternatively, if you are the root user, you can run:\n\n  export KUBECONFIG=/etc/kubernetes/admin.conf\n\nYou should now deploy a pod network to the cluster.\nRun \"kubectl apply -f [podnetwork].yaml\" with one of the options listed at:\n  https://kubernetes.io/docs/concepts/cluster-administration/addons/\n\nYou can now join any number of control-plane nodes by copying certificate authorities\nand service account keys on each node and then running the following as root:\n\n  kubeadm join 51.21.53.50:6443 --token 9pvavp.07xu7xczwy3puzft \\\n\t--discovery-token-ca-cert-hash sha256:546a40835f91622263b6b632ae0bc320f3b551edbdfdbd56a78280ffc23f2745 \\\n\t--control-plane \n\nThen you can join any number of worker nodes by running the following on each as root:\n\nkubeadm join 51.21.53.50:6443 --token 9pvavp.07xu7xczwy3puzft \\\n\t--discovery-token-ca-cert-hash sha256:546a40835f91622263b6b632ae0bc320f3b551edbdfdbd56a78280ffc23f2745 ",
    "stdout_lines": [
        "[init] Using Kubernetes version: v1.30.2",
        "[preflight] Running pre-flight checks",
        "[preflight] Pulling images required for setting up a Kubernetes cluster",
        "[preflight] This might take a minute or two, depending on the speed of your internet connection",
        "[preflight] You can also perform this action in beforehand using 'kubeadm config images pull'",
        "[certs] Using certificateDir folder \"/etc/kubernetes/pki\"",
        "[certs] Generating \"ca\" certificate and key",
        "[certs] Generating \"apiserver\" certificate and key",
        "[certs] apiserver serving cert is signed for DNS names [kubernetes kubernetes.default kubernetes.default.svc kubernetes.default.svc.cluster.local master] and IPs [10.96.0.1 10.0.1.171 51.21.53.50]",
        "[certs] Generating \"apiserver-kubelet-client\" certificate and key",
        "[certs] Generating \"front-proxy-ca\" certificate and key",
        "[certs] Generating \"front-proxy-client\" certificate and key",
        "[certs] Generating \"etcd/ca\" certificate and key",
        "[certs] Generating \"etcd/server\" certificate and key",
        "[certs] etcd/server serving cert is signed for DNS names [localhost master] and IPs [10.0.1.171 127.0.0.1 ::1]",
        "[certs] Generating \"etcd/peer\" certificate and key",
        "[certs] etcd/peer serving cert is signed for DNS names [localhost master] and IPs [10.0.1.171 127.0.0.1 ::1]",
        "[certs] Generating \"etcd/healthcheck-client\" certificate and key",
        "[certs] Generating \"apiserver-etcd-client\" certificate and key",
        "[certs] Generating \"sa\" key and public key",
        "[kubeconfig] Using kubeconfig folder \"/etc/kubernetes\"",
        "[kubeconfig] Writing \"admin.conf\" kubeconfig file",
        "[kubeconfig] Writing \"super-admin.conf\" kubeconfig file",
        "[kubeconfig] Writing \"kubelet.conf\" kubeconfig file",
        "[kubeconfig] Writing \"controller-manager.conf\" kubeconfig file",
        "[kubeconfig] Writing \"scheduler.conf\" kubeconfig file",
        "[etcd] Creating static Pod manifest for local etcd in \"/etc/kubernetes/manifests\"",
        "[control-plane] Using manifest folder \"/etc/kubernetes/manifests\"",
        "[control-plane] Creating static Pod manifest for \"kube-apiserver\"",
        "[control-plane] Creating static Pod manifest for \"kube-controller-manager\"",
        "[control-plane] Creating static Pod manifest for \"kube-scheduler\"",
        "[kubelet-start] Writing kubelet environment file with flags to file \"/var/lib/kubelet/kubeadm-flags.env\"",
        "[kubelet-start] Writing kubelet configuration to file \"/var/lib/kubelet/config.yaml\"",
        "[kubelet-start] Starting the kubelet",
        "[wait-control-plane] Waiting for the kubelet to boot up the control plane as static Pods from directory \"/etc/kubernetes/manifests\"",
        "[kubelet-check] Waiting for a healthy kubelet. This can take up to 4m0s",
        "[kubelet-check] The kubelet is healthy after 1.001814058s",
        "[api-check] Waiting for a healthy API server. This can take up to 4m0s",
        "[api-check] The API server is healthy after 7.002152216s",
        "[upload-config] Storing the configuration used in ConfigMap \"kubeadm-config\" in the \"kube-system\" Namespace",
        "[kubelet] Creating a ConfigMap \"kubelet-config\" in namespace kube-system with the configuration for the kubelets in the cluster",
        "[upload-certs] Skipping phase. Please see --upload-certs",
        "[mark-control-plane] Marking the node master as control-plane by adding the labels: [node-role.kubernetes.io/control-plane node.kubernetes.io/exclude-from-external-load-balancers]",
        "[mark-control-plane] Marking the node master as control-plane by adding the taints [node-role.kubernetes.io/control-plane:NoSchedule]",
        "[bootstrap-token] Using token: 9pvavp.07xu7xczwy3puzft",
        "[bootstrap-token] Configuring bootstrap tokens, cluster-info ConfigMap, RBAC Roles",
        "[bootstrap-token] Configured RBAC rules to allow Node Bootstrap tokens to get nodes",
        "[bootstrap-token] Configured RBAC rules to allow Node Bootstrap tokens to post CSRs in order for nodes to get long term certificate credentials",
        "[bootstrap-token] Configured RBAC rules to allow the csrapprover controller automatically approve CSRs from a Node Bootstrap Token",
        "[bootstrap-token] Configured RBAC rules to allow certificate rotation for all node client certificates in the cluster",
        "[bootstrap-token] Creating the \"cluster-info\" ConfigMap in the \"kube-public\" namespace",
        "[kubelet-finalize] Updating \"/etc/kubernetes/kubelet.conf\" to point to a rotatable kubelet client certificate and key",
        "[addons] Applied essential addon: CoreDNS",
        "[addons] Applied essential addon: kube-proxy",
        "",
        "Your Kubernetes control-plane has initialized successfully!",
        "",
        "To start using your cluster, you need to run the following as a regular user:",
        "",
        "  mkdir -p $HOME/.kube",
        "  sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config",
        "  sudo chown $(id -u):$(id -g) $HOME/.kube/config",
        "",
        "Alternatively, if you are the root user, you can run:",
        "",
        "  export KUBECONFIG=/etc/kubernetes/admin.conf",
        "",
        "You should now deploy a pod network to the cluster.",
        "Run \"kubectl apply -f [podnetwork].yaml\" with one of the options listed at:",
        "  https://kubernetes.io/docs/concepts/cluster-administration/addons/",
        "",
        "You can now join any number of control-plane nodes by copying certificate authorities",
        "and service account keys on each node and then running the following as root:",
        "",
        "  kubeadm join 51.21.53.50:6443 --token 9pvavp.07xu7xczwy3puzft \\",
        "\t--discovery-token-ca-cert-hash sha256:546a40835f91622263b6b632ae0bc320f3b551edbdfdbd56a78280ffc23f2745 \\",
        "\t--control-plane ",
        "",
        "Then you can join any number of worker nodes by running the following on each as root:",
        "",
        "kubeadm join 51.21.53.50:6443 --token 9pvavp.07xu7xczwy3puzft \\",
        "\t--discovery-token-ca-cert-hash sha256:546a40835f91622263b6b632ae0bc320f3b551edbdfdbd56a78280ffc23f2745 "
    ]
}

TASK [Configure kubectl for the master node] ***********************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:198
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'echo ~ec2-user && sleep 0'"'"''
<10.0.1.171> (0, b'/home/ec2-user\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /home/ec2-user/.ansible/tmp `"&& mkdir "` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489321.8811426-327424-209015921489841 `" && echo ansible-tmp-1721489321.8811426-327424-209015921489841="` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489321.8811426-327424-209015921489841 `" ) && sleep 0'"'"''
<10.0.1.171> (0, b'ansible-tmp-1721489321.8811426-327424-209015921489841=/home/ec2-user/.ansible/tmp/ansible-tmp-1721489321.8811426-327424-209015921489841\n', b'')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/command.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmp34mkz92g TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489321.8811426-327424-209015921489841/AnsiballZ_command.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmp34mkz92g /home/ec2-user/.ansible/tmp/ansible-tmp-1721489321.8811426-327424-209015921489841/AnsiballZ_command.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489321.8811426-327424-209015921489841/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489321.8811426-327424-209015921489841/AnsiballZ_command.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-qgppfmylczwopgpkqksautqrswjugivm ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489321.8811426-327424-209015921489841/AnsiballZ_command.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"changed": true, "stdout": "NAME     STATUS     ROLES           AGE   VERSION\\nmaster   NotReady   control-plane   4s    v1.30.3", "stderr": "", "rc": 0, "cmd": "sudo mkdir -p /root/.kube\\nsudo cp -i /etc/kubernetes/admin.conf /root/.kube/config\\nsudo chown $(id -u):$(id -g) /root/.kube/config\\nexport KUBECONFIG=/root/.kube/config\\nkubectl get nodes\\n", "start": "2024-07-20 15:28:42.385208", "end": "2024-07-20 15:28:42.706961", "delta": "0:00:00.321753", "msg": "", "invocation": {"module_args": {"_raw_params": "sudo mkdir -p /root/.kube\\nsudo cp -i /etc/kubernetes/admin.conf /root/.kube/config\\nsudo chown $(id -u):$(id -g) /root/.kube/config\\nexport KUBECONFIG=/root/.kube/config\\nkubectl get nodes\\n", "_uses_shell": true, "stdin_add_newline": true, "strip_empty_ends": true, "argv": null, "chdir": null, "executable": null, "creates": null, "removes": null, "stdin": null}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'rm -f -r /home/ec2-user/.ansible/tmp/ansible-tmp-1721489321.8811426-327424-209015921489841/ > /dev/null 2>&1 && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
changed: [master] => {
    "changed": true,
    "cmd": "sudo mkdir -p /root/.kube\nsudo cp -i /etc/kubernetes/admin.conf /root/.kube/config\nsudo chown $(id -u):$(id -g) /root/.kube/config\nexport KUBECONFIG=/root/.kube/config\nkubectl get nodes\n",
    "delta": "0:00:00.321753",
    "end": "2024-07-20 15:28:42.706961",
    "invocation": {
        "module_args": {
            "_raw_params": "sudo mkdir -p /root/.kube\nsudo cp -i /etc/kubernetes/admin.conf /root/.kube/config\nsudo chown $(id -u):$(id -g) /root/.kube/config\nexport KUBECONFIG=/root/.kube/config\nkubectl get nodes\n",
            "_uses_shell": true,
            "argv": null,
            "chdir": null,
            "creates": null,
            "executable": null,
            "removes": null,
            "stdin": null,
            "stdin_add_newline": true,
            "strip_empty_ends": true
        }
    },
    "msg": "",
    "rc": 0,
    "start": "2024-07-20 15:28:42.385208",
    "stderr": "",
    "stderr_lines": [],
    "stdout": "NAME     STATUS     ROLES           AGE   VERSION\nmaster   NotReady   control-plane   4s    v1.30.3",
    "stdout_lines": [
        "NAME     STATUS     ROLES           AGE   VERSION",
        "master   NotReady   control-plane   4s    v1.30.3"
    ]
}

TASK [Apply Calico network plugin] *********************************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:207
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'echo ~ec2-user && sleep 0'"'"''
<10.0.1.171> (0, b'/home/ec2-user\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /home/ec2-user/.ansible/tmp `"&& mkdir "` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489322.8343663-327439-79488328824734 `" && echo ansible-tmp-1721489322.8343663-327439-79488328824734="` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489322.8343663-327439-79488328824734 `" ) && sleep 0'"'"''
<10.0.1.171> (0, b'ansible-tmp-1721489322.8343663-327439-79488328824734=/home/ec2-user/.ansible/tmp/ansible-tmp-1721489322.8343663-327439-79488328824734\n', b'')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/command.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpw0s6dmuq TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489322.8343663-327439-79488328824734/AnsiballZ_command.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpw0s6dmuq /home/ec2-user/.ansible/tmp/ansible-tmp-1721489322.8343663-327439-79488328824734/AnsiballZ_command.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489322.8343663-327439-79488328824734/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489322.8343663-327439-79488328824734/AnsiballZ_command.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-ppoqfruauvywseflcwhgyivrlsvlttdy ; KUBECONFIG=/etc/kubernetes/admin.conf /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489322.8343663-327439-79488328824734/AnsiballZ_command.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"changed": true, "stdout": "poddisruptionbudget.policy/calico-kube-controllers created\\nserviceaccount/calico-kube-controllers created\\nserviceaccount/calico-node created\\nconfigmap/calico-config created\\ncustomresourcedefinition.apiextensions.k8s.io/bgpconfigurations.crd.projectcalico.org created\\ncustomresourcedefinition.apiextensions.k8s.io/bgppeers.crd.projectcalico.org created\\ncustomresourcedefinition.apiextensions.k8s.io/blockaffinities.crd.projectcalico.org created\\ncustomresourcedefinition.apiextensions.k8s.io/caliconodestatuses.crd.projectcalico.org created\\ncustomresourcedefinition.apiextensions.k8s.io/clusterinformations.crd.projectcalico.org created\\ncustomresourcedefinition.apiextensions.k8s.io/felixconfigurations.crd.projectcalico.org created\\ncustomresourcedefinition.apiextensions.k8s.io/globalnetworkpolicies.crd.projectcalico.org created\\ncustomresourcedefinition.apiextensions.k8s.io/globalnetworksets.crd.projectcalico.org created\\ncustomresourcedefinition.apiextensions.k8s.io/hostendpoints.crd.projectcalico.org created\\ncustomresourcedefinition.apiextensions.k8s.io/ipamblocks.crd.projectcalico.org created\\ncustomresourcedefinition.apiextensions.k8s.io/ipamconfigs.crd.projectcalico.org created\\ncustomresourcedefinition.apiextensions.k8s.io/ipamhandles.crd.projectcalico.org created\\ncustomresourcedefinition.apiextensions.k8s.io/ippools.crd.projectcalico.org created\\ncustomresourcedefinition.apiextensions.k8s.io/ipreservations.crd.projectcalico.org created\\ncustomresourcedefinition.apiextensions.k8s.io/kubecontrollersconfigurations.crd.projectcalico.org created\\ncustomresourcedefinition.apiextensions.k8s.io/networkpolicies.crd.projectcalico.org created\\ncustomresourcedefinition.apiextensions.k8s.io/networksets.crd.projectcalico.org created\\nclusterrole.rbac.authorization.k8s.io/calico-kube-controllers created\\nclusterrole.rbac.authorization.k8s.io/calico-node created\\nclusterrolebinding.rbac.authorization.k8s.io/calico-kube-controllers created\\nclusterrolebinding.rbac.authorization.k8s.io/calico-node created\\ndaemonset.apps/calico-node created\\ndeployment.apps/calico-kube-controllers created", "stderr": "", "rc": 0, "cmd": "kubectl apply -f https://docs.projectcalico.org/manifests/calico.yaml\\n", "start": "2024-07-20 15:28:43.279524", "end": "2024-07-20 15:28:44.746704", "delta": "0:00:01.467180", "msg": "", "invocation": {"module_args": {"_raw_params": "kubectl apply -f https://docs.projectcalico.org/manifests/calico.yaml\\n", "_uses_shell": true, "stdin_add_newline": true, "strip_empty_ends": true, "argv": null, "chdir": null, "executable": null, "creates": null, "removes": null, "stdin": null}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'rm -f -r /home/ec2-user/.ansible/tmp/ansible-tmp-1721489322.8343663-327439-79488328824734/ > /dev/null 2>&1 && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
changed: [master] => {
    "changed": true,
    "cmd": "kubectl apply -f https://docs.projectcalico.org/manifests/calico.yaml\n",
    "delta": "0:00:01.467180",
    "end": "2024-07-20 15:28:44.746704",
    "invocation": {
        "module_args": {
            "_raw_params": "kubectl apply -f https://docs.projectcalico.org/manifests/calico.yaml\n",
            "_uses_shell": true,
            "argv": null,
            "chdir": null,
            "creates": null,
            "executable": null,
            "removes": null,
            "stdin": null,
            "stdin_add_newline": true,
            "strip_empty_ends": true
        }
    },
    "msg": "",
    "rc": 0,
    "start": "2024-07-20 15:28:43.279524",
    "stderr": "",
    "stderr_lines": [],
    "stdout": "poddisruptionbudget.policy/calico-kube-controllers created\nserviceaccount/calico-kube-controllers created\nserviceaccount/calico-node created\nconfigmap/calico-config created\ncustomresourcedefinition.apiextensions.k8s.io/bgpconfigurations.crd.projectcalico.org created\ncustomresourcedefinition.apiextensions.k8s.io/bgppeers.crd.projectcalico.org created\ncustomresourcedefinition.apiextensions.k8s.io/blockaffinities.crd.projectcalico.org created\ncustomresourcedefinition.apiextensions.k8s.io/caliconodestatuses.crd.projectcalico.org created\ncustomresourcedefinition.apiextensions.k8s.io/clusterinformations.crd.projectcalico.org created\ncustomresourcedefinition.apiextensions.k8s.io/felixconfigurations.crd.projectcalico.org created\ncustomresourcedefinition.apiextensions.k8s.io/globalnetworkpolicies.crd.projectcalico.org created\ncustomresourcedefinition.apiextensions.k8s.io/globalnetworksets.crd.projectcalico.org created\ncustomresourcedefinition.apiextensions.k8s.io/hostendpoints.crd.projectcalico.org created\ncustomresourcedefinition.apiextensions.k8s.io/ipamblocks.crd.projectcalico.org created\ncustomresourcedefinition.apiextensions.k8s.io/ipamconfigs.crd.projectcalico.org created\ncustomresourcedefinition.apiextensions.k8s.io/ipamhandles.crd.projectcalico.org created\ncustomresourcedefinition.apiextensions.k8s.io/ippools.crd.projectcalico.org created\ncustomresourcedefinition.apiextensions.k8s.io/ipreservations.crd.projectcalico.org created\ncustomresourcedefinition.apiextensions.k8s.io/kubecontrollersconfigurations.crd.projectcalico.org created\ncustomresourcedefinition.apiextensions.k8s.io/networkpolicies.crd.projectcalico.org created\ncustomresourcedefinition.apiextensions.k8s.io/networksets.crd.projectcalico.org created\nclusterrole.rbac.authorization.k8s.io/calico-kube-controllers created\nclusterrole.rbac.authorization.k8s.io/calico-node created\nclusterrolebinding.rbac.authorization.k8s.io/calico-kube-controllers created\nclusterrolebinding.rbac.authorization.k8s.io/calico-node created\ndaemonset.apps/calico-node created\ndeployment.apps/calico-kube-controllers created",
    "stdout_lines": [
        "poddisruptionbudget.policy/calico-kube-controllers created",
        "serviceaccount/calico-kube-controllers created",
        "serviceaccount/calico-node created",
        "configmap/calico-config created",
        "customresourcedefinition.apiextensions.k8s.io/bgpconfigurations.crd.projectcalico.org created",
        "customresourcedefinition.apiextensions.k8s.io/bgppeers.crd.projectcalico.org created",
        "customresourcedefinition.apiextensions.k8s.io/blockaffinities.crd.projectcalico.org created",
        "customresourcedefinition.apiextensions.k8s.io/caliconodestatuses.crd.projectcalico.org created",
        "customresourcedefinition.apiextensions.k8s.io/clusterinformations.crd.projectcalico.org created",
        "customresourcedefinition.apiextensions.k8s.io/felixconfigurations.crd.projectcalico.org created",
        "customresourcedefinition.apiextensions.k8s.io/globalnetworkpolicies.crd.projectcalico.org created",
        "customresourcedefinition.apiextensions.k8s.io/globalnetworksets.crd.projectcalico.org created",
        "customresourcedefinition.apiextensions.k8s.io/hostendpoints.crd.projectcalico.org created",
        "customresourcedefinition.apiextensions.k8s.io/ipamblocks.crd.projectcalico.org created",
        "customresourcedefinition.apiextensions.k8s.io/ipamconfigs.crd.projectcalico.org created",
        "customresourcedefinition.apiextensions.k8s.io/ipamhandles.crd.projectcalico.org created",
        "customresourcedefinition.apiextensions.k8s.io/ippools.crd.projectcalico.org created",
        "customresourcedefinition.apiextensions.k8s.io/ipreservations.crd.projectcalico.org created",
        "customresourcedefinition.apiextensions.k8s.io/kubecontrollersconfigurations.crd.projectcalico.org created",
        "customresourcedefinition.apiextensions.k8s.io/networkpolicies.crd.projectcalico.org created",
        "customresourcedefinition.apiextensions.k8s.io/networksets.crd.projectcalico.org created",
        "clusterrole.rbac.authorization.k8s.io/calico-kube-controllers created",
        "clusterrole.rbac.authorization.k8s.io/calico-node created",
        "clusterrolebinding.rbac.authorization.k8s.io/calico-kube-controllers created",
        "clusterrolebinding.rbac.authorization.k8s.io/calico-node created",
        "daemonset.apps/calico-node created",
        "deployment.apps/calico-kube-controllers created"
    ]
}

TASK [Retrieve join command for worker nodes] **********************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:213
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'echo ~ec2-user && sleep 0'"'"''
<10.0.1.171> (0, b'/home/ec2-user\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /home/ec2-user/.ansible/tmp `"&& mkdir "` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489324.8917403-327516-223752699918774 `" && echo ansible-tmp-1721489324.8917403-327516-223752699918774="` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489324.8917403-327516-223752699918774 `" ) && sleep 0'"'"''
<10.0.1.171> (0, b'ansible-tmp-1721489324.8917403-327516-223752699918774=/home/ec2-user/.ansible/tmp/ansible-tmp-1721489324.8917403-327516-223752699918774\n', b'')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/command.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmp96m0pwh4 TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489324.8917403-327516-223752699918774/AnsiballZ_command.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmp96m0pwh4 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489324.8917403-327516-223752699918774/AnsiballZ_command.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489324.8917403-327516-223752699918774/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489324.8917403-327516-223752699918774/AnsiballZ_command.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-qpbixweybubqitosoetvzcqkyfodcwhs ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489324.8917403-327516-223752699918774/AnsiballZ_command.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"changed": true, "stdout": "kubeadm join 51.21.53.50:6443 --token oru8d2.tqkpbhtfl1tht5gu --discovery-token-ca-cert-hash sha256:546a40835f91622263b6b632ae0bc320f3b551edbdfdbd56a78280ffc23f2745 ", "stderr": "", "rc": 0, "cmd": "kubeadm token create --print-join-command", "start": "2024-07-20 15:28:45.467764", "end": "2024-07-20 15:28:45.558943", "delta": "0:00:00.091179", "msg": "", "invocation": {"module_args": {"_raw_params": "kubeadm token create --print-join-command", "_uses_shell": true, "stdin_add_newline": true, "strip_empty_ends": true, "argv": null, "chdir": null, "executable": null, "creates": null, "removes": null, "stdin": null}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'rm -f -r /home/ec2-user/.ansible/tmp/ansible-tmp-1721489324.8917403-327516-223752699918774/ > /dev/null 2>&1 && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
changed: [master] => {
    "changed": true,
    "cmd": "kubeadm token create --print-join-command",
    "delta": "0:00:00.091179",
    "end": "2024-07-20 15:28:45.558943",
    "invocation": {
        "module_args": {
            "_raw_params": "kubeadm token create --print-join-command",
            "_uses_shell": true,
            "argv": null,
            "chdir": null,
            "creates": null,
            "executable": null,
            "removes": null,
            "stdin": null,
            "stdin_add_newline": true,
            "strip_empty_ends": true
        }
    },
    "msg": "",
    "rc": 0,
    "start": "2024-07-20 15:28:45.467764",
    "stderr": "",
    "stderr_lines": [],
    "stdout": "kubeadm join 51.21.53.50:6443 --token oru8d2.tqkpbhtfl1tht5gu --discovery-token-ca-cert-hash sha256:546a40835f91622263b6b632ae0bc320f3b551edbdfdbd56a78280ffc23f2745 ",
    "stdout_lines": [
        "kubeadm join 51.21.53.50:6443 --token oru8d2.tqkpbhtfl1tht5gu --discovery-token-ca-cert-hash sha256:546a40835f91622263b6b632ae0bc320f3b551edbdfdbd56a78280ffc23f2745 "
    ]
}

TASK [Retrieve worker join command] ********************************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:217
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'echo ~ec2-user && sleep 0'"'"''
<10.0.1.171> (0, b'/home/ec2-user\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'( umask 77 && mkdir -p "` echo /home/ec2-user/.ansible/tmp `"&& mkdir "` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489325.6887562-327525-111036287304802 `" && echo ansible-tmp-1721489325.6887562-327525-111036287304802="` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489325.6887562-327525-111036287304802 `" ) && sleep 0'"'"''
<10.0.1.171> (0, b'ansible-tmp-1721489325.6887562-327525-111036287304802=/home/ec2-user/.ansible/tmp/ansible-tmp-1721489325.6887562-327525-111036287304802\n', b'')
Using module file /usr/lib/python3.9/site-packages/ansible/modules/command.py
<10.0.1.171> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpmfzg726v TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489325.6887562-327525-111036287304802/AnsiballZ_command.py
<10.0.1.171> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' '[10.0.1.171]'
<10.0.1.171> (0, b'sftp> put /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpmfzg726v /home/ec2-user/.ansible/tmp/ansible-tmp-1721489325.6887562-327525-111036287304802/AnsiballZ_command.py\n', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489325.6887562-327525-111036287304802/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489325.6887562-327525-111036287304802/AnsiballZ_command.py && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' -tt 10.0.1.171 '/bin/sh -c '"'"'sudo -H -S -n  -u root /bin/sh -c '"'"'"'"'"'"'"'"'echo BECOME-SUCCESS-dmyvvhzmvqhgcybttjctnlokrsccaisd ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489325.6887562-327525-111036287304802/AnsiballZ_command.py'"'"'"'"'"'"'"'"' && sleep 0'"'"''
Escalation succeeded
<10.0.1.171> (0, b'\r\n{"changed": true, "stdout": "", "stderr": "", "rc": 0, "cmd": "kubeadm token create --print-join-command > /tmp/join_command.sh\\n", "start": "2024-07-20 15:28:46.314722", "end": "2024-07-20 15:28:46.386501", "delta": "0:00:00.071779", "msg": "", "invocation": {"module_args": {"_raw_params": "kubeadm token create --print-join-command > /tmp/join_command.sh\\n", "_uses_shell": true, "stdin_add_newline": true, "strip_empty_ends": true, "argv": null, "chdir": null, "executable": null, "creates": null, "removes": null, "stdin": null}}}\r\n', b'Shared connection to 10.0.1.171 closed.\r\n')
<10.0.1.171> ESTABLISH SSH CONNECTION FOR USER: ec2-user
<10.0.1.171> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User="ec2-user"' -o ConnectTimeout=10 -o 'ControlPath="/home/ec2-user/.ansible/cp/f291336e89"' 10.0.1.171 '/bin/sh -c '"'"'rm -f -r /home/ec2-user/.ansible/tmp/ansible-tmp-1721489325.6887562-327525-111036287304802/ > /dev/null 2>&1 && sleep 0'"'"''
<10.0.1.171> (0, b'', b'')
changed: [master] => {
    "changed": true,
    "cmd": "kubeadm token create --print-join-command > /tmp/join_command.sh\n",
    "delta": "0:00:00.071779",
    "end": "2024-07-20 15:28:46.386501",
    "invocation": {
        "module_args": {
            "_raw_params": "kubeadm token create --print-join-command > /tmp/join_command.sh\n",
            "_uses_shell": true,
            "argv": null,
            "chdir": null,
            "creates": null,
            "executable": null,
            "removes": null,
            "stdin": null,
            "stdin_add_newline": true,
            "strip_empty_ends": true
        }
    },
    "msg": "",
    "rc": 0,
    "start": "2024-07-20 15:28:46.314722",
    "stderr": "",
    "stderr_lines": [],
    "stdout": "",
    "stdout_lines": []
}

TASK [Pull the join command to the admin server using private IP] **************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:221
<localhost> ESTABLISH LOCAL CONNECTION FOR USER: ec2-user
<localhost> EXEC /bin/sh -c 'echo ~ec2-user && sleep 0'
<localhost> EXEC /bin/sh -c '( umask 77 && mkdir -p "` echo /home/ec2-user/.ansible/tmp `"&& mkdir "` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489326.518607-327534-6716530506317 `" && echo ansible-tmp-1721489326.518607-327534-6716530506317="` echo /home/ec2-user/.ansible/tmp/ansible-tmp-1721489326.518607-327534-6716530506317 `" ) && sleep 0'
Using module file /usr/lib/python3.9/site-packages/ansible/modules/command.py
<localhost> PUT /home/ec2-user/.ansible/tmp/ansible-local-326294t72e9lxb/tmpioht2k29 TO /home/ec2-user/.ansible/tmp/ansible-tmp-1721489326.518607-327534-6716530506317/AnsiballZ_command.py
<localhost> EXEC /bin/sh -c 'chmod u+x /home/ec2-user/.ansible/tmp/ansible-tmp-1721489326.518607-327534-6716530506317/ /home/ec2-user/.ansible/tmp/ansible-tmp-1721489326.518607-327534-6716530506317/AnsiballZ_command.py && sleep 0'
<localhost> EXEC /bin/sh -c 'sudo -H -S -n  -u root /bin/sh -c '"'"'echo BECOME-SUCCESS-ubtuzovmpkpfchqxdrruisrthvkmoiys ; /usr/bin/python3.9 /home/ec2-user/.ansible/tmp/ansible-tmp-1721489326.518607-327534-6716530506317/AnsiballZ_command.py'"'"' && sleep 0'
<localhost> EXEC /bin/sh -c 'rm -f -r /home/ec2-user/.ansible/tmp/ansible-tmp-1721489326.518607-327534-6716530506317/ > /dev/null 2>&1 && sleep 0'
changed: [master -> localhost] => {
    "changed": true,
    "cmd": "scp -o StrictHostKeyChecking=no -i /home/ec2-user/.ssh/my-key-pair ec2-user@10.0.1.171:/tmp/join_command.sh /home/ec2-user/devops_setup/terraform/join_command.sh\n",
    "delta": "0:00:00.341290",
    "end": "2024-07-20 15:28:47.160409",
    "invocation": {
        "module_args": {
            "_raw_params": "scp -o StrictHostKeyChecking=no -i /home/ec2-user/.ssh/my-key-pair ec2-user@10.0.1.171:/tmp/join_command.sh /home/ec2-user/devops_setup/terraform/join_command.sh\n",
            "_uses_shell": true,
            "argv": null,
            "chdir": null,
            "creates": null,
            "executable": null,
            "removes": null,
            "stdin": null,
            "stdin_add_newline": true,
            "strip_empty_ends": true
        }
    },
    "msg": "",
    "rc": 0,
    "start": "2024-07-20 15:28:46.819119",
    "stderr": "Warning: Permanently added '10.0.1.171' (ED25519) to the list of known hosts.",
    "stderr_lines": [
        "Warning: Permanently added '10.0.1.171' (ED25519) to the list of known hosts."
    ],
    "stdout": "",
    "stdout_lines": []
}

TASK [Print fetch result] ******************************************************
task path: /home/ec2-user/devops_setup/ansible/playbooks/kubernetes/setup_kubernetes_cluster.yaml:228
ok: [master -> localhost] => {
    "fetch_result": {
        "changed": true,
        "cmd": "scp -o StrictHostKeyChecking=no -i /home/ec2-user/.ssh/my-key-pair ec2-user@10.0.1.171:/tmp/join_command.sh /home/ec2-user/devops_setup/terraform/join_command.sh\n",
        "delta": "0:00:00.341290",
        "end": "2024-07-20 15:28:47.160409",
        "failed": false,
        "msg": "",
        "rc": 0,
        "start": "2024-07-20 15:28:46.819119",
        "stderr": "Warning: Permanently added '10.0.1.171' (ED25519) to the list of known hosts.",
        "stderr_lines": [
            "Warning: Permanently added '10.0.1.171' (ED25519) to the list of known hosts."
        ],
        "stdout": "",
        "stdout_lines": []
    }
}

PLAY RECAP *********************************************************************
master                     : ok=42   changed=33   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

