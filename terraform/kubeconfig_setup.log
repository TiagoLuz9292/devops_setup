[WARNING]: Found both group and host with same name: admin
[WARNING]: Found both group and host with same name: master

PLAY [Setup Jenkins service account on Kubernetes] *****************************

TASK [Gathering Facts] *********************************************************
[WARNING]: Platform linux on host master is using the discovered Python
interpreter at /usr/bin/python3.9, but future installation of another Python
interpreter could change the meaning of that path. See
https://docs.ansible.com/ansible-
core/2.16/reference_appendices/interpreter_discovery.html for more information.
ok: [master]

TASK [Get public IP using curl] ************************************************
changed: [master]

TASK [Set master public IP fact] ***********************************************
ok: [master]

TASK [Print public IP] *********************************************************
ok: [master] => {
    "msg": "The public IP of the target server is: 13.60.155.240"
}

TASK [Set KUBECONFIG environment variable] *************************************
ok: [master]

TASK [Remove existing Jenkins service account] *********************************
fatal: [master]: FAILED! => {"changed": true, "cmd": ["kubectl", "delete", "serviceaccount", "jenkins", "-n", "default"], "delta": "0:00:00.100043", "end": "2024-07-18 13:46:32.132680", "msg": "non-zero return code", "rc": 1, "start": "2024-07-18 13:46:32.032637", "stderr": "Error from server (NotFound): serviceaccounts \"jenkins\" not found", "stderr_lines": ["Error from server (NotFound): serviceaccounts \"jenkins\" not found"], "stdout": "", "stdout_lines": []}
...ignoring

TASK [Remove existing Jenkins cluster role binding] ****************************
fatal: [master]: FAILED! => {"changed": true, "cmd": ["kubectl", "delete", "clusterrolebinding", "jenkins"], "delta": "0:00:00.102027", "end": "2024-07-18 13:46:33.932829", "msg": "non-zero return code", "rc": 1, "start": "2024-07-18 13:46:33.830802", "stderr": "Error from server (NotFound): clusterrolebindings.rbac.authorization.k8s.io \"jenkins\" not found", "stderr_lines": ["Error from server (NotFound): clusterrolebindings.rbac.authorization.k8s.io \"jenkins\" not found"], "stdout": "", "stdout_lines": []}
...ignoring

TASK [Remove existing Jenkins secret] ******************************************
fatal: [master]: FAILED! => {"changed": true, "cmd": ["kubectl", "delete", "secret", "jenkins-secret", "-n", "default"], "delta": "0:00:00.165775", "end": "2024-07-18 13:46:35.852283", "msg": "non-zero return code", "rc": 1, "start": "2024-07-18 13:46:35.686508", "stderr": "Error from server (NotFound): secrets \"jenkins-secret\" not found", "stderr_lines": ["Error from server (NotFound): secrets \"jenkins-secret\" not found"], "stdout": "", "stdout_lines": []}
...ignoring

TASK [Remove existing kubeconfig file for Jenkins] *****************************
ok: [master]

TASK [Create service account for Jenkins] **************************************
changed: [master]

TASK [Create cluster role binding for Jenkins] *********************************
changed: [master]

TASK [Get Jenkins token] *******************************************************
changed: [master]

TASK [Create secret for Jenkins token] *****************************************
changed: [master]

TASK [Patch service account with secret] ***************************************
changed: [master]

TASK [Retrieve certificate-authority-data] *************************************
changed: [master]

TASK [Create kubeconfig file for Jenkins] **************************************
changed: [master]

TASK [Set master public IP globally] *******************************************
ok: [master]

PLAY [Fetch kubeconfig for Jenkins to local machine] ***************************

TASK [Gathering Facts] *********************************************************
ok: [localhost]

TASK [Create directory for kubeconfig] *****************************************
ok: [localhost]

TASK [Fetch kubeconfig file using scp] *****************************************
changed: [localhost]

TASK [Export KUBECONFIG environment variable] **********************************
changed: [localhost]

PLAY RECAP *********************************************************************
localhost                  : ok=4    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
master                     : ok=17   changed=11   unreachable=0    failed=0    skipped=0    rescued=0    ignored=3   

